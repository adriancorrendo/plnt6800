{
  "hash": "a6e5de758ce75b6abf838b5b927642a1",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Retrieving and Processing Weather Data with R\"\nauthor: \"Dr. Adrian Correndo\"\ndate: \"2025-02-12\"\ncategories: [weather data, API, data wrangling, daymetr]\nformat:\n  html:\n    toc: true\n    toc-location: left\n    toc-depth: 4\n    number-sections: true\n    table-class: \"table table-striped table-hover\"\neditor: source\nsmooth-scroll: true\n---\n\n\n\n**Description** <br/>\n\nThis lesson provides a step-by-step guide on retrieving and processing daily-weather data using R. It covers downloading data from DAYMET and processing it to generate weather summaries useful for agricultural research.\n\nThis tutorial focuses on how to:\n\n1. Download daily weather data from DAYMET.\n2. Process the retrieved data to calculate agronomic variables.\n3. Summarize weather data for different time intervals.\n\n\n\n\n\n\n\n**Required packages** <br/>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(pacman)\np_load(dplyr, tidyr, stringr) # Data wrangling\np_load(purrr) # Iteration\np_load(lubridate) # Date operations\np_load(kableExtra) # Table formatting to better display\np_load(daymetr) # Weather data from Daymet\np_load(skimr) # Summarizing weather data\np_load(vegan) # Shannon Diversity Index\np_load(writexl)\n```\n:::\n\n\n# Locations & Dates Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Locations\ndf_sites <- data.frame(\n  ID = c('1', '2', '3'),\n  Crop = c('Corn', 'Corn', 'Soybean'),\n  Site = c('Elora', 'Ridgetown', 'Winchester'),\n  latitude = c(43.6489, 42.4464, 45.0833),\n  longitude = c(-80.4037, -81.8835, -75.3500)\n)\n\n# Dates\ndf_time <- data.frame(\n  ID = c('1', '2', '3'), # column in common to match and merge\n  Start = c('2002-04-25', '2005-05-01', '2010-05-20'), # date to start collecting weather\n  End = c('2002-09-30', '2006-09-30', '2010-10-10'), # date to stop collecting weather\n  # Add key crop phenology dates\n  Flo = c('2002-07-20', '2006-07-21', '2010-07-15'), # Flowering dates for processing\n  SeFi = c('2002-08-08', '2006-08-10', '2010-08-15') # Seed filling dates for processing\n) %>% \n  # Express start and end as dates using \"across\"\n  dplyr::mutate(across(Start:SeFi, ~as.Date(., format = '%Y-%m-%d')))\n\n# Merge\ndf_input <- left_join(df_sites, df_time, by = \"ID\")\n```\n:::\n\n\n\n# Retrieving Weather Data from DAYMET\n\n![](https://raw.githubusercontent.com/bluegreen-labs/daymetr/master/logo.png){.absolute top=0 right=0 height=\"25%\"}\n`daymetr` is a programmatic interface to the [Daymet web services](https://daymet.ornl.gov/). Allows for easy downloads of Daymet climate data directly to your R workspace or your computer. Spatial resolution: ~1 km2. Temporal resolution: daily. Historical data since year 1980.\n\nOfficial Website: [http://bluegreen-labs.github.io/daymetr/](http://bluegreen-labs.github.io/daymetr/)\n\n## How to cite the daymetr package\n\n> Hufkens K., Basler J. D., Milliman T. Melaas E., Richardson A.D. 2018\n> An integrated phenology modelling framework in R: Phenology modelling\n> with phenor. Methods in Ecology &\n> Evolution, 9: 1-10. https://doi.org/10.1111/2041-210X.12970\n\n## Evapotranspiration\n\nDaymet does not provide data on reference evapotranspiration ($\\text{ET}_0$). However, it is possible to estimate $\\text{ET}_0$ using the Hargreaves and Samani approach, which only requires temperature information (Hargreaves and Samani, 1985; Raziei and Pereira, 2013). Nonetheless, the $\\text{ET}_{0-HS}$ equation is reported to give unreliable estimates for daily $ET0$ and therefore it should be used for 10-day periods at the shortest (Cobaner et al., 2017). <br/>\n\n### Constants\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Constants for ET0 (Cobaner et al., 2017)\n# Solar constant:\nGsc <- 0.0820 # (MJ m-2 min-1)\n# Radiation adjustment coefficient (Samani, 2004)\nkRs <- 0.17\n```\n:::\n\n\n\n## Function to retrieve\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Name of functions using dots (.) instead of underscore (_)\n# We keep underscore for other objects\nweather.daymet <- function(input, dpp = 0){ \n  # Downloads the daily weather data from the DAYMET database and process it\n  # Args:\n  #  input = input file containing the locations and the start & end dates for the time series\n  #  dpp = days prior to the Start\n  # Returns:\n  #  a tibble of DAYMET weather variables for the requested time period\n  # STEP 1. Make use of metadata (locations and dates)\n  input %>%\n    dplyr::mutate(\n      Weather = purrr::pmap(list(ID = ID,\n                                 # Rename vars to avoid conflicts\n                                 lat = latitude,\n                                 lon = longitude,\n                                 sta = Start - dpp,\n                                 end = End),\n                                        \n   # STEP 2. Retrieving daymet data:\n              function(ID, lat, lon, sta, end) {\n                daymetr::download_daymet(site = ID,\n                                         lat = lat, \n                                         lon = lon,\n                                       # Extracting year from date:\n                                       start = as.numeric(substr(sta, 1, 4)),\n                                       end = as.numeric(substr(end, 1, 4)),\n                                       internal = TRUE, \n                                       simplify = TRUE)})) %>% \n    \n    # STEP 3. Organizing dataframe (Re-arranging rows and columns)\n    dplyr::mutate(Weather = Weather %>% \n                # i. Adjusting dates format with lubridate and map()\n                purrr::map(~ \n                  dplyr::mutate(., \n                   Date = as.Date(as.numeric(yday) - 1, # Day of the year\n                   origin = paste0(year, '-01-01')),\n                   Year = year(Date),\n                   Month = month(Date),\n                   Day = mday(Date))) %>%\n                # ii. Select columns of interest\n                purrr::map(~ \n                  dplyr::select(., yday, Year, Month, Day,\n                                Date, measurement, value)) %>%\n                # iii. Re-arrange columns wider\n                purrr::map(~ \n                  tidyr::pivot_wider(.,\n                      names_from = measurement, values_from = value)) %>%\n                # iv. Renaming variables with rename_with()\n                    purrr::map(~ rename_with(., ~c(\n                      \"DOY\",   # Date as Day of the year\n                      \"Year\",  # Year\n                      \"Month\", # Month \n                      \"Day\",   # Day of the month\n                      \"Date\",  # Date as normal format\n                      \"DL\",    # Day length (sec)\n                      \"PP\",    # Precipitation (mm)\n                      \"Rad\",   # Radiation (W/m2)\n                      \"SWE\",   # Snow water (kg/m2)\n                      \"Tmax\",  # Max. temp. (degC)\n                      \"Tmin\",  # Min. temp. (degC)\n                      \"VP\")))) %>%   # Vap Pres (Pa)\n    # STEP 4. Processing data given start and ending dates:\n    dplyr::mutate(Weather = purrr::pmap(list(sta = Start - dpp, \n                                             end = End, \n                                             data = Weather), # Requested period\n                                        function(sta, end, data) {\n                                          dplyr::filter(data, Date >= sta & Date <= end) \n                                          })) %>%\n    # STEP 5. Unnest\n    tidyr::unnest(cols = c(Weather)) %>% \n    \n    # STEP 6. Converting units and adding extra variables:\n    dplyr::mutate(Rad = Rad*0.000001*DL, # Radiation (W/m2 to MJ/m2)\n                  Tmean = (Tmax+Tmin)/2, # Mean temperature (degC),\n                  VP = VP / 1000, # VP (Pa to kPa),\n                  # Creating variables for ET0 estimation:\n                  lat_rad = latitude*0.0174533,\n                  dr = 1 + 0.033*cos((2*pi/365)*DOY),\n                  Sd = 0.409*sin((2*pi/365)*DOY - 1.39),\n                  ws = acos(-tan(lat_rad)*tan(Sd)),\n                  Ra = (24*60)/(pi) * Gsc * dr * (ws*sin(lat_rad)*sin(Sd) + cos(lat_rad)*sin(ws)),\n                  ET0_HS = 0.0135 * kRs * (Ra / 2.45) * (sqrt(Tmax-Tmin)) * (Tmean + 17.8),\n                  # Extreme PP events\n                  EPE_i = case_when((PP > 25) ~ 1, TRUE ~ 0),\n                  # Extreme Temp events\n                  ETE_i = case_when((Tmax >= 30) ~ 1, TRUE ~ 0),\n                  # Day length (hours)\n                  DL = (DL/60)/60 \n                  ) %>% \n    dplyr::select(-lat_rad, -dr, -Sd, -ws, -Ra)\n  \n}\n```\n:::\n\n\n\n## Run retrieving function\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Specify input = dataframe containing sites-data \n# Specify Days prior planting. Default is dpp = 0. Here we use dpp = 30.\n\ndf_weather_daymet <- weather.daymet(input = df_input, dpp = 30)\n\n# Overview of the variables (useful checking for missing values):\nskimr::skim(df_weather_daymet)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |                  |\n|:------------------------|:-----------------|\n|Name                     |df_weather_daymet |\n|Number of rows           |911               |\n|Number of columns        |25                |\n|_______________________  |                  |\n|Column type frequency:   |                  |\n|character                |3                 |\n|Date                     |5                 |\n|numeric                  |17                |\n|________________________ |                  |\n|Group variables          |None              |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|ID            |         0|             1|   1|   1|     0|        3|          0|\n|Crop          |         0|             1|   4|   7|     0|        2|          0|\n|Site          |         0|             1|   5|  10|     0|        3|          0|\n\n\n**Variable type: Date**\n\n|skim_variable | n_missing| complete_rate|min        |max        |median     | n_unique|\n|:-------------|---------:|-------------:|:----------|:----------|:----------|--------:|\n|Start         |         0|             1|2002-04-25 |2010-05-20 |2005-05-01 |        3|\n|End           |         0|             1|2002-09-30 |2010-10-10 |2006-09-30 |        3|\n|Flo           |         0|             1|2002-07-20 |2010-07-15 |2006-07-21 |        3|\n|SeFi          |         0|             1|2002-08-08 |2010-08-15 |2006-08-10 |        3|\n|Date          |         0|             1|2002-03-26 |2010-10-10 |2005-12-23 |      911|\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|    mean|    sd|      p0|     p25|     p50|     p75|    p100|hist  |\n|:-------------|---------:|-------------:|-------:|-----:|-------:|-------:|-------:|-------:|-------:|:-----|\n|latitude      |         0|             1|   43.20|  1.03|   42.45|   42.45|   42.45|   43.65|   45.08|▇▁▃▁▂ |\n|longitude     |         0|             1|  -80.33|  2.49|  -81.88|  -81.88|  -81.88|  -80.40|  -75.35|▇▃▁▁▂ |\n|DOY           |         0|             1|  184.55| 78.43|    1.00|  128.00|  185.00|  242.00|  365.00|▂▆▇▇▂ |\n|Year          |         0|             1| 2005.63|  2.56| 2002.00| 2005.00| 2005.00| 2006.00| 2010.00|▆▇▇▁▅ |\n|Month         |         0|             1|    6.58|  2.57|    1.00|    5.00|    7.00|    8.00|   12.00|▃▇▇▇▃ |\n|Day           |         0|             1|   15.83|  8.88|    1.00|    8.00|   16.00|   24.00|   31.00|▇▇▆▇▆ |\n|DL            |         0|             1|   13.17|  1.88|    8.89|   12.06|   13.68|   14.78|   15.44|▂▂▃▅▇ |\n|PP            |         0|             1|    2.53|  5.31|    0.00|    0.00|    0.00|    2.74|   45.09|▇▁▁▁▁ |\n|Rad           |         0|             1|   16.23|  6.78|    1.40|   11.31|   16.61|   21.63|   29.86|▃▆▇▇▃ |\n|SWE           |         0|             1|    0.98|  4.86|    0.00|    0.00|    0.00|    0.00|   41.65|▇▁▁▁▁ |\n|Tmax          |         0|             1|   18.74|  9.40|   -7.32|   12.90|   21.21|   26.16|   34.99|▁▃▅▇▅ |\n|Tmin          |         0|             1|    8.95|  8.13|  -15.01|    2.83|   10.31|   15.21|   24.83|▁▃▅▇▃ |\n|VP            |         0|             1|    1.26|  0.61|    0.19|    0.75|    1.21|    1.70|    3.14|▇▇▇▃▁ |\n|Tmean         |         0|             1|   13.84|  8.60|  -11.16|    7.73|   16.12|   20.52|   28.40|▁▃▅▇▆ |\n|ET0_HS        |         0|             1|    3.33|  1.66|    0.26|    2.03|    3.48|    4.69|    7.13|▆▆▇▇▂ |\n|EPE_i         |         0|             1|    0.01|  0.10|    0.00|    0.00|    0.00|    0.00|    1.00|▇▁▁▁▁ |\n|ETE_i         |         0|             1|    0.06|  0.23|    0.00|    0.00|    0.00|    0.00|    1.00|▇▁▁▁▁ |\n\n\n:::\n\n```{.r .cell-code}\n# Exporting data as a .csv file\n# write.csv(df.weather.daymet, row.names = FALSE, na = '', file = paste0(path, 'Output_daymet.csv'))\n```\n:::\n\n\n\n# Processing Weather Data\n## Define time intervals\n\nIn this section we create time intervals during the cropping season using pre-specified dates as columns at the initial data table with site information. <br/>\n\nThe user can apply: i) a unique seasonal interval (season), ii) even intervals (even), or iii) customized intervals (custom). <br/>\n\n### Full-season interval\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Defining season-intervals\nseason_interval <- \n  df_input %>%\n  dplyr::mutate(Interval = \"Season\") %>%\n  dplyr::rename(Start.in = Start, End.in = End) %>%\n  dplyr::select(ID, Site, Interval, Start.in, End.in)\n\n# Creating a table to visualize results\nkable(season_interval) %>% \n  kable_styling(latex_options = c(\"striped\"),\n                position = \"center\", font_size = 10)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"font-size: 10px; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> ID </th>\n   <th style=\"text-align:left;\"> Site </th>\n   <th style=\"text-align:left;\"> Interval </th>\n   <th style=\"text-align:left;\"> Start.in </th>\n   <th style=\"text-align:left;\"> End.in </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:left;\"> Season </td>\n   <td style=\"text-align:left;\"> 2002-04-25 </td>\n   <td style=\"text-align:left;\"> 2002-09-30 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> Ridgetown </td>\n   <td style=\"text-align:left;\"> Season </td>\n   <td style=\"text-align:left;\"> 2005-05-01 </td>\n   <td style=\"text-align:left;\"> 2006-09-30 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> Winchester </td>\n   <td style=\"text-align:left;\"> Season </td>\n   <td style=\"text-align:left;\"> 2010-05-20 </td>\n   <td style=\"text-align:left;\"> 2010-10-10 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n### Even-intervals\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Number of intervals:\nn <- 4 \n# Days prior planting:\ndpp <- 30 \n\n# Defining even-intervals:\neven_intervals <- \n  df_input %>% \n  # Create new data:\n  dplyr::mutate(Intervals = \n          purrr::map2(.x = Start, .y = End,\n                      .f = ~ data.frame(\n                    Interval = c(\"Prev\", # Prior to start date \n                                 LETTERS[0:n]), # Each interval from start date\n                      # Start\n                      Start.in = c(.x - dpp, seq.Date(.x, .y + 1, length.out = n + 1)[1:n]),                              # End\n                      End.in = c(.x - 1, seq.Date(.x, .y + 1, length.out = n + 1)[2:(n + 1)]))) ) %>% \n  # Selecting columns:\n  dplyr::select(ID, Site, Intervals) %>% \n  tidyr::unnest(cols = c(Intervals))\n\n# Creating a table to visualize results\nkable(even_intervals) %>% \n  kable_styling(latex_options = c(\"striped\"), \n                position = \"center\", font_size = 10)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"font-size: 10px; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> ID </th>\n   <th style=\"text-align:left;\"> Site </th>\n   <th style=\"text-align:left;\"> Interval </th>\n   <th style=\"text-align:left;\"> Start.in </th>\n   <th style=\"text-align:left;\"> End.in </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:left;\"> Prev </td>\n   <td style=\"text-align:left;\"> 2002-03-26 </td>\n   <td style=\"text-align:left;\"> 2002-04-24 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:left;\"> 2002-04-25 </td>\n   <td style=\"text-align:left;\"> 2002-06-03 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:left;\"> 2002-06-03 </td>\n   <td style=\"text-align:left;\"> 2002-07-13 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:left;\"> 2002-07-13 </td>\n   <td style=\"text-align:left;\"> 2002-08-22 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:left;\"> 2002-08-22 </td>\n   <td style=\"text-align:left;\"> 2002-10-01 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> Ridgetown </td>\n   <td style=\"text-align:left;\"> Prev </td>\n   <td style=\"text-align:left;\"> 2005-04-01 </td>\n   <td style=\"text-align:left;\"> 2005-04-30 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> Ridgetown </td>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:left;\"> 2005-05-01 </td>\n   <td style=\"text-align:left;\"> 2005-09-07 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> Ridgetown </td>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:left;\"> 2005-09-07 </td>\n   <td style=\"text-align:left;\"> 2006-01-15 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> Ridgetown </td>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:left;\"> 2006-01-15 </td>\n   <td style=\"text-align:left;\"> 2006-05-24 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> Ridgetown </td>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:left;\"> 2006-05-24 </td>\n   <td style=\"text-align:left;\"> 2006-10-01 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> Winchester </td>\n   <td style=\"text-align:left;\"> Prev </td>\n   <td style=\"text-align:left;\"> 2010-04-20 </td>\n   <td style=\"text-align:left;\"> 2010-05-19 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> Winchester </td>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:left;\"> 2010-05-20 </td>\n   <td style=\"text-align:left;\"> 2010-06-25 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> Winchester </td>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:left;\"> 2010-06-25 </td>\n   <td style=\"text-align:left;\"> 2010-07-31 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> Winchester </td>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:left;\"> 2010-07-31 </td>\n   <td style=\"text-align:left;\"> 2010-09-05 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> Winchester </td>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:left;\"> 2010-09-05 </td>\n   <td style=\"text-align:left;\"> 2010-10-11 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n### Custom-intervals\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Count the number of interval columns (assuming intervals start at column \"Start\")\ni <- df_input %>% dplyr::select(Start:last_col()) %>% ncol()\n\n# Defining custom-intervals\ncustom_intervals <- \n  df_input %>% \n  dplyr::mutate(Intervals = # Create\n                  purrr::pmap(# List of object to iterate over\n                              .l = list(x = Start - dpp,\n                                        y = Start,\n                                        z = Flo,\n                                        m = SeFi,\n                                        k = End),\n                              # The function to run\n                              .f = function(x, y, z, m, k) {\n                      data.frame(# New data\n                        Interval = c(LETTERS[1:i]),\n                        Name = c(\"Prev\", \"Plant-Flo\", \"Flo-SeFi\", \"SeFi-End\"),\n                        Start.in = c(x, y, z, m),\n                        End.in = c(y-1, z-1, m-1, k))}\n                    )) %>% \n  # Selecting columns:\n  dplyr::select(ID,, Site, Intervals) %>% \n  tidyr::unnest(cols = c(Intervals))\n\n# Creating a table to visualize results:\nkable(custom_intervals) %>% \n  kable_styling(latex_options = c(\"striped\"), position = \"center\", font_size = 10)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"font-size: 10px; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> ID </th>\n   <th style=\"text-align:left;\"> Site </th>\n   <th style=\"text-align:left;\"> Interval </th>\n   <th style=\"text-align:left;\"> Name </th>\n   <th style=\"text-align:left;\"> Start.in </th>\n   <th style=\"text-align:left;\"> End.in </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:left;\"> Prev </td>\n   <td style=\"text-align:left;\"> 2002-03-26 </td>\n   <td style=\"text-align:left;\"> 2002-04-24 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:left;\"> Plant-Flo </td>\n   <td style=\"text-align:left;\"> 2002-04-25 </td>\n   <td style=\"text-align:left;\"> 2002-07-19 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:left;\"> Flo-SeFi </td>\n   <td style=\"text-align:left;\"> 2002-07-20 </td>\n   <td style=\"text-align:left;\"> 2002-08-07 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:left;\"> SeFi-End </td>\n   <td style=\"text-align:left;\"> 2002-08-08 </td>\n   <td style=\"text-align:left;\"> 2002-09-30 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> Ridgetown </td>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:left;\"> Prev </td>\n   <td style=\"text-align:left;\"> 2005-04-01 </td>\n   <td style=\"text-align:left;\"> 2005-04-30 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> Ridgetown </td>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:left;\"> Plant-Flo </td>\n   <td style=\"text-align:left;\"> 2005-05-01 </td>\n   <td style=\"text-align:left;\"> 2006-07-20 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> Ridgetown </td>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:left;\"> Flo-SeFi </td>\n   <td style=\"text-align:left;\"> 2006-07-21 </td>\n   <td style=\"text-align:left;\"> 2006-08-09 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> Ridgetown </td>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:left;\"> SeFi-End </td>\n   <td style=\"text-align:left;\"> 2006-08-10 </td>\n   <td style=\"text-align:left;\"> 2006-09-30 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> Winchester </td>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:left;\"> Prev </td>\n   <td style=\"text-align:left;\"> 2010-04-20 </td>\n   <td style=\"text-align:left;\"> 2010-05-19 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> Winchester </td>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:left;\"> Plant-Flo </td>\n   <td style=\"text-align:left;\"> 2010-05-20 </td>\n   <td style=\"text-align:left;\"> 2010-07-14 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> Winchester </td>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:left;\"> Flo-SeFi </td>\n   <td style=\"text-align:left;\"> 2010-07-15 </td>\n   <td style=\"text-align:left;\"> 2010-08-14 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> Winchester </td>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:left;\"> SeFi-End </td>\n   <td style=\"text-align:left;\"> 2010-08-15 </td>\n   <td style=\"text-align:left;\"> 2010-10-10 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n## Summary function\n\nFor each of the period or interval of interest a variety of variables can be created. Here, we present a set of variables that can capture environmental variations that might be missing by analyzing standard weather data (precipitations, temperature, radiation). These variables represent an example that was used for studying influence of weather in corn yields by Correndo et al. (2021).  <br/>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Defining the function to summarize DAYMET and/or NASA-POWER\nsummary.daymet <- function(input, intervals) {\n  # Creates summaries of the DAYMET daily data over the requested period\n  # Args:\n  #  input = a weather data object such as df.weather.daymet with the daily weather data\n  #  intervals = a tibble with the start and end date for the summary period\n  # STEP 1. \n  intervals %>%\n    # NOTE: mergeing on ID only as the key, so remove Site:\n    dplyr::select(-Site) %>%\n    # Merging weather data:\n    dplyr::left_join(input %>%\n                     # Nesting weather data back for each site-ID:\n                     dplyr::select_if(names(.) %in% \n                                        c(\"ID\", \"Crop\", \"Site\",\n                                          \"Date\",\"DL\", \"PP\", \n                                          \"Rad\", \"Tmax\", \"Tmin\",\n                                          \"Tmean\", \"VP\", \"ET0_HS\")) %>%\n                     dplyr::group_by(ID, Crop, Site) %>% \n                     tidyr::nest(Weather = -c(ID, Crop, Site)) %>%\n                     dplyr::ungroup(), \n                   by = c(\"ID\")) %>% \n    # STEP 2. Create Weather column filtering for desired period only.\n    dplyr::mutate(Weather = purrr::pmap(\n      .l = list(x = Start.in,\n                y = End.in, \n                data = Weather),\n      # Filter function\n      .f = function(x, y, data) {\n        dplyr::filter(data, Date >= x & Date < y)} ) ) %>% \n    \n    # STEP 3. Calculation of variables (daily) that will be useful to summarize the intervals \n    dplyr::mutate(Weather = Weather %>% \n      # User must adapt depending on the crop (these ay be corn-specific)\n        purrr::map(~ mutate(.,\n                            # Extreme Precip. event:\n                            EPEi = case_when(PP > 25 ~1, TRUE ~ 0),\n                            # Extreme Temp. event:\n                            ETEi = case_when(Tmax >= 30 ~1, TRUE ~ 0), \n                            # Tmax factor,  crop heat units (CHU):\n                            Ymax = case_when(Tmax < 10 ~ 0,\n                                             Tmax >= 30 ~ 0,\n                                    TRUE ~ 3.33*(Tmax-10) - 0.084*(Tmax-10)^2),\n                            # Tmin factor, Crop heat units (CHU):\n                            Ymin = case_when(Tmin < 4.44 ~ 0, \n                                    TRUE ~ 1.8*(Tmin-4.44)), \n                            # Daily CHU:\n                            Yavg = (Ymax + Ymin)/2,\n                            # For WHEAT (diff. base temp and winter negatives)\n                            # # Tmin threshold Growing Degrees:\n                            # Gmin = case_when(Tmin >= 0 ~ Tmin, TRUE ~ 0),\n                            # # Tmax threshold Growing Degrees:\n                            # Gmax = case_when(Tmax > 30 ~ 30,\n                            #                  Tmin < 0 ~ 0, \n                            #                  between(Tmax, 0, 30) ~ Tmax),\n                            # # Daily Growing Degree Units:\n                            # GDU = ((Gmin + Gmax)/2) - 0,\n                            # GDD_c = cumsum(GDU) \n                            # For CORN, SOYBEAN (Base temp = 10)\n                            # Tmin threshold Growing Degrees:\n                            Gmin = case_when(Tmin >= 10 ~ Tmin, TRUE ~ 10),\n                            # Tmax threshold Growing Degrees:\n                            Gmax = case_when(Tmax <= 30 ~ Tmax,\n                                             Tmax > 30 ~ 30,\n                                             Tmin <= 10 ~ 10,\n                                             TRUE ~ 30),\n                            # Daily Growing Degree Units:\n                            GDU = ((Gmin + Gmax)/2) - 10) ) ) %>% \n    \n    # STEP 4. Summary for each variable over the period of interest:\n    dplyr::mutate(\n      # Duration of interval (days):\n      Dur = Weather %>% purrr::map(~nrow(.)),\n      # Accumulated PP (mm):\n      PP = Weather %>% purrr::map(~sum(.$PP)),\n      # Mean Temp (C):\n      Tmean = Weather %>% purrr::map(~mean(.$Tmean)),\n      # Accumulated Rad (MJ/m2):\n      Rad = Weather %>% purrr::map(~sum(.$Rad)),\n      # Accumulated VP (kPa):\n      VP = Weather %>% purrr::map(~sum(.$VP)),\n      # Accumulated ET0 (mm):\n      ET0_HS = Weather %>% purrr::map(~sum(.$ET0_HS)),\n      # Number of ETE (#):\n      ETE = Weather %>% purrr::map(~sum(.$ETEi)),\n      # Number of EPE (#):\n      EPE = Weather %>% purrr::map(~sum(.$EPEi)),\n      # Accumulated Crop Heat Units (CHU):\n      CHU = Weather %>% purrr::map(~sum(.$Yavg)),\n      # Shannon Diversity Index for PP:\n      SDI = Weather %>% purrr::map(~ vegan::diversity(.$PP, index = \"shannon\")/log(length(.$PP))),\n      # Accumulated Growing Degree Days (GDD):\n      GDD =  Weather %>% purrr::map(~sum(.$GDU))) %>% \n    \n    # Additional indices and final units:\n    dplyr::select(-Weather) %>% \n    # DS: `cols` is now required when using unnest()\n    tidyr::unnest(cols = c(Dur, PP, Tmean, Rad, VP, ET0_HS, ETE, EPE, CHU, SDI, GDD)) %>% \n    dplyr::mutate(\n      # Photo-thermal quotient (Q):\n      Q_chu = Rad/CHU,\n      Q_gdd = Rad/GDD,\n      # Abundant and Well Distributed Water:\n      AWDR = PP*SDI) \n  }\n```\n:::\n\n\n\n## Run summaries\n### Seasonal\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Run the summary\n# input = dataframe containing the data (from daymet).\n# intervals = type of intervals (season, custom or even)\n\nseason_summary_daymet <-\n  summary.daymet(input = df_weather_daymet,\n                           intervals = season_interval)\n\n# Skim data\nskimr::skim(season_summary_daymet)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |                      |\n|:------------------------|:---------------------|\n|Name                     |season_summary_daymet |\n|Number of rows           |3                     |\n|Number of columns        |20                    |\n|_______________________  |                      |\n|Column type frequency:   |                      |\n|character                |4                     |\n|Date                     |2                     |\n|numeric                  |14                    |\n|________________________ |                      |\n|Group variables          |None                  |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|ID            |         0|             1|   1|   1|     0|        3|          0|\n|Interval      |         0|             1|   6|   6|     0|        1|          0|\n|Crop          |         0|             1|   4|   7|     0|        2|          0|\n|Site          |         0|             1|   5|  10|     0|        3|          0|\n\n\n**Variable type: Date**\n\n|skim_variable | n_missing| complete_rate|min        |max        |median     | n_unique|\n|:-------------|---------:|-------------:|:----------|:----------|:----------|--------:|\n|Start.in      |         0|             1|2002-04-25 |2010-05-20 |2005-05-01 |        3|\n|End.in        |         0|             1|2002-09-30 |2010-10-10 |2006-09-30 |        3|\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|    mean|      sd|      p0|     p25|     p50|     p75|    p100|hist  |\n|:-------------|---------:|-------------:|-------:|-------:|-------:|-------:|-------:|-------:|-------:|:-----|\n|Dur           |         0|             1|  272.67|  211.73|  143.00|  150.50|  158.00|  337.50|  517.00|▇▁▁▁▃ |\n|PP            |         0|             1|  683.57|  395.63|  361.53|  462.75|  563.98|  844.58| 1125.19|▇▇▁▁▇ |\n|Tmean         |         0|             1|   16.04|    3.20|   12.55|   14.63|   16.70|   17.78|   18.85|▇▁▁▇▇ |\n|Rad           |         0|             1| 4359.96| 2895.00| 2394.44| 2697.73| 3001.02| 5342.72| 7684.42|▇▁▁▁▃ |\n|VP            |         0|             1|  358.94|  237.60|  218.15|  221.77|  225.40|  429.33|  633.26|▇▁▁▁▃ |\n|ET0_HS        |         0|             1|  925.30|  517.24|  594.03|  627.29|  660.56| 1090.94| 1521.32|▇▁▁▁▃ |\n|ETE           |         0|             1|   17.67|    3.79|   15.00|   15.50|   16.00|   19.00|   22.00|▇▁▁▁▃ |\n|EPE           |         0|             1|    2.67|    2.52|    0.00|    1.50|    3.00|    4.00|    5.00|▇▁▇▁▇ |\n|CHU           |         0|             1| 4323.15| 2564.95| 2740.35| 2843.47| 2946.59| 5114.55| 7282.51|▇▁▁▁▃ |\n|SDI           |         0|             1|    0.74|    0.03|    0.71|    0.74|    0.76|    0.76|    0.76|▃▁▁▁▇ |\n|GDD           |         0|             1| 1677.80|  742.37| 1208.96| 1249.85| 1290.73| 1912.22| 2533.71|▇▁▁▁▃ |\n|Q_chu         |         0|             1|    0.99|    0.15|    0.81|    0.93|    1.06|    1.08|    1.10|▃▁▁▁▇ |\n|Q_gdd         |         0|             1|    2.46|    0.59|    1.86|    2.17|    2.48|    2.76|    3.03|▇▁▇▁▇ |\n|AWDR          |         0|             1|  513.54|  307.39|  257.93|  343.01|  428.09|  641.35|  854.62|▇▇▁▁▇ |\n\n\n:::\n\n```{.r .cell-code}\n# Creating a table to visualize results\nkbl(season_summary_daymet) %>%\n  kable_styling(font_size = 7, position = \"center\", \n                latex_options = c(\"scale_down\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"font-size: 7px; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> ID </th>\n   <th style=\"text-align:left;\"> Interval </th>\n   <th style=\"text-align:left;\"> Start.in </th>\n   <th style=\"text-align:left;\"> End.in </th>\n   <th style=\"text-align:left;\"> Crop </th>\n   <th style=\"text-align:left;\"> Site </th>\n   <th style=\"text-align:right;\"> Dur </th>\n   <th style=\"text-align:right;\"> PP </th>\n   <th style=\"text-align:right;\"> Tmean </th>\n   <th style=\"text-align:right;\"> Rad </th>\n   <th style=\"text-align:right;\"> VP </th>\n   <th style=\"text-align:right;\"> ET0_HS </th>\n   <th style=\"text-align:right;\"> ETE </th>\n   <th style=\"text-align:right;\"> EPE </th>\n   <th style=\"text-align:right;\"> CHU </th>\n   <th style=\"text-align:right;\"> SDI </th>\n   <th style=\"text-align:right;\"> GDD </th>\n   <th style=\"text-align:right;\"> Q_chu </th>\n   <th style=\"text-align:right;\"> Q_gdd </th>\n   <th style=\"text-align:right;\"> AWDR </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> Season </td>\n   <td style=\"text-align:left;\"> 2002-04-25 </td>\n   <td style=\"text-align:left;\"> 2002-09-30 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:right;\"> 158 </td>\n   <td style=\"text-align:right;\"> 361.53 </td>\n   <td style=\"text-align:right;\"> 16.70405 </td>\n   <td style=\"text-align:right;\"> 3001.020 </td>\n   <td style=\"text-align:right;\"> 218.1533 </td>\n   <td style=\"text-align:right;\"> 660.5558 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 2740.348 </td>\n   <td style=\"text-align:right;\"> 0.7134269 </td>\n   <td style=\"text-align:right;\"> 1208.965 </td>\n   <td style=\"text-align:right;\"> 1.0951238 </td>\n   <td style=\"text-align:right;\"> 2.482305 </td>\n   <td style=\"text-align:right;\"> 257.9252 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> Season </td>\n   <td style=\"text-align:left;\"> 2005-05-01 </td>\n   <td style=\"text-align:left;\"> 2006-09-30 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Ridgetown </td>\n   <td style=\"text-align:right;\"> 517 </td>\n   <td style=\"text-align:right;\"> 1125.19 </td>\n   <td style=\"text-align:right;\"> 12.55279 </td>\n   <td style=\"text-align:right;\"> 7684.417 </td>\n   <td style=\"text-align:right;\"> 633.2642 </td>\n   <td style=\"text-align:right;\"> 1521.3225 </td>\n   <td style=\"text-align:right;\"> 22 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 7282.508 </td>\n   <td style=\"text-align:right;\"> 0.7595347 </td>\n   <td style=\"text-align:right;\"> 2533.715 </td>\n   <td style=\"text-align:right;\"> 1.0551883 </td>\n   <td style=\"text-align:right;\"> 3.032866 </td>\n   <td style=\"text-align:right;\"> 854.6209 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> Season </td>\n   <td style=\"text-align:left;\"> 2010-05-20 </td>\n   <td style=\"text-align:left;\"> 2010-10-10 </td>\n   <td style=\"text-align:left;\"> Soybean </td>\n   <td style=\"text-align:left;\"> Winchester </td>\n   <td style=\"text-align:right;\"> 143 </td>\n   <td style=\"text-align:right;\"> 563.98 </td>\n   <td style=\"text-align:right;\"> 18.85315 </td>\n   <td style=\"text-align:right;\"> 2394.440 </td>\n   <td style=\"text-align:right;\"> 225.3956 </td>\n   <td style=\"text-align:right;\"> 594.0311 </td>\n   <td style=\"text-align:right;\"> 15 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 2946.587 </td>\n   <td style=\"text-align:right;\"> 0.7590440 </td>\n   <td style=\"text-align:right;\"> 1290.725 </td>\n   <td style=\"text-align:right;\"> 0.8126148 </td>\n   <td style=\"text-align:right;\"> 1.855113 </td>\n   <td style=\"text-align:right;\"> 428.0856 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Even\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Run the summary\n# input = dataframe containing the data (from daymet).\n# intervals = type of intervals (season, custom or even)\n\neven_summary_daymet <-\n  summary.daymet(input = df_weather_daymet,\n                           intervals = even_intervals)\n\n# Skim data\nskimr::skim(even_summary_daymet)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |                    |\n|:------------------------|:-------------------|\n|Name                     |even_summary_daymet |\n|Number of rows           |15                  |\n|Number of columns        |20                  |\n|_______________________  |                    |\n|Column type frequency:   |                    |\n|character                |4                   |\n|Date                     |2                   |\n|numeric                  |14                  |\n|________________________ |                    |\n|Group variables          |None                |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|ID            |         0|             1|   1|   1|     0|        3|          0|\n|Interval      |         0|             1|   1|   4|     0|        5|          0|\n|Crop          |         0|             1|   4|   7|     0|        2|          0|\n|Site          |         0|             1|   5|  10|     0|        3|          0|\n\n\n**Variable type: Date**\n\n|skim_variable | n_missing| complete_rate|min        |max        |median     | n_unique|\n|:-------------|---------:|-------------:|:----------|:----------|:----------|--------:|\n|Start.in      |         0|             1|2002-03-26 |2010-09-05 |2005-09-07 |       15|\n|End.in        |         0|             1|2002-04-24 |2010-10-11 |2006-01-15 |       15|\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|   mean|     sd|      p0|    p25|    p50|    p75|    p100|hist  |\n|:-------------|---------:|-------------:|------:|------:|-------:|------:|------:|------:|-------:|:-----|\n|Dur           |         0|             1|  60.53|  43.22|   29.00|  36.00|  39.00|  84.50|  130.00|▇▁▁▁▃ |\n|PP            |         0|             1| 153.76|  92.73|   45.94|  92.45| 113.04| 208.32|  364.82|▇▃▂▂▁ |\n|Tmean         |         0|             1|  14.46|   6.40|    4.11|   8.35|  18.00|  19.57|   22.11|▃▃▁▁▇ |\n|Rad           |         0|             1| 981.82| 680.51|  402.74| 595.51| 707.50| 924.39| 2563.53|▇▂▁▁▂ |\n|VP            |         0|             1|  76.45|  62.46|   21.08|  37.52|  62.84|  77.33|  218.10|▇▆▁▁▂ |\n|ET0_HS        |         0|             1| 201.85| 152.45|   63.49| 117.28| 174.13| 198.55|  576.34|▇▇▁▁▂ |\n|ETE           |         0|             1|   3.53|   4.34|    0.00|   0.00|   2.00|   6.00|   14.00|▇▃▂▁▁ |\n|EPE           |         0|             1|   0.60|   0.74|    0.00|   0.00|   0.00|   1.00|    2.00|▇▁▅▁▂ |\n|CHU           |         0|             1| 908.91| 846.64|  145.26| 415.56| 782.24| 865.76| 2963.26|▇▇▁▁▂ |\n|SDI           |         0|             1|   0.64|   0.07|    0.43|   0.61|   0.65|   0.69|    0.73|▁▁▃▅▇ |\n|GDD           |         0|             1| 347.29| 409.21| -112.18|  98.38| 319.40| 404.69| 1285.44|▇▇▁▁▂ |\n|Q_chu         |         0|             1|   1.57|   1.11|    0.73|   0.82|   0.92|   2.28|    3.59|▇▁▁▁▂ |\n|Q_gdd         |         0|             1|   7.47|  19.56|  -15.99|   1.79|   2.15|   7.00|   74.52|▇▇▁▁▁ |\n|AWDR          |         0|             1| 102.83|  68.43|   26.06|  57.67|  77.62| 145.51|  263.99|▇▃▂▂▁ |\n\n\n:::\n\n```{.r .cell-code}\n# Creating a table to visualize results\nkbl(even_summary_daymet) %>%\n  kable_styling(font_size = 7, position = \"center\", \n                latex_options = c(\"scale_down\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"font-size: 7px; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> ID </th>\n   <th style=\"text-align:left;\"> Interval </th>\n   <th style=\"text-align:left;\"> Start.in </th>\n   <th style=\"text-align:left;\"> End.in </th>\n   <th style=\"text-align:left;\"> Crop </th>\n   <th style=\"text-align:left;\"> Site </th>\n   <th style=\"text-align:right;\"> Dur </th>\n   <th style=\"text-align:right;\"> PP </th>\n   <th style=\"text-align:right;\"> Tmean </th>\n   <th style=\"text-align:right;\"> Rad </th>\n   <th style=\"text-align:right;\"> VP </th>\n   <th style=\"text-align:right;\"> ET0_HS </th>\n   <th style=\"text-align:right;\"> ETE </th>\n   <th style=\"text-align:right;\"> EPE </th>\n   <th style=\"text-align:right;\"> CHU </th>\n   <th style=\"text-align:right;\"> SDI </th>\n   <th style=\"text-align:right;\"> GDD </th>\n   <th style=\"text-align:right;\"> Q_chu </th>\n   <th style=\"text-align:right;\"> Q_gdd </th>\n   <th style=\"text-align:right;\"> AWDR </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> Prev </td>\n   <td style=\"text-align:left;\"> 2002-03-26 </td>\n   <td style=\"text-align:left;\"> 2002-04-24 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:right;\"> 29 </td>\n   <td style=\"text-align:right;\"> 95.53 </td>\n   <td style=\"text-align:right;\"> 5.660000 </td>\n   <td style=\"text-align:right;\"> 505.2583 </td>\n   <td style=\"text-align:right;\"> 21.08116 </td>\n   <td style=\"text-align:right;\"> 63.48611 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 154.3458 </td>\n   <td style=\"text-align:right;\"> 0.6357661 </td>\n   <td style=\"text-align:right;\"> 6.780 </td>\n   <td style=\"text-align:right;\"> 3.2735469 </td>\n   <td style=\"text-align:right;\"> 74.521875 </td>\n   <td style=\"text-align:right;\"> 60.73474 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:left;\"> 2002-04-25 </td>\n   <td style=\"text-align:left;\"> 2002-06-03 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:right;\"> 40 </td>\n   <td style=\"text-align:right;\"> 113.04 </td>\n   <td style=\"text-align:right;\"> 8.802250 </td>\n   <td style=\"text-align:right;\"> 800.8372 </td>\n   <td style=\"text-align:right;\"> 33.52344 </td>\n   <td style=\"text-align:right;\"> 128.07920 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 292.5157 </td>\n   <td style=\"text-align:right;\"> 0.6866269 </td>\n   <td style=\"text-align:right;\"> 84.400 </td>\n   <td style=\"text-align:right;\"> 2.7377578 </td>\n   <td style=\"text-align:right;\"> 9.488593 </td>\n   <td style=\"text-align:right;\"> 77.61630 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:left;\"> 2002-06-03 </td>\n   <td style=\"text-align:left;\"> 2002-07-13 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:right;\"> 40 </td>\n   <td style=\"text-align:right;\"> 98.94 </td>\n   <td style=\"text-align:right;\"> 19.117375 </td>\n   <td style=\"text-align:right;\"> 856.4385 </td>\n   <td style=\"text-align:right;\"> 62.83969 </td>\n   <td style=\"text-align:right;\"> 202.20827 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 823.2502 </td>\n   <td style=\"text-align:right;\"> 0.6508401 </td>\n   <td style=\"text-align:right;\"> 371.250 </td>\n   <td style=\"text-align:right;\"> 1.0403138 </td>\n   <td style=\"text-align:right;\"> 2.306905 </td>\n   <td style=\"text-align:right;\"> 64.39412 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:left;\"> 2002-07-13 </td>\n   <td style=\"text-align:left;\"> 2002-08-22 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:right;\"> 40 </td>\n   <td style=\"text-align:right;\"> 89.36 </td>\n   <td style=\"text-align:right;\"> 20.994750 </td>\n   <td style=\"text-align:right;\"> 752.2604 </td>\n   <td style=\"text-align:right;\"> 69.43155 </td>\n   <td style=\"text-align:right;\"> 194.90035 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 893.7629 </td>\n   <td style=\"text-align:right;\"> 0.5993348 </td>\n   <td style=\"text-align:right;\"> 437.950 </td>\n   <td style=\"text-align:right;\"> 0.8416778 </td>\n   <td style=\"text-align:right;\"> 1.717685 </td>\n   <td style=\"text-align:right;\"> 53.55656 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:left;\"> 2002-08-22 </td>\n   <td style=\"text-align:left;\"> 2002-10-01 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:right;\"> 39 </td>\n   <td style=\"text-align:right;\"> 60.83 </td>\n   <td style=\"text-align:right;\"> 17.997436 </td>\n   <td style=\"text-align:right;\"> 604.4711 </td>\n   <td style=\"text-align:right;\"> 53.82624 </td>\n   <td style=\"text-align:right;\"> 138.43587 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 754.0653 </td>\n   <td style=\"text-align:right;\"> 0.4283610 </td>\n   <td style=\"text-align:right;\"> 324.600 </td>\n   <td style=\"text-align:right;\"> 0.8016164 </td>\n   <td style=\"text-align:right;\"> 1.862203 </td>\n   <td style=\"text-align:right;\"> 26.05720 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> Prev </td>\n   <td style=\"text-align:left;\"> 2005-04-01 </td>\n   <td style=\"text-align:left;\"> 2005-04-30 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Ridgetown </td>\n   <td style=\"text-align:right;\"> 29 </td>\n   <td style=\"text-align:right;\"> 105.04 </td>\n   <td style=\"text-align:right;\"> 7.902759 </td>\n   <td style=\"text-align:right;\"> 522.1453 </td>\n   <td style=\"text-align:right;\"> 21.72264 </td>\n   <td style=\"text-align:right;\"> 75.06876 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 145.2592 </td>\n   <td style=\"text-align:right;\"> 0.5923778 </td>\n   <td style=\"text-align:right;\"> 41.800 </td>\n   <td style=\"text-align:right;\"> 3.5945772 </td>\n   <td style=\"text-align:right;\"> 12.491513 </td>\n   <td style=\"text-align:right;\"> 62.22337 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:left;\"> 2005-05-01 </td>\n   <td style=\"text-align:left;\"> 2005-09-07 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Ridgetown </td>\n   <td style=\"text-align:right;\"> 130 </td>\n   <td style=\"text-align:right;\"> 225.28 </td>\n   <td style=\"text-align:right;\"> 19.555615 </td>\n   <td style=\"text-align:right;\"> 2563.5280 </td>\n   <td style=\"text-align:right;\"> 216.16182 </td>\n   <td style=\"text-align:right;\"> 576.34481 </td>\n   <td style=\"text-align:right;\"> 14 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 2793.4159 </td>\n   <td style=\"text-align:right;\"> 0.6940917 </td>\n   <td style=\"text-align:right;\"> 1285.435 </td>\n   <td style=\"text-align:right;\"> 0.9177037 </td>\n   <td style=\"text-align:right;\"> 1.994288 </td>\n   <td style=\"text-align:right;\"> 156.36498 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:left;\"> 2005-09-07 </td>\n   <td style=\"text-align:left;\"> 2006-01-15 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Ridgetown </td>\n   <td style=\"text-align:right;\"> 129 </td>\n   <td style=\"text-align:right;\"> 255.66 </td>\n   <td style=\"text-align:right;\"> 6.956744 </td>\n   <td style=\"text-align:right;\"> 992.3342 </td>\n   <td style=\"text-align:right;\"> 115.05132 </td>\n   <td style=\"text-align:right;\"> 174.13068 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1025.8802 </td>\n   <td style=\"text-align:right;\"> 0.6752569 </td>\n   <td style=\"text-align:right;\"> 112.950 </td>\n   <td style=\"text-align:right;\"> 0.9673003 </td>\n   <td style=\"text-align:right;\"> 8.785606 </td>\n   <td style=\"text-align:right;\"> 172.63617 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:left;\"> 2006-01-15 </td>\n   <td style=\"text-align:left;\"> 2006-05-24 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Ridgetown </td>\n   <td style=\"text-align:right;\"> 130 </td>\n   <td style=\"text-align:right;\"> 287.94 </td>\n   <td style=\"text-align:right;\"> 4.109692 </td>\n   <td style=\"text-align:right;\"> 1793.2989 </td>\n   <td style=\"text-align:right;\"> 85.09908 </td>\n   <td style=\"text-align:right;\"> 236.08072 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 510.1460 </td>\n   <td style=\"text-align:right;\"> 0.6804557 </td>\n   <td style=\"text-align:right;\"> -112.175 </td>\n   <td style=\"text-align:right;\"> 3.5152659 </td>\n   <td style=\"text-align:right;\"> -15.986619 </td>\n   <td style=\"text-align:right;\"> 195.93041 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:left;\"> 2006-05-24 </td>\n   <td style=\"text-align:left;\"> 2006-10-01 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Ridgetown </td>\n   <td style=\"text-align:right;\"> 129 </td>\n   <td style=\"text-align:right;\"> 364.82 </td>\n   <td style=\"text-align:right;\"> 19.592442 </td>\n   <td style=\"text-align:right;\"> 2341.9490 </td>\n   <td style=\"text-align:right;\"> 218.10287 </td>\n   <td style=\"text-align:right;\"> 536.30800 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 2963.2599 </td>\n   <td style=\"text-align:right;\"> 0.7236240 </td>\n   <td style=\"text-align:right;\"> 1249.530 </td>\n   <td style=\"text-align:right;\"> 0.7903286 </td>\n   <td style=\"text-align:right;\"> 1.874264 </td>\n   <td style=\"text-align:right;\"> 263.99249 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> Prev </td>\n   <td style=\"text-align:left;\"> 2010-04-20 </td>\n   <td style=\"text-align:left;\"> 2010-05-19 </td>\n   <td style=\"text-align:left;\"> Soybean </td>\n   <td style=\"text-align:left;\"> Winchester </td>\n   <td style=\"text-align:right;\"> 29 </td>\n   <td style=\"text-align:right;\"> 45.94 </td>\n   <td style=\"text-align:right;\"> 11.114483 </td>\n   <td style=\"text-align:right;\"> 586.5492 </td>\n   <td style=\"text-align:right;\"> 23.85418 </td>\n   <td style=\"text-align:right;\"> 106.48366 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 320.9666 </td>\n   <td style=\"text-align:right;\"> 0.5915947 </td>\n   <td style=\"text-align:right;\"> 112.350 </td>\n   <td style=\"text-align:right;\"> 1.8274459 </td>\n   <td style=\"text-align:right;\"> 5.220732 </td>\n   <td style=\"text-align:right;\"> 27.17786 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:left;\"> 2010-05-20 </td>\n   <td style=\"text-align:left;\"> 2010-06-25 </td>\n   <td style=\"text-align:left;\"> Soybean </td>\n   <td style=\"text-align:left;\"> Winchester </td>\n   <td style=\"text-align:right;\"> 36 </td>\n   <td style=\"text-align:right;\"> 119.18 </td>\n   <td style=\"text-align:right;\"> 18.890417 </td>\n   <td style=\"text-align:right;\"> 685.8864 </td>\n   <td style=\"text-align:right;\"> 51.43909 </td>\n   <td style=\"text-align:right;\"> 177.92863 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 782.2378 </td>\n   <td style=\"text-align:right;\"> 0.7315317 </td>\n   <td style=\"text-align:right;\"> 319.395 </td>\n   <td style=\"text-align:right;\"> 0.8768259 </td>\n   <td style=\"text-align:right;\"> 2.147455 </td>\n   <td style=\"text-align:right;\"> 87.18395 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:left;\"> 2010-06-25 </td>\n   <td style=\"text-align:left;\"> 2010-07-31 </td>\n   <td style=\"text-align:left;\"> Soybean </td>\n   <td style=\"text-align:left;\"> Winchester </td>\n   <td style=\"text-align:right;\"> 36 </td>\n   <td style=\"text-align:right;\"> 85.30 </td>\n   <td style=\"text-align:right;\"> 22.106111 </td>\n   <td style=\"text-align:right;\"> 707.4951 </td>\n   <td style=\"text-align:right;\"> 69.55371 </td>\n   <td style=\"text-align:right;\"> 184.06589 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 817.1332 </td>\n   <td style=\"text-align:right;\"> 0.6402241 </td>\n   <td style=\"text-align:right;\"> 426.640 </td>\n   <td style=\"text-align:right;\"> 0.8658260 </td>\n   <td style=\"text-align:right;\"> 1.658295 </td>\n   <td style=\"text-align:right;\"> 54.61112 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:left;\"> 2010-07-31 </td>\n   <td style=\"text-align:left;\"> 2010-09-05 </td>\n   <td style=\"text-align:left;\"> Soybean </td>\n   <td style=\"text-align:left;\"> Winchester </td>\n   <td style=\"text-align:right;\"> 36 </td>\n   <td style=\"text-align:right;\"> 168.14 </td>\n   <td style=\"text-align:right;\"> 20.660556 </td>\n   <td style=\"text-align:right;\"> 612.1467 </td>\n   <td style=\"text-align:right;\"> 63.55369 </td>\n   <td style=\"text-align:right;\"> 150.74414 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 837.7504 </td>\n   <td style=\"text-align:right;\"> 0.6259308 </td>\n   <td style=\"text-align:right;\"> 382.745 </td>\n   <td style=\"text-align:right;\"> 0.7307030 </td>\n   <td style=\"text-align:right;\"> 1.599359 </td>\n   <td style=\"text-align:right;\"> 105.24400 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:left;\"> 2010-09-05 </td>\n   <td style=\"text-align:left;\"> 2010-10-11 </td>\n   <td style=\"text-align:left;\"> Soybean </td>\n   <td style=\"text-align:left;\"> Winchester </td>\n   <td style=\"text-align:right;\"> 36 </td>\n   <td style=\"text-align:right;\"> 191.36 </td>\n   <td style=\"text-align:right;\"> 13.492083 </td>\n   <td style=\"text-align:right;\"> 402.7351 </td>\n   <td style=\"text-align:right;\"> 41.51125 </td>\n   <td style=\"text-align:right;\"> 83.48533 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 519.7147 </td>\n   <td style=\"text-align:right;\"> 0.7037089 </td>\n   <td style=\"text-align:right;\"> 165.755 </td>\n   <td style=\"text-align:right;\"> 0.7749157 </td>\n   <td style=\"text-align:right;\"> 2.429701 </td>\n   <td style=\"text-align:right;\"> 134.66174 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n### Custom\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Run the summary\n# input = dataframe containing the data (from daymet).\n# intervals = type of intervals (season, custom or even)\n\ncustom_summary_daymet <-\n  summary.daymet(input = df_weather_daymet,\n                           intervals = custom_intervals)\n\n# Skim data\nskimr::skim(custom_summary_daymet)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |                      |\n|:------------------------|:---------------------|\n|Name                     |custom_summary_daymet |\n|Number of rows           |12                    |\n|Number of columns        |21                    |\n|_______________________  |                      |\n|Column type frequency:   |                      |\n|character                |5                     |\n|Date                     |2                     |\n|numeric                  |14                    |\n|________________________ |                      |\n|Group variables          |None                  |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|ID            |         0|             1|   1|   1|     0|        3|          0|\n|Interval      |         0|             1|   1|   1|     0|        4|          0|\n|Name          |         0|             1|   4|   9|     0|        4|          0|\n|Crop          |         0|             1|   4|   7|     0|        2|          0|\n|Site          |         0|             1|   5|  10|     0|        3|          0|\n\n\n**Variable type: Date**\n\n|skim_variable | n_missing| complete_rate|min        |max        |median     | n_unique|\n|:-------------|---------:|-------------:|:----------|:----------|:----------|--------:|\n|Start.in      |         0|             1|2002-03-26 |2010-08-15 |2005-12-10 |       12|\n|End.in        |         0|             1|2002-04-24 |2010-10-10 |2006-07-30 |       12|\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|    mean|      sd|     p0|    p25|    p50|     p75|    p100|hist  |\n|:-------------|---------:|-------------:|-------:|-------:|------:|------:|------:|-------:|-------:|:-----|\n|Dur           |         0|             1|   74.92|  118.16|  18.00|  29.00|  40.50|   55.25|  445.00|▇▁▁▁▁ |\n|PP            |         0|             1|  191.43|  233.36|  45.94|  82.21| 100.29|  188.89|  895.24|▇▁▁▁▁ |\n|Tmean         |         0|             1|   15.79|    5.72|   5.66|  11.36|  16.97|   20.28|   23.58|▅▅▅▇▇ |\n|Rad           |         0|             1| 1214.16| 1723.57| 332.92| 517.92| 653.53|  913.03| 6546.07|▇▁▁▁▁ |\n|VP            |         0|             1|   94.38|  133.33|  21.08|  30.15|  66.72|   81.44|  507.83|▇▁▁▁▁ |\n|ET0_HS        |         0|             1|  249.35|  330.83|  63.49|  89.12| 151.66|  222.19| 1261.95|▇▁▁▁▁ |\n|ETE           |         0|             1|    4.42|    5.12|   0.00|   0.00|   3.50|    6.25|   18.00|▇▅▁▁▁ |\n|EPE           |         0|             1|    0.75|    1.48|   0.00|   0.00|   0.00|    1.00|    5.00|▇▁▁▁▁ |\n|CHU           |         0|             1| 1119.50| 1476.59| 145.26| 389.46| 852.85| 1123.81| 5634.82|▇▁▁▁▁ |\n|SDI           |         0|             1|    0.64|    0.08|   0.52|   0.58|   0.61|    0.72|    0.75|▆▆▂▂▇ |\n|GDD           |         0|             1|  427.22|  482.32|   6.78| 178.38| 362.19|  483.34| 1848.98|▇▇▁▁▁ |\n|Q_chu         |         0|             1|    1.39|    1.02|   0.68|   0.76|   0.86|    1.54|    3.59|▇▂▁▁▂ |\n|Q_gdd         |         0|             1|    9.28|   20.78|   1.30|   1.79|   1.94|    3.96|   74.52|▇▁▁▁▁ |\n|AWDR          |         0|             1|  133.24|  178.12|  27.18|  44.11|  61.48|  140.08|  668.48|▇▁▁▁▁ |\n\n\n:::\n\n```{.r .cell-code}\n# Creating a table to visualize results\nkbl(custom_summary_daymet) %>%\n  kable_styling(font_size = 7, position = \"center\", \n                latex_options = c(\"scale_down\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"font-size: 7px; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> ID </th>\n   <th style=\"text-align:left;\"> Interval </th>\n   <th style=\"text-align:left;\"> Name </th>\n   <th style=\"text-align:left;\"> Start.in </th>\n   <th style=\"text-align:left;\"> End.in </th>\n   <th style=\"text-align:left;\"> Crop </th>\n   <th style=\"text-align:left;\"> Site </th>\n   <th style=\"text-align:right;\"> Dur </th>\n   <th style=\"text-align:right;\"> PP </th>\n   <th style=\"text-align:right;\"> Tmean </th>\n   <th style=\"text-align:right;\"> Rad </th>\n   <th style=\"text-align:right;\"> VP </th>\n   <th style=\"text-align:right;\"> ET0_HS </th>\n   <th style=\"text-align:right;\"> ETE </th>\n   <th style=\"text-align:right;\"> EPE </th>\n   <th style=\"text-align:right;\"> CHU </th>\n   <th style=\"text-align:right;\"> SDI </th>\n   <th style=\"text-align:right;\"> GDD </th>\n   <th style=\"text-align:right;\"> Q_chu </th>\n   <th style=\"text-align:right;\"> Q_gdd </th>\n   <th style=\"text-align:right;\"> AWDR </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:left;\"> Prev </td>\n   <td style=\"text-align:left;\"> 2002-03-26 </td>\n   <td style=\"text-align:left;\"> 2002-04-24 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:right;\"> 29 </td>\n   <td style=\"text-align:right;\"> 95.53 </td>\n   <td style=\"text-align:right;\"> 5.660000 </td>\n   <td style=\"text-align:right;\"> 505.2583 </td>\n   <td style=\"text-align:right;\"> 21.08116 </td>\n   <td style=\"text-align:right;\"> 63.48611 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 154.3458 </td>\n   <td style=\"text-align:right;\"> 0.6357661 </td>\n   <td style=\"text-align:right;\"> 6.780 </td>\n   <td style=\"text-align:right;\"> 3.2735469 </td>\n   <td style=\"text-align:right;\"> 74.521875 </td>\n   <td style=\"text-align:right;\"> 60.73474 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:left;\"> Plant-Flo </td>\n   <td style=\"text-align:left;\"> 2002-04-25 </td>\n   <td style=\"text-align:left;\"> 2002-07-19 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:right;\"> 85 </td>\n   <td style=\"text-align:right;\"> 211.98 </td>\n   <td style=\"text-align:right;\"> 14.478353 </td>\n   <td style=\"text-align:right;\"> 1767.0401 </td>\n   <td style=\"text-align:right;\"> 105.60612 </td>\n   <td style=\"text-align:right;\"> 358.83259 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1218.2390 </td>\n   <td style=\"text-align:right;\"> 0.7117824 </td>\n   <td style=\"text-align:right;\"> 518.900 </td>\n   <td style=\"text-align:right;\"> 1.4504872 </td>\n   <td style=\"text-align:right;\"> 3.405358 </td>\n   <td style=\"text-align:right;\"> 150.88364 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:left;\"> Flo-SeFi </td>\n   <td style=\"text-align:left;\"> 2002-07-20 </td>\n   <td style=\"text-align:left;\"> 2002-08-07 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 61.48 </td>\n   <td style=\"text-align:right;\"> 21.249444 </td>\n   <td style=\"text-align:right;\"> 333.0742 </td>\n   <td style=\"text-align:right;\"> 32.24373 </td>\n   <td style=\"text-align:right;\"> 89.48994 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 412.2869 </td>\n   <td style=\"text-align:right;\"> 0.5459508 </td>\n   <td style=\"text-align:right;\"> 200.385 </td>\n   <td style=\"text-align:right;\"> 0.8078700 </td>\n   <td style=\"text-align:right;\"> 1.662171 </td>\n   <td style=\"text-align:right;\"> 33.56506 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:left;\"> SeFi-End </td>\n   <td style=\"text-align:left;\"> 2002-08-08 </td>\n   <td style=\"text-align:left;\"> 2002-09-30 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:right;\"> 53 </td>\n   <td style=\"text-align:right;\"> 88.07 </td>\n   <td style=\"text-align:right;\"> 18.649434 </td>\n   <td style=\"text-align:right;\"> 861.4328 </td>\n   <td style=\"text-align:right;\"> 77.13351 </td>\n   <td style=\"text-align:right;\"> 203.26534 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1063.5927 </td>\n   <td style=\"text-align:right;\"> 0.5490199 </td>\n   <td style=\"text-align:right;\"> 471.480 </td>\n   <td style=\"text-align:right;\"> 0.8099273 </td>\n   <td style=\"text-align:right;\"> 1.827082 </td>\n   <td style=\"text-align:right;\"> 48.35218 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:left;\"> Prev </td>\n   <td style=\"text-align:left;\"> 2005-04-01 </td>\n   <td style=\"text-align:left;\"> 2005-04-30 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Ridgetown </td>\n   <td style=\"text-align:right;\"> 29 </td>\n   <td style=\"text-align:right;\"> 105.04 </td>\n   <td style=\"text-align:right;\"> 7.902759 </td>\n   <td style=\"text-align:right;\"> 522.1453 </td>\n   <td style=\"text-align:right;\"> 21.72264 </td>\n   <td style=\"text-align:right;\"> 75.06876 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 145.2592 </td>\n   <td style=\"text-align:right;\"> 0.5923778 </td>\n   <td style=\"text-align:right;\"> 41.800 </td>\n   <td style=\"text-align:right;\"> 3.5945772 </td>\n   <td style=\"text-align:right;\"> 12.491513 </td>\n   <td style=\"text-align:right;\"> 62.22337 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:left;\"> Plant-Flo </td>\n   <td style=\"text-align:left;\"> 2005-05-01 </td>\n   <td style=\"text-align:left;\"> 2006-07-20 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Ridgetown </td>\n   <td style=\"text-align:right;\"> 445 </td>\n   <td style=\"text-align:right;\"> 895.24 </td>\n   <td style=\"text-align:right;\"> 11.445236 </td>\n   <td style=\"text-align:right;\"> 6546.0731 </td>\n   <td style=\"text-align:right;\"> 507.83287 </td>\n   <td style=\"text-align:right;\"> 1261.94680 </td>\n   <td style=\"text-align:right;\"> 18 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 5634.8226 </td>\n   <td style=\"text-align:right;\"> 0.7467051 </td>\n   <td style=\"text-align:right;\"> 1848.980 </td>\n   <td style=\"text-align:right;\"> 1.1617177 </td>\n   <td style=\"text-align:right;\"> 3.540370 </td>\n   <td style=\"text-align:right;\"> 668.48028 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:left;\"> Flo-SeFi </td>\n   <td style=\"text-align:left;\"> 2006-07-21 </td>\n   <td style=\"text-align:left;\"> 2006-08-09 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Ridgetown </td>\n   <td style=\"text-align:right;\"> 19 </td>\n   <td style=\"text-align:right;\"> 71.87 </td>\n   <td style=\"text-align:right;\"> 23.582632 </td>\n   <td style=\"text-align:right;\"> 332.9171 </td>\n   <td style=\"text-align:right;\"> 42.49005 </td>\n   <td style=\"text-align:right;\"> 87.99388 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 492.0876 </td>\n   <td style=\"text-align:right;\"> 0.5904150 </td>\n   <td style=\"text-align:right;\"> 255.540 </td>\n   <td style=\"text-align:right;\"> 0.6765403 </td>\n   <td style=\"text-align:right;\"> 1.302798 </td>\n   <td style=\"text-align:right;\"> 42.43313 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 2 </td>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:left;\"> SeFi-End </td>\n   <td style=\"text-align:left;\"> 2006-08-10 </td>\n   <td style=\"text-align:left;\"> 2006-09-30 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Ridgetown </td>\n   <td style=\"text-align:right;\"> 51 </td>\n   <td style=\"text-align:right;\"> 158.08 </td>\n   <td style=\"text-align:right;\"> 17.779314 </td>\n   <td style=\"text-align:right;\"> 760.1808 </td>\n   <td style=\"text-align:right;\"> 79.45679 </td>\n   <td style=\"text-align:right;\"> 161.56523 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1104.2616 </td>\n   <td style=\"text-align:right;\"> 0.6849177 </td>\n   <td style=\"text-align:right;\"> 407.350 </td>\n   <td style=\"text-align:right;\"> 0.6884064 </td>\n   <td style=\"text-align:right;\"> 1.866161 </td>\n   <td style=\"text-align:right;\"> 108.27178 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:left;\"> Prev </td>\n   <td style=\"text-align:left;\"> 2010-04-20 </td>\n   <td style=\"text-align:left;\"> 2010-05-19 </td>\n   <td style=\"text-align:left;\"> Soybean </td>\n   <td style=\"text-align:left;\"> Winchester </td>\n   <td style=\"text-align:right;\"> 29 </td>\n   <td style=\"text-align:right;\"> 45.94 </td>\n   <td style=\"text-align:right;\"> 11.114483 </td>\n   <td style=\"text-align:right;\"> 586.5492 </td>\n   <td style=\"text-align:right;\"> 23.85418 </td>\n   <td style=\"text-align:right;\"> 106.48366 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 320.9666 </td>\n   <td style=\"text-align:right;\"> 0.5915947 </td>\n   <td style=\"text-align:right;\"> 112.350 </td>\n   <td style=\"text-align:right;\"> 1.8274459 </td>\n   <td style=\"text-align:right;\"> 5.220732 </td>\n   <td style=\"text-align:right;\"> 27.17786 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:left;\"> Plant-Flo </td>\n   <td style=\"text-align:left;\"> 2010-05-20 </td>\n   <td style=\"text-align:left;\"> 2010-07-14 </td>\n   <td style=\"text-align:left;\"> Soybean </td>\n   <td style=\"text-align:left;\"> Winchester </td>\n   <td style=\"text-align:right;\"> 55 </td>\n   <td style=\"text-align:right;\"> 181.19 </td>\n   <td style=\"text-align:right;\"> 19.959273 </td>\n   <td style=\"text-align:right;\"> 1067.8207 </td>\n   <td style=\"text-align:right;\"> 87.38554 </td>\n   <td style=\"text-align:right;\"> 278.97376 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1182.4459 </td>\n   <td style=\"text-align:right;\"> 0.7532597 </td>\n   <td style=\"text-align:right;\"> 538.705 </td>\n   <td style=\"text-align:right;\"> 0.9030610 </td>\n   <td style=\"text-align:right;\"> 1.982199 </td>\n   <td style=\"text-align:right;\"> 136.48312 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:left;\"> Flo-SeFi </td>\n   <td style=\"text-align:left;\"> 2010-07-15 </td>\n   <td style=\"text-align:left;\"> 2010-08-14 </td>\n   <td style=\"text-align:left;\"> Soybean </td>\n   <td style=\"text-align:left;\"> Winchester </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 85.66 </td>\n   <td style=\"text-align:right;\"> 21.524167 </td>\n   <td style=\"text-align:right;\"> 566.9201 </td>\n   <td style=\"text-align:right;\"> 56.30866 </td>\n   <td style=\"text-align:right;\"> 141.75997 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 743.4511 </td>\n   <td style=\"text-align:right;\"> 0.5215225 </td>\n   <td style=\"text-align:right;\"> 346.630 </td>\n   <td style=\"text-align:right;\"> 0.7625520 </td>\n   <td style=\"text-align:right;\"> 1.635519 </td>\n   <td style=\"text-align:right;\"> 44.67362 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 3 </td>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:left;\"> SeFi-End </td>\n   <td style=\"text-align:left;\"> 2010-08-15 </td>\n   <td style=\"text-align:left;\"> 2010-10-10 </td>\n   <td style=\"text-align:left;\"> Soybean </td>\n   <td style=\"text-align:left;\"> Winchester </td>\n   <td style=\"text-align:right;\"> 56 </td>\n   <td style=\"text-align:right;\"> 297.13 </td>\n   <td style=\"text-align:right;\"> 16.158571 </td>\n   <td style=\"text-align:right;\"> 720.5205 </td>\n   <td style=\"text-align:right;\"> 77.41198 </td>\n   <td style=\"text-align:right;\"> 163.36417 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 962.2477 </td>\n   <td style=\"text-align:right;\"> 0.7257673 </td>\n   <td style=\"text-align:right;\"> 377.755 </td>\n   <td style=\"text-align:right;\"> 0.7487890 </td>\n   <td style=\"text-align:right;\"> 1.907375 </td>\n   <td style=\"text-align:right;\"> 215.64723 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n# Historical weather\n## Locations and Dates Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# For historical data (from Jan-01-2000 to Dec-31-2022)\ndf_historical <- data.frame(ID = c('1', '2', '3'),\n                      # Dates as YYYY_MM_DD, using \"_\" to separate\n                      Start = c('2000-01-01', '2000-01-01', '2000-01-01'),\n                      End = c('2022-12-31', '2022-12-31', '2022-12-31')) %>% \n  # Express start and end as dates using \"across\"\n  dplyr::mutate(across(Start:End, ~as.Date(., format = '%Y-%m-%d')))\n\n# Merge for historical weather data\ndf_historical <- df_sites %>% dplyr::left_join(df_historical, by = \"ID\")\n```\n:::\n\n\n\n## Retrieve from DAYMET\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Specify input = dataframe containing historical dates from sites \nhist_weather_daymet <- weather.daymet(input = df_historical)\n\n# This is a large data frame (21900 obs), so good to have an overview\n# Skim data\nskimr::skim(hist_weather_daymet)\n```\n\n::: {.cell-output-display}\n\nTable: Data summary\n\n|                         |                    |\n|:------------------------|:-------------------|\n|Name                     |hist_weather_daymet |\n|Number of rows           |25185               |\n|Number of columns        |23                  |\n|_______________________  |                    |\n|Column type frequency:   |                    |\n|character                |3                   |\n|Date                     |3                   |\n|numeric                  |17                  |\n|________________________ |                    |\n|Group variables          |None                |\n\n\n**Variable type: character**\n\n|skim_variable | n_missing| complete_rate| min| max| empty| n_unique| whitespace|\n|:-------------|---------:|-------------:|---:|---:|-----:|--------:|----------:|\n|ID            |         0|             1|   1|   1|     0|        3|          0|\n|Crop          |         0|             1|   4|   7|     0|        2|          0|\n|Site          |         0|             1|   5|  10|     0|        3|          0|\n\n\n**Variable type: Date**\n\n|skim_variable | n_missing| complete_rate|min        |max        |median     | n_unique|\n|:-------------|---------:|-------------:|:----------|:----------|:----------|--------:|\n|Start         |         0|             1|2000-01-01 |2000-01-01 |2000-01-01 |        1|\n|End           |         0|             1|2022-12-31 |2022-12-31 |2022-12-31 |        1|\n|Date          |         0|             1|2000-01-01 |2022-12-31 |2011-07-02 |     8395|\n\n\n**Variable type: numeric**\n\n|skim_variable | n_missing| complete_rate|    mean|     sd|      p0|     p25|     p50|     p75|    p100|hist  |\n|:-------------|---------:|-------------:|-------:|------:|-------:|-------:|-------:|-------:|-------:|:-----|\n|latitude      |         0|             1|   43.73|   1.08|   42.45|   42.45|   43.65|   45.08|   45.08|▇▁▇▁▇ |\n|longitude     |         0|             1|  -79.21|   2.80|  -81.88|  -81.88|  -80.40|  -75.35|  -75.35|▇▇▁▁▇ |\n|DOY           |         0|             1|  183.00| 105.37|    1.00|   92.00|  183.00|  274.00|  365.00|▇▇▇▇▇ |\n|Year          |         0|             1| 2011.00|   6.63| 2000.00| 2005.00| 2011.00| 2017.00| 2022.00|▇▆▇▆▇ |\n|Month         |         0|             1|    6.52|   3.45|    1.00|    4.00|    7.00|   10.00|   12.00|▇▅▅▅▇ |\n|Day           |         0|             1|   15.72|   8.79|    1.00|    8.00|   16.00|   23.00|   31.00|▇▇▇▇▆ |\n|DL            |         0|             1|   12.00|   2.26|    8.56|    9.80|   12.00|   14.20|   15.44|▇▅▅▅▇ |\n|PP            |         0|             1|    2.58|   5.27|    0.00|    0.00|    0.00|    2.92|   85.53|▇▁▁▁▁ |\n|Rad           |         0|             1|   13.40|   7.37|    0.74|    6.84|   12.59|   19.32|   32.59|▇▇▇▆▂ |\n|SWE           |         0|             1|   16.21|  32.83|    0.00|    0.00|    0.00|   12.65|  211.59|▇▁▁▁▁ |\n|Tmax          |         0|             1|   12.75|  11.54|  -22.58|    2.94|   13.55|   23.18|   36.23|▁▅▇▇▅ |\n|Tmin          |         0|             1|    3.03|  10.49|  -31.93|   -3.83|    3.42|   11.72|   25.02|▁▂▇▇▅ |\n|VP            |         0|             1|    0.93|   0.59|    0.04|    0.46|    0.77|    1.35|    3.17|▇▅▃▁▁ |\n|Tmean         |         0|             1|    7.89|  10.85|  -26.25|   -0.37|    8.46|   17.42|   29.88|▁▃▇▇▅ |\n|ET0_HS        |         0|             1|    2.42|   1.83|   -0.45|    0.72|    1.97|    4.00|    7.38|▇▅▅▅▁ |\n|EPE_i         |         0|             1|    0.01|   0.10|    0.00|    0.00|    0.00|    0.00|    1.00|▇▁▁▁▁ |\n|ETE_i         |         0|             1|    0.03|   0.17|    0.00|    0.00|    0.00|    0.00|    1.00|▇▁▁▁▁ |\n\n\n:::\n:::\n\n\n## Summary functions\n\n### By year\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Defining function to summarize historical weather (years)\n\n# Revised function:\nhistorical.years <- function(hist.data) {\n  # Creates an input tibble with the start and end date for each year a summary is desired\n  # Args:\n  #  hist.data = data frame containing the historical weather data to summarize (must be complete years)\n  # Returns:\n  #  a tibble of monthly summaries for each ID\n  #\n  # By year:\n  hist.data %>% \n    dplyr::group_by(ID, Crop, Site) %>%\n    tidyr::nest() %>%\n    dplyr::mutate(the_Dates = purrr::map(data, function(.data) {.data %>% dplyr::group_by(Year) %>% \n        dplyr::summarise(Start.in = min(Date), End.in = max(Date), .groups = \"drop\")})) %>%\n    dplyr::ungroup() %>%\n    dplyr::select(ID, Site, the_Dates) %>%\n    tidyr::unnest(cols = c(the_Dates))\n}\n```\n:::\n\n\n\n### By year-month\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Defining function to summarize historical weather (years & months)\n# Revised function:\nhistorical.yearmonths <- function(hist.data) {\n  # Creates an input tibble with the start and end date for each year & month a summary is desired (monthly summaries)\n  # Args:\n  #  hist.data = data frame containing the historical weather data to summarize (must be complete years)\n  # Returns:\n  #  a tibble of monthly summaries for each ID\n  #\n  # By month in year:\n  hist.data %>% \n    dplyr::group_by(ID, Crop, Site) %>%\n    tidyr::nest() %>%\n    dplyr::mutate(the_Dates = purrr::map(data, function(.data) {.data %>% \n        dplyr::group_by(Year, Month) %>% \n        dplyr::summarise(Start.in = min(Date), End.in = max(Date), .groups = \"drop\")})) %>%\n    dplyr::ungroup() %>%\n    dplyr::select(ID, Site, the_Dates) %>%\n    tidyr::unnest(cols = c(the_Dates))\n}\n```\n:::\n\n\n\n\n## Run Historical Summaries\n\nSummary can be obtained by years or by years.months. User must specify this option at the \"intervals\" argument of the summary function. <br/>\n\n### By year\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Specify hist.data = dataframe containing the historical weather data to summarize\nyear_intervals <- historical.years(hist.data = hist_weather_daymet)\n\n# input = dataframe containing the historical weather data.\n# intervals = type of historical intervals (years, years.months)\n\n# Summarizing historical weather\nyear_summary_daymet <-\n  summary.daymet(input = hist_weather_daymet,\n                           intervals = year_intervals)\n\n# Creating a table to visualize data\nkbl(head(year_summary_daymet)) %>%\n  kable_styling(font_size = 7, position = \"center\", latex_options = c(\"scale_down\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"font-size: 7px; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> ID </th>\n   <th style=\"text-align:right;\"> Year </th>\n   <th style=\"text-align:left;\"> Start.in </th>\n   <th style=\"text-align:left;\"> End.in </th>\n   <th style=\"text-align:left;\"> Crop </th>\n   <th style=\"text-align:left;\"> Site </th>\n   <th style=\"text-align:right;\"> Dur </th>\n   <th style=\"text-align:right;\"> PP </th>\n   <th style=\"text-align:right;\"> Tmean </th>\n   <th style=\"text-align:right;\"> Rad </th>\n   <th style=\"text-align:right;\"> VP </th>\n   <th style=\"text-align:right;\"> ET0_HS </th>\n   <th style=\"text-align:right;\"> ETE </th>\n   <th style=\"text-align:right;\"> EPE </th>\n   <th style=\"text-align:right;\"> CHU </th>\n   <th style=\"text-align:right;\"> SDI </th>\n   <th style=\"text-align:right;\"> GDD </th>\n   <th style=\"text-align:right;\"> Q_chu </th>\n   <th style=\"text-align:right;\"> Q_gdd </th>\n   <th style=\"text-align:right;\"> AWDR </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2000 </td>\n   <td style=\"text-align:left;\"> 2000-01-01 </td>\n   <td style=\"text-align:left;\"> 2000-12-30 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:right;\"> 364 </td>\n   <td style=\"text-align:right;\"> 1035.79 </td>\n   <td style=\"text-align:right;\"> 6.784354 </td>\n   <td style=\"text-align:right;\"> 4882.077 </td>\n   <td style=\"text-align:right;\"> 311.9404 </td>\n   <td style=\"text-align:right;\"> 834.4626 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 3363.850 </td>\n   <td style=\"text-align:right;\"> 0.7951588 </td>\n   <td style=\"text-align:right;\"> 480.635 </td>\n   <td style=\"text-align:right;\"> 1.451336 </td>\n   <td style=\"text-align:right;\"> 10.157556 </td>\n   <td style=\"text-align:right;\"> 823.6175 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2001 </td>\n   <td style=\"text-align:left;\"> 2001-01-01 </td>\n   <td style=\"text-align:left;\"> 2001-12-31 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:right;\"> 364 </td>\n   <td style=\"text-align:right;\"> 909.30 </td>\n   <td style=\"text-align:right;\"> 7.786786 </td>\n   <td style=\"text-align:right;\"> 4956.964 </td>\n   <td style=\"text-align:right;\"> 321.2663 </td>\n   <td style=\"text-align:right;\"> 874.0620 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 3266.985 </td>\n   <td style=\"text-align:right;\"> 0.7815342 </td>\n   <td style=\"text-align:right;\"> 644.145 </td>\n   <td style=\"text-align:right;\"> 1.517290 </td>\n   <td style=\"text-align:right;\"> 7.695417 </td>\n   <td style=\"text-align:right;\"> 710.6491 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2002 </td>\n   <td style=\"text-align:left;\"> 2002-01-01 </td>\n   <td style=\"text-align:left;\"> 2002-12-31 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:right;\"> 364 </td>\n   <td style=\"text-align:right;\"> 795.34 </td>\n   <td style=\"text-align:right;\"> 7.495824 </td>\n   <td style=\"text-align:right;\"> 4869.331 </td>\n   <td style=\"text-align:right;\"> 327.4677 </td>\n   <td style=\"text-align:right;\"> 869.5653 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 3140.274 </td>\n   <td style=\"text-align:right;\"> 0.7811108 </td>\n   <td style=\"text-align:right;\"> 630.985 </td>\n   <td style=\"text-align:right;\"> 1.550607 </td>\n   <td style=\"text-align:right;\"> 7.717032 </td>\n   <td style=\"text-align:right;\"> 621.2487 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2003 </td>\n   <td style=\"text-align:left;\"> 2003-01-01 </td>\n   <td style=\"text-align:left;\"> 2003-12-31 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:right;\"> 364 </td>\n   <td style=\"text-align:right;\"> 948.80 </td>\n   <td style=\"text-align:right;\"> 6.212733 </td>\n   <td style=\"text-align:right;\"> 4976.636 </td>\n   <td style=\"text-align:right;\"> 300.1867 </td>\n   <td style=\"text-align:right;\"> 841.3591 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 3158.797 </td>\n   <td style=\"text-align:right;\"> 0.7825177 </td>\n   <td style=\"text-align:right;\"> 388.790 </td>\n   <td style=\"text-align:right;\"> 1.575484 </td>\n   <td style=\"text-align:right;\"> 12.800318 </td>\n   <td style=\"text-align:right;\"> 742.4528 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2004 </td>\n   <td style=\"text-align:left;\"> 2004-01-01 </td>\n   <td style=\"text-align:left;\"> 2004-12-30 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:right;\"> 364 </td>\n   <td style=\"text-align:right;\"> 952.48 </td>\n   <td style=\"text-align:right;\"> 6.537857 </td>\n   <td style=\"text-align:right;\"> 4883.104 </td>\n   <td style=\"text-align:right;\"> 308.5060 </td>\n   <td style=\"text-align:right;\"> 827.3507 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 3248.058 </td>\n   <td style=\"text-align:right;\"> 0.8086498 </td>\n   <td style=\"text-align:right;\"> 401.735 </td>\n   <td style=\"text-align:right;\"> 1.503392 </td>\n   <td style=\"text-align:right;\"> 12.155037 </td>\n   <td style=\"text-align:right;\"> 770.2228 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2005 </td>\n   <td style=\"text-align:left;\"> 2005-01-01 </td>\n   <td style=\"text-align:left;\"> 2005-12-31 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:right;\"> 364 </td>\n   <td style=\"text-align:right;\"> 842.09 </td>\n   <td style=\"text-align:right;\"> 7.185206 </td>\n   <td style=\"text-align:right;\"> 5117.729 </td>\n   <td style=\"text-align:right;\"> 300.0098 </td>\n   <td style=\"text-align:right;\"> 921.0563 </td>\n   <td style=\"text-align:right;\"> 24 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 3242.154 </td>\n   <td style=\"text-align:right;\"> 0.7836771 </td>\n   <td style=\"text-align:right;\"> 681.280 </td>\n   <td style=\"text-align:right;\"> 1.578497 </td>\n   <td style=\"text-align:right;\"> 7.511932 </td>\n   <td style=\"text-align:right;\"> 659.9266 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n### By year-month\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Specify hist.data = dataframe containing the historical weather data to summarize\nyearmonth_intervals <- historical.yearmonths(hist.data = hist_weather_daymet)\n\n# input = dataframe containing the historical weather data.\n# intervals = type of historical intervals (years, years.months)\n\n# Summarizing historical weather\nyearmonth_summary_daymet <-\n  summary.daymet(input = hist_weather_daymet,\n                           intervals = yearmonth_intervals)\n\n# Creating a table to visualize data\nkbl(head(yearmonth_summary_daymet)) %>%\n  kable_styling(font_size = 7, position = \"center\", latex_options = c(\"scale_down\"))\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table\" style=\"font-size: 7px; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> ID </th>\n   <th style=\"text-align:right;\"> Year </th>\n   <th style=\"text-align:right;\"> Month </th>\n   <th style=\"text-align:left;\"> Start.in </th>\n   <th style=\"text-align:left;\"> End.in </th>\n   <th style=\"text-align:left;\"> Crop </th>\n   <th style=\"text-align:left;\"> Site </th>\n   <th style=\"text-align:right;\"> Dur </th>\n   <th style=\"text-align:right;\"> PP </th>\n   <th style=\"text-align:right;\"> Tmean </th>\n   <th style=\"text-align:right;\"> Rad </th>\n   <th style=\"text-align:right;\"> VP </th>\n   <th style=\"text-align:right;\"> ET0_HS </th>\n   <th style=\"text-align:right;\"> ETE </th>\n   <th style=\"text-align:right;\"> EPE </th>\n   <th style=\"text-align:right;\"> CHU </th>\n   <th style=\"text-align:right;\"> SDI </th>\n   <th style=\"text-align:right;\"> GDD </th>\n   <th style=\"text-align:right;\"> Q_chu </th>\n   <th style=\"text-align:right;\"> Q_gdd </th>\n   <th style=\"text-align:right;\"> AWDR </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2000 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:left;\"> 2000-01-01 </td>\n   <td style=\"text-align:left;\"> 2000-01-31 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 44.22 </td>\n   <td style=\"text-align:right;\"> -7.187333 </td>\n   <td style=\"text-align:right;\"> 191.5335 </td>\n   <td style=\"text-align:right;\"> 8.62155 </td>\n   <td style=\"text-align:right;\"> 12.22926 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.9515712 </td>\n   <td style=\"text-align:right;\"> 0.7172157 </td>\n   <td style=\"text-align:right;\"> -190.010 </td>\n   <td style=\"text-align:right;\"> 201.2813416 </td>\n   <td style=\"text-align:right;\"> -1.008018 </td>\n   <td style=\"text-align:right;\"> 31.71528 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2000 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:left;\"> 2000-02-01 </td>\n   <td style=\"text-align:left;\"> 2000-02-29 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:right;\"> 28 </td>\n   <td style=\"text-align:right;\"> 57.08 </td>\n   <td style=\"text-align:right;\"> -4.463036 </td>\n   <td style=\"text-align:right;\"> 269.1460 </td>\n   <td style=\"text-align:right;\"> 9.91130 </td>\n   <td style=\"text-align:right;\"> 19.01688 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 6.6954018 </td>\n   <td style=\"text-align:right;\"> 0.7480953 </td>\n   <td style=\"text-align:right;\"> -141.315 </td>\n   <td style=\"text-align:right;\"> 40.1986311 </td>\n   <td style=\"text-align:right;\"> -1.904582 </td>\n   <td style=\"text-align:right;\"> 42.70128 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2000 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:left;\"> 2000-03-01 </td>\n   <td style=\"text-align:left;\"> 2000-03-31 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 44.97 </td>\n   <td style=\"text-align:right;\"> 2.868500 </td>\n   <td style=\"text-align:right;\"> 441.0486 </td>\n   <td style=\"text-align:right;\"> 16.34147 </td>\n   <td style=\"text-align:right;\"> 47.73356 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 70.8484896 </td>\n   <td style=\"text-align:right;\"> 0.6801023 </td>\n   <td style=\"text-align:right;\"> -33.830 </td>\n   <td style=\"text-align:right;\"> 6.2252371 </td>\n   <td style=\"text-align:right;\"> -13.037205 </td>\n   <td style=\"text-align:right;\"> 30.58420 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2000 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:left;\"> 2000-04-01 </td>\n   <td style=\"text-align:left;\"> 2000-04-30 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:right;\"> 29 </td>\n   <td style=\"text-align:right;\"> 64.87 </td>\n   <td style=\"text-align:right;\"> 5.135345 </td>\n   <td style=\"text-align:right;\"> 552.8653 </td>\n   <td style=\"text-align:right;\"> 18.09003 </td>\n   <td style=\"text-align:right;\"> 65.36530 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 100.1956452 </td>\n   <td style=\"text-align:right;\"> 0.5036470 </td>\n   <td style=\"text-align:right;\"> -1.030 </td>\n   <td style=\"text-align:right;\"> 5.5178573 </td>\n   <td style=\"text-align:right;\"> -536.762404 </td>\n   <td style=\"text-align:right;\"> 32.67158 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2000 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:left;\"> 2000-05-01 </td>\n   <td style=\"text-align:left;\"> 2000-05-31 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:right;\"> 30 </td>\n   <td style=\"text-align:right;\"> 147.43 </td>\n   <td style=\"text-align:right;\"> 12.970667 </td>\n   <td style=\"text-align:right;\"> 584.3621 </td>\n   <td style=\"text-align:right;\"> 31.84376 </td>\n   <td style=\"text-align:right;\"> 114.94758 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 398.9491488 </td>\n   <td style=\"text-align:right;\"> 0.6533741 </td>\n   <td style=\"text-align:right;\"> 140.385 </td>\n   <td style=\"text-align:right;\"> 1.4647534 </td>\n   <td style=\"text-align:right;\"> 4.162568 </td>\n   <td style=\"text-align:right;\"> 96.32695 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2000 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:left;\"> 2000-06-01 </td>\n   <td style=\"text-align:left;\"> 2000-06-30 </td>\n   <td style=\"text-align:left;\"> Corn </td>\n   <td style=\"text-align:left;\"> Elora </td>\n   <td style=\"text-align:right;\"> 29 </td>\n   <td style=\"text-align:right;\"> 199.88 </td>\n   <td style=\"text-align:right;\"> 17.281207 </td>\n   <td style=\"text-align:right;\"> 560.0957 </td>\n   <td style=\"text-align:right;\"> 41.55868 </td>\n   <td style=\"text-align:right;\"> 133.48935 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 576.7064388 </td>\n   <td style=\"text-align:right;\"> 0.7668216 </td>\n   <td style=\"text-align:right;\"> 217.885 </td>\n   <td style=\"text-align:right;\"> 0.9711973 </td>\n   <td style=\"text-align:right;\"> 2.570603 </td>\n   <td style=\"text-align:right;\"> 153.27230 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n# Exporting Results\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# *.csv\nwrite.csv(my_summary_dataframe, \"my_summary_dataframe.csv\", row.names = FALSE)\n# *.xlsx\nwritexl::write_xlsx(x = my_summary_dataframe, path = \"my_summary_Daymet.csv\")\n```\n:::\n\n\n\n# References\n\n- [Hufkens K., Basler J. D., Milliman T. Melaas E., Richardson A.D. (2018)](https://doi.org/10.1111/2041-210X.12970) An integrated phenology modelling framework in R: Phenology modelling with phenor. Methods in Ecology & Evolution, 9: 1-10.\n\n- [Correndo, A.A., Moro Rosso, L.H. & Ciampitti, I.A. (2021)](https://doi.org/10.1186/s13104-021-05622-8) Retrieving and processing agro-meteorological data from API-client sources using R software. BMC Res Notes 14, 205.\n\n- [Correndo, A.A., Moro Rosso, L.H., Ciampitti, I.A. (2021)](https://doi.org/10.7910/DVN/J9EUZU) Agrometeorological data using R-software, Harvard Dataverse, V6.\n\n\n\n\n\n---\nThis tutorial demonstrates how to retrieve and process agrometeorological data using R, ensuring reproducibility for agricultural research.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}