<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr.&nbsp;Adrian Correndo">
<meta name="dcterms.date" content="2025-02-12">

<title>Retrieving and Processing Weather Data with R – PLNT6800 - Winter 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../coding/week_08/models_01.html" rel="next">
<link href="../../coding/week_06/10_iteration.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-f2a1071e85750ec973bbb8a8f120da0f.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-f2a1071e85750ec973bbb8a8f120da0f.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-e759c8361f0112bf6e2955a60a6c0828.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-5ccce6f18d703cb4568c738a25a74289.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Retrieving and Processing Weather Data with R – PLNT6800 - Winter 2025">
<meta property="og:description" content="Reproducible Ag Data Science with R">
<meta property="og:site_name" content="PLNT6800 - Winter 2025">
<meta name="twitter:title" content="Retrieving and Processing Weather Data with R – PLNT6800 - Winter 2025">
<meta name="twitter:description" content="Reproducible Ag Data Science with R">
<meta name="twitter:creator" content="@aacorrendo">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">PLNT6800 - Winter 2025</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://adriancorrendo.github.io/"> <i class="bi bi-globe" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/adriancorrendo/plnt6800/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/aacorrendo"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/adriancorrendo/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../coding/week_01/essentials_01.html">Lessons</a></li><li class="breadcrumb-item"><a href="../../coding/week_06/11_weather.html">11-Weather data</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../images/plnt6800_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://github.com/adriancorrendo/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Slides</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/day1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reproducibility</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Software</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../software/software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instructions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Lessons</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_01/essentials_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01-Essentials of R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_02/02_fundamentals_rpackages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02-Fundamentals of packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_02/03_versioncontrol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03-Git &amp; GitHub</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_03/04_datawrangling_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04-Data Wrangling I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_03/05_datawrangling_02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05-Data Wrangling II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_04/06_datawrangling_03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">06-Data Wrangling III</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_04/07_ggplot2_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">07-Data viz I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_05/08_ggplot2_adv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">08-Data viz II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_05/09_ggplot2_plus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">09-Data viz III</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_06/10_iteration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10-Iteration</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_06/11_weather.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">11-Weather data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_08/models_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12-Models I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_08/models_02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13-Models II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_09/models_03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14-Models III</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_09/models_04.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">15-Models IV</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_10/models_05.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">16-Models V</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_10/models_06.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">17-Models VI</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Calendar</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../outline/calendar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Course Outline</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../outline/outline.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Outline</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Content</h2>
   
  <ul>
  <li><a href="#locations-dates-data" id="toc-locations-dates-data" class="nav-link active" data-scroll-target="#locations-dates-data"><span class="header-section-number">1</span> Locations &amp; Dates Data</a></li>
  <li><a href="#retrieving-weather-data-from-daymet" id="toc-retrieving-weather-data-from-daymet" class="nav-link" data-scroll-target="#retrieving-weather-data-from-daymet"><span class="header-section-number">2</span> Retrieving Weather Data from DAYMET</a>
  <ul>
  <li><a href="#how-to-cite-the-daymetr-package" id="toc-how-to-cite-the-daymetr-package" class="nav-link" data-scroll-target="#how-to-cite-the-daymetr-package"><span class="header-section-number">2.1</span> How to cite the daymetr package</a></li>
  <li><a href="#evapotranspiration" id="toc-evapotranspiration" class="nav-link" data-scroll-target="#evapotranspiration"><span class="header-section-number">2.2</span> Evapotranspiration</a>
  <ul class="collapse">
  <li><a href="#constants" id="toc-constants" class="nav-link" data-scroll-target="#constants"><span class="header-section-number">2.2.1</span> Constants</a></li>
  </ul></li>
  <li><a href="#function-to-retrieve" id="toc-function-to-retrieve" class="nav-link" data-scroll-target="#function-to-retrieve"><span class="header-section-number">2.3</span> Function to retrieve</a></li>
  <li><a href="#run-retrieving-function" id="toc-run-retrieving-function" class="nav-link" data-scroll-target="#run-retrieving-function"><span class="header-section-number">2.4</span> Run retrieving function</a></li>
  </ul></li>
  <li><a href="#processing-weather-data" id="toc-processing-weather-data" class="nav-link" data-scroll-target="#processing-weather-data"><span class="header-section-number">3</span> Processing Weather Data</a>
  <ul>
  <li><a href="#define-time-intervals" id="toc-define-time-intervals" class="nav-link" data-scroll-target="#define-time-intervals"><span class="header-section-number">3.1</span> Define time intervals</a>
  <ul class="collapse">
  <li><a href="#full-season-interval" id="toc-full-season-interval" class="nav-link" data-scroll-target="#full-season-interval"><span class="header-section-number">3.1.1</span> Full-season interval</a></li>
  <li><a href="#even-intervals" id="toc-even-intervals" class="nav-link" data-scroll-target="#even-intervals"><span class="header-section-number">3.1.2</span> Even-intervals</a></li>
  <li><a href="#custom-intervals" id="toc-custom-intervals" class="nav-link" data-scroll-target="#custom-intervals"><span class="header-section-number">3.1.3</span> Custom-intervals</a></li>
  </ul></li>
  <li><a href="#summary-function" id="toc-summary-function" class="nav-link" data-scroll-target="#summary-function"><span class="header-section-number">3.2</span> Summary function</a></li>
  <li><a href="#run-summaries" id="toc-run-summaries" class="nav-link" data-scroll-target="#run-summaries"><span class="header-section-number">3.3</span> Run summaries</a>
  <ul class="collapse">
  <li><a href="#seasonal" id="toc-seasonal" class="nav-link" data-scroll-target="#seasonal"><span class="header-section-number">3.3.1</span> Seasonal</a></li>
  <li><a href="#even" id="toc-even" class="nav-link" data-scroll-target="#even"><span class="header-section-number">3.3.2</span> Even</a></li>
  <li><a href="#custom" id="toc-custom" class="nav-link" data-scroll-target="#custom"><span class="header-section-number">3.3.3</span> Custom</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#historical-weather" id="toc-historical-weather" class="nav-link" data-scroll-target="#historical-weather"><span class="header-section-number">4</span> Historical weather</a>
  <ul>
  <li><a href="#locations-and-dates-data" id="toc-locations-and-dates-data" class="nav-link" data-scroll-target="#locations-and-dates-data"><span class="header-section-number">4.1</span> Locations and Dates Data</a></li>
  <li><a href="#retrieve-from-daymet" id="toc-retrieve-from-daymet" class="nav-link" data-scroll-target="#retrieve-from-daymet"><span class="header-section-number">4.2</span> Retrieve from DAYMET</a></li>
  <li><a href="#summary-functions" id="toc-summary-functions" class="nav-link" data-scroll-target="#summary-functions"><span class="header-section-number">4.3</span> Summary functions</a>
  <ul class="collapse">
  <li><a href="#by-year" id="toc-by-year" class="nav-link" data-scroll-target="#by-year"><span class="header-section-number">4.3.1</span> By year</a></li>
  <li><a href="#by-year-month" id="toc-by-year-month" class="nav-link" data-scroll-target="#by-year-month"><span class="header-section-number">4.3.2</span> By year-month</a></li>
  </ul></li>
  <li><a href="#run-historical-summaries" id="toc-run-historical-summaries" class="nav-link" data-scroll-target="#run-historical-summaries"><span class="header-section-number">4.4</span> Run Historical Summaries</a>
  <ul class="collapse">
  <li><a href="#by-year-1" id="toc-by-year-1" class="nav-link" data-scroll-target="#by-year-1"><span class="header-section-number">4.4.1</span> By year</a></li>
  <li><a href="#by-year-month-1" id="toc-by-year-month-1" class="nav-link" data-scroll-target="#by-year-month-1"><span class="header-section-number">4.4.2</span> By year-month</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#exporting-results" id="toc-exporting-results" class="nav-link" data-scroll-target="#exporting-results"><span class="header-section-number">5</span> Exporting Results</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references"><span class="header-section-number">6</span> References</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../coding/week_01/essentials_01.html">Lessons</a></li><li class="breadcrumb-item"><a href="../../coding/week_06/11_weather.html">11-Weather data</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Retrieving and Processing Weather Data with R</h1>
  <div class="quarto-categories">
    <div class="quarto-category">weather data</div>
    <div class="quarto-category">API</div>
    <div class="quarto-category">data wrangling</div>
    <div class="quarto-category">daymetr</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dr.&nbsp;Adrian Correndo </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 12, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p><strong>Description</strong> <br></p>
<p>This lesson provides a step-by-step guide on retrieving and processing daily-weather data using R. It covers downloading data from DAYMET and processing it to generate weather summaries useful for agricultural research.</p>
<p>This tutorial focuses on how to:</p>
<ol type="1">
<li>Download daily weather data from DAYMET.</li>
<li>Process the retrieved data to calculate agronomic variables.</li>
<li>Summarize weather data for different time intervals.</li>
</ol>
<p><strong>Required packages</strong> <br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pacman)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(dplyr, tidyr, stringr) <span class="co"># Data wrangling</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(purrr) <span class="co"># Iteration</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(lubridate) <span class="co"># Date operations</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(kableExtra) <span class="co"># Table formatting to better display</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(daymetr) <span class="co"># Weather data from Daymet</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(skimr) <span class="co"># Summarizing weather data</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(vegan) <span class="co"># Shannon Diversity Index</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(writexl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="locations-dates-data" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Locations &amp; Dates Data</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Locations</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df_sites <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="fu">c</span>(<span class="st">'1'</span>, <span class="st">'2'</span>, <span class="st">'3'</span>),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Crop =</span> <span class="fu">c</span>(<span class="st">'Corn'</span>, <span class="st">'Corn'</span>, <span class="st">'Soybean'</span>),</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Site =</span> <span class="fu">c</span>(<span class="st">'Elora'</span>, <span class="st">'Ridgetown'</span>, <span class="st">'Winchester'</span>),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">latitude =</span> <span class="fu">c</span>(<span class="fl">43.6489</span>, <span class="fl">42.4464</span>, <span class="fl">45.0833</span>),</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">longitude =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">80.4037</span>, <span class="sc">-</span><span class="fl">81.8835</span>, <span class="sc">-</span><span class="fl">75.3500</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Dates</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>df_time <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">ID =</span> <span class="fu">c</span>(<span class="st">'1'</span>, <span class="st">'2'</span>, <span class="st">'3'</span>), <span class="co"># column in common to match and merge</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">Start =</span> <span class="fu">c</span>(<span class="st">'2002-04-25'</span>, <span class="st">'2005-05-01'</span>, <span class="st">'2010-05-20'</span>), <span class="co"># date to start collecting weather</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">End =</span> <span class="fu">c</span>(<span class="st">'2002-09-30'</span>, <span class="st">'2006-09-30'</span>, <span class="st">'2010-10-10'</span>), <span class="co"># date to stop collecting weather</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Add key crop phenology dates</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">Flo =</span> <span class="fu">c</span>(<span class="st">'2002-07-20'</span>, <span class="st">'2006-07-21'</span>, <span class="st">'2010-07-15'</span>), <span class="co"># Flowering dates for processing</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">SeFi =</span> <span class="fu">c</span>(<span class="st">'2002-08-08'</span>, <span class="st">'2006-08-10'</span>, <span class="st">'2010-08-15'</span>) <span class="co"># Seed filling dates for processing</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Express start and end as dates using "across"</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(Start<span class="sc">:</span>SeFi, <span class="sc">~</span><span class="fu">as.Date</span>(., <span class="at">format =</span> <span class="st">'%Y-%m-%d'</span>)))</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>df_input <span class="ot">&lt;-</span> <span class="fu">left_join</span>(df_sites, df_time, <span class="at">by =</span> <span class="st">"ID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="retrieving-weather-data-from-daymet" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> Retrieving Weather Data from DAYMET</h1>
<p><img src="https://raw.githubusercontent.com/bluegreen-labs/daymetr/master/logo.png" class="absolute" style="height:25.0%" data-top="0" data-right="0"> <code>daymetr</code> is a programmatic interface to the <a href="https://daymet.ornl.gov/">Daymet web services</a>. Allows for easy downloads of Daymet climate data directly to your R workspace or your computer. Spatial resolution: ~1 km2. Temporal resolution: daily. Historical data since year 1980.</p>
<p>Official Website: <a href="http://bluegreen-labs.github.io/daymetr/">http://bluegreen-labs.github.io/daymetr/</a></p>
<section id="how-to-cite-the-daymetr-package" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="how-to-cite-the-daymetr-package"><span class="header-section-number">2.1</span> How to cite the daymetr package</h2>
<blockquote class="blockquote">
<p>Hufkens K., Basler J. D., Milliman T. Melaas E., Richardson A.D. 2018 An integrated phenology modelling framework in R: Phenology modelling with phenor. Methods in Ecology &amp; Evolution, 9: 1-10. https://doi.org/10.1111/2041-210X.12970</p>
</blockquote>
</section>
<section id="evapotranspiration" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="evapotranspiration"><span class="header-section-number">2.2</span> Evapotranspiration</h2>
<p>Daymet does not provide data on reference evapotranspiration (<span class="math inline">\(\text{ET}_0\)</span>). However, it is possible to estimate <span class="math inline">\(\text{ET}_0\)</span> using the Hargreaves and Samani approach, which only requires temperature information (Hargreaves and Samani, 1985; Raziei and Pereira, 2013). Nonetheless, the <span class="math inline">\(\text{ET}_{0-HS}\)</span> equation is reported to give unreliable estimates for daily <span class="math inline">\(ET0\)</span> and therefore it should be used for 10-day periods at the shortest (Cobaner et al., 2017). <br></p>
<section id="constants" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="constants"><span class="header-section-number">2.2.1</span> Constants</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Constants for ET0 (Cobaner et al., 2017)</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Solar constant:</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>Gsc <span class="ot">&lt;-</span> <span class="fl">0.0820</span> <span class="co"># (MJ m-2 min-1)</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Radiation adjustment coefficient (Samani, 2004)</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>kRs <span class="ot">&lt;-</span> <span class="fl">0.17</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="function-to-retrieve" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="function-to-retrieve"><span class="header-section-number">2.3</span> Function to retrieve</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Name of functions using dots (.) instead of underscore (_)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="co"># We keep underscore for other objects</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>weather.daymet <span class="ot">&lt;-</span> <span class="cf">function</span>(input, <span class="at">dpp =</span> <span class="dv">0</span>){ </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Downloads the daily weather data from the DAYMET database and process it</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Args:</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  input = input file containing the locations and the start &amp; end dates for the time series</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  dpp = days prior to the Start</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Returns:</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  a tibble of DAYMET weather variables for the requested time period</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># STEP 1. Make use of metadata (locations and dates)</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>  input <span class="sc">%&gt;%</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">Weather =</span> purrr<span class="sc">::</span><span class="fu">pmap</span>(<span class="fu">list</span>(<span class="at">ID =</span> ID,</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>                                 <span class="co"># Rename vars to avoid conflicts</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">lat =</span> latitude,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">lon =</span> longitude,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">sta =</span> Start <span class="sc">-</span> dpp,</span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">end =</span> End),</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>                                        </span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>   <span class="co"># STEP 2. Retrieving daymet data:</span></span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>              <span class="cf">function</span>(ID, lat, lon, sta, end) {</span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>                daymetr<span class="sc">::</span><span class="fu">download_daymet</span>(<span class="at">site =</span> ID,</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">lat =</span> lat, </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>                                         <span class="at">lon =</span> lon,</span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>                                       <span class="co"># Extracting year from date:</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">start =</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(sta, <span class="dv">1</span>, <span class="dv">4</span>)),</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">end =</span> <span class="fu">as.numeric</span>(<span class="fu">substr</span>(end, <span class="dv">1</span>, <span class="dv">4</span>)),</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">internal =</span> <span class="cn">TRUE</span>, </span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>                                       <span class="at">simplify =</span> <span class="cn">TRUE</span>)})) <span class="sc">%&gt;%</span> </span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># STEP 3. Organizing dataframe (Re-arranging rows and columns)</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Weather =</span> Weather <span class="sc">%&gt;%</span> </span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>                <span class="co"># i. Adjusting dates format with lubridate and map()</span></span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>                purrr<span class="sc">::</span><span class="fu">map</span>(<span class="sc">~</span> </span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>                  dplyr<span class="sc">::</span><span class="fu">mutate</span>(., </span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">as.numeric</span>(yday) <span class="sc">-</span> <span class="dv">1</span>, <span class="co"># Day of the year</span></span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>                   <span class="at">origin =</span> <span class="fu">paste0</span>(year, <span class="st">'-01-01'</span>)),</span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Year =</span> <span class="fu">year</span>(Date),</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Month =</span> <span class="fu">month</span>(Date),</span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>                   <span class="at">Day =</span> <span class="fu">mday</span>(Date))) <span class="sc">%&gt;%</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>                <span class="co"># ii. Select columns of interest</span></span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>                purrr<span class="sc">::</span><span class="fu">map</span>(<span class="sc">~</span> </span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>                  dplyr<span class="sc">::</span><span class="fu">select</span>(., yday, Year, Month, Day,</span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>                                Date, measurement, value)) <span class="sc">%&gt;%</span></span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>                <span class="co"># iii. Re-arrange columns wider</span></span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>                purrr<span class="sc">::</span><span class="fu">map</span>(<span class="sc">~</span> </span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>                  tidyr<span class="sc">::</span><span class="fu">pivot_wider</span>(.,</span>
<span id="cb4-48"><a href="#cb4-48" aria-hidden="true" tabindex="-1"></a>                      <span class="at">names_from =</span> measurement, <span class="at">values_from =</span> value)) <span class="sc">%&gt;%</span></span>
<span id="cb4-49"><a href="#cb4-49" aria-hidden="true" tabindex="-1"></a>                <span class="co"># iv. Renaming variables with rename_with()</span></span>
<span id="cb4-50"><a href="#cb4-50" aria-hidden="true" tabindex="-1"></a>                    purrr<span class="sc">::</span><span class="fu">map</span>(<span class="sc">~</span> <span class="fu">rename_with</span>(., <span class="sc">~</span><span class="fu">c</span>(</span>
<span id="cb4-51"><a href="#cb4-51" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"DOY"</span>,   <span class="co"># Date as Day of the year</span></span>
<span id="cb4-52"><a href="#cb4-52" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Year"</span>,  <span class="co"># Year</span></span>
<span id="cb4-53"><a href="#cb4-53" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Month"</span>, <span class="co"># Month </span></span>
<span id="cb4-54"><a href="#cb4-54" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Day"</span>,   <span class="co"># Day of the month</span></span>
<span id="cb4-55"><a href="#cb4-55" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Date"</span>,  <span class="co"># Date as normal format</span></span>
<span id="cb4-56"><a href="#cb4-56" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"DL"</span>,    <span class="co"># Day length (sec)</span></span>
<span id="cb4-57"><a href="#cb4-57" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"PP"</span>,    <span class="co"># Precipitation (mm)</span></span>
<span id="cb4-58"><a href="#cb4-58" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Rad"</span>,   <span class="co"># Radiation (W/m2)</span></span>
<span id="cb4-59"><a href="#cb4-59" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"SWE"</span>,   <span class="co"># Snow water (kg/m2)</span></span>
<span id="cb4-60"><a href="#cb4-60" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Tmax"</span>,  <span class="co"># Max. temp. (degC)</span></span>
<span id="cb4-61"><a href="#cb4-61" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"Tmin"</span>,  <span class="co"># Min. temp. (degC)</span></span>
<span id="cb4-62"><a href="#cb4-62" aria-hidden="true" tabindex="-1"></a>                      <span class="st">"VPD"</span>)))) <span class="sc">%&gt;%</span>   <span class="co"># Vap Pres Def (Pa)</span></span>
<span id="cb4-63"><a href="#cb4-63" aria-hidden="true" tabindex="-1"></a>    <span class="co"># STEP 4. Processing data given start and ending dates:</span></span>
<span id="cb4-64"><a href="#cb4-64" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Weather =</span> purrr<span class="sc">::</span><span class="fu">pmap</span>(<span class="fu">list</span>(<span class="at">sta =</span> Start <span class="sc">-</span> dpp, </span>
<span id="cb4-65"><a href="#cb4-65" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">end =</span> End, </span>
<span id="cb4-66"><a href="#cb4-66" aria-hidden="true" tabindex="-1"></a>                                             <span class="at">data =</span> Weather), <span class="co"># Requested period</span></span>
<span id="cb4-67"><a href="#cb4-67" aria-hidden="true" tabindex="-1"></a>                                        <span class="cf">function</span>(sta, end, data) {</span>
<span id="cb4-68"><a href="#cb4-68" aria-hidden="true" tabindex="-1"></a>                                          dplyr<span class="sc">::</span><span class="fu">filter</span>(data, Date <span class="sc">&gt;=</span> sta <span class="sc">&amp;</span> Date <span class="sc">&lt;=</span> end) </span>
<span id="cb4-69"><a href="#cb4-69" aria-hidden="true" tabindex="-1"></a>                                          })) <span class="sc">%&gt;%</span></span>
<span id="cb4-70"><a href="#cb4-70" aria-hidden="true" tabindex="-1"></a>    <span class="co"># STEP 5. Unnest</span></span>
<span id="cb4-71"><a href="#cb4-71" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(Weather)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-72"><a href="#cb4-72" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-73"><a href="#cb4-73" aria-hidden="true" tabindex="-1"></a>    <span class="co"># STEP 6. Converting units and adding extra variables:</span></span>
<span id="cb4-74"><a href="#cb4-74" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Rad =</span> Rad<span class="sc">*</span><span class="fl">0.000001</span><span class="sc">*</span>DL, <span class="co"># Radiation (W/m2 to MJ/m2)</span></span>
<span id="cb4-75"><a href="#cb4-75" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Tmean =</span> (Tmax<span class="sc">+</span>Tmin)<span class="sc">/</span><span class="dv">2</span>, <span class="co"># Mean temperature (degC),</span></span>
<span id="cb4-76"><a href="#cb4-76" aria-hidden="true" tabindex="-1"></a>                  <span class="at">VPD =</span> VPD <span class="sc">/</span> <span class="dv">1000</span>, <span class="co"># VPD (Pa to kPa),</span></span>
<span id="cb4-77"><a href="#cb4-77" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># Creating variables for ET0 estimation:</span></span>
<span id="cb4-78"><a href="#cb4-78" aria-hidden="true" tabindex="-1"></a>                  <span class="at">lat_rad =</span> latitude<span class="sc">*</span><span class="fl">0.0174533</span>,</span>
<span id="cb4-79"><a href="#cb4-79" aria-hidden="true" tabindex="-1"></a>                  <span class="at">dr =</span> <span class="dv">1</span> <span class="sc">+</span> <span class="fl">0.033</span><span class="sc">*</span><span class="fu">cos</span>((<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">365</span>)<span class="sc">*</span>DOY),</span>
<span id="cb4-80"><a href="#cb4-80" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Sd =</span> <span class="fl">0.409</span><span class="sc">*</span><span class="fu">sin</span>((<span class="dv">2</span><span class="sc">*</span>pi<span class="sc">/</span><span class="dv">365</span>)<span class="sc">*</span>DOY <span class="sc">-</span> <span class="fl">1.39</span>),</span>
<span id="cb4-81"><a href="#cb4-81" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ws =</span> <span class="fu">acos</span>(<span class="sc">-</span><span class="fu">tan</span>(lat_rad)<span class="sc">*</span><span class="fu">tan</span>(Sd)),</span>
<span id="cb4-82"><a href="#cb4-82" aria-hidden="true" tabindex="-1"></a>                  <span class="at">Ra =</span> (<span class="dv">24</span><span class="sc">*</span><span class="dv">60</span>)<span class="sc">/</span>(pi) <span class="sc">*</span> Gsc <span class="sc">*</span> dr <span class="sc">*</span> (ws<span class="sc">*</span><span class="fu">sin</span>(lat_rad)<span class="sc">*</span><span class="fu">sin</span>(Sd) <span class="sc">+</span> <span class="fu">cos</span>(lat_rad)<span class="sc">*</span><span class="fu">sin</span>(ws)),</span>
<span id="cb4-83"><a href="#cb4-83" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ET0_HS =</span> <span class="fl">0.0135</span> <span class="sc">*</span> kRs <span class="sc">*</span> (Ra <span class="sc">/</span> <span class="fl">2.45</span>) <span class="sc">*</span> (<span class="fu">sqrt</span>(Tmax<span class="sc">-</span>Tmin)) <span class="sc">*</span> (Tmean <span class="sc">+</span> <span class="fl">17.8</span>),</span>
<span id="cb4-84"><a href="#cb4-84" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># Extreme PP events</span></span>
<span id="cb4-85"><a href="#cb4-85" aria-hidden="true" tabindex="-1"></a>                  <span class="at">EPE_i =</span> <span class="fu">case_when</span>((PP <span class="sc">&gt;</span> <span class="dv">25</span>) <span class="sc">~</span> <span class="dv">1</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>),</span>
<span id="cb4-86"><a href="#cb4-86" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># Extreme Temp events</span></span>
<span id="cb4-87"><a href="#cb4-87" aria-hidden="true" tabindex="-1"></a>                  <span class="at">ETE_i =</span> <span class="fu">case_when</span>((Tmax <span class="sc">&gt;=</span> <span class="dv">30</span>) <span class="sc">~</span> <span class="dv">1</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>),</span>
<span id="cb4-88"><a href="#cb4-88" aria-hidden="true" tabindex="-1"></a>                  <span class="co"># Day length (hours)</span></span>
<span id="cb4-89"><a href="#cb4-89" aria-hidden="true" tabindex="-1"></a>                  <span class="at">DL =</span> (DL<span class="sc">/</span><span class="dv">60</span>)<span class="sc">/</span><span class="dv">60</span> </span>
<span id="cb4-90"><a href="#cb4-90" aria-hidden="true" tabindex="-1"></a>                  ) <span class="sc">%&gt;%</span> </span>
<span id="cb4-91"><a href="#cb4-91" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>lat_rad, <span class="sc">-</span>dr, <span class="sc">-</span>Sd, <span class="sc">-</span>ws, <span class="sc">-</span>Ra)</span>
<span id="cb4-92"><a href="#cb4-92" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-93"><a href="#cb4-93" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="run-retrieving-function" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="run-retrieving-function"><span class="header-section-number">2.4</span> Run retrieving function</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify input = dataframe containing sites-data </span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify Days prior planting. Default is dpp = 0. Here we use dpp = 30.</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>df_weather_daymet <span class="ot">&lt;-</span> <span class="fu">weather.daymet</span>(<span class="at">input =</span> df_input, <span class="at">dpp =</span> <span class="dv">30</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Overview of the variables (useful checking for missing values):</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(df_weather_daymet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">df_weather_daymet</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">911</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Date</td>
<td style="text-align: left;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">17</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ID</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Crop</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Site</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: Date</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: left;">min</th>
<th style="text-align: left;">max</th>
<th style="text-align: left;">median</th>
<th style="text-align: right;">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Start</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2002-04-25</td>
<td style="text-align: left;">2010-05-20</td>
<td style="text-align: left;">2005-05-01</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">End</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2002-09-30</td>
<td style="text-align: left;">2010-10-10</td>
<td style="text-align: left;">2006-09-30</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Flo</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2002-07-20</td>
<td style="text-align: left;">2010-07-15</td>
<td style="text-align: left;">2006-07-21</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">SeFi</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2002-08-08</td>
<td style="text-align: left;">2010-08-15</td>
<td style="text-align: left;">2006-08-10</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Date</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2002-03-26</td>
<td style="text-align: left;">2010-10-10</td>
<td style="text-align: left;">2005-12-23</td>
<td style="text-align: right;">911</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 14%">
<col style="width: 10%">
<col style="width: 14%">
<col style="width: 8%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">latitude</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">43.20</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">42.45</td>
<td style="text-align: right;">42.45</td>
<td style="text-align: right;">42.45</td>
<td style="text-align: right;">43.65</td>
<td style="text-align: right;">45.08</td>
<td style="text-align: left;">▇▁▃▁▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">longitude</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-80.33</td>
<td style="text-align: right;">2.49</td>
<td style="text-align: right;">-81.88</td>
<td style="text-align: right;">-81.88</td>
<td style="text-align: right;">-81.88</td>
<td style="text-align: right;">-80.40</td>
<td style="text-align: right;">-75.35</td>
<td style="text-align: left;">▇▃▁▁▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DOY</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">184.55</td>
<td style="text-align: right;">78.43</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">128.00</td>
<td style="text-align: right;">185.00</td>
<td style="text-align: right;">242.00</td>
<td style="text-align: right;">365.00</td>
<td style="text-align: left;">▂▆▇▇▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">Year</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2005.63</td>
<td style="text-align: right;">2.56</td>
<td style="text-align: right;">2002.00</td>
<td style="text-align: right;">2005.00</td>
<td style="text-align: right;">2005.00</td>
<td style="text-align: right;">2006.00</td>
<td style="text-align: right;">2010.00</td>
<td style="text-align: left;">▆▇▇▁▅</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Month</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6.58</td>
<td style="text-align: right;">2.57</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: right;">7.00</td>
<td style="text-align: right;">8.00</td>
<td style="text-align: right;">12.00</td>
<td style="text-align: left;">▃▇▇▇▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">Day</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">15.83</td>
<td style="text-align: right;">8.88</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">8.00</td>
<td style="text-align: right;">16.00</td>
<td style="text-align: right;">24.00</td>
<td style="text-align: right;">31.00</td>
<td style="text-align: left;">▇▇▆▇▆</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DL</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">13.17</td>
<td style="text-align: right;">1.88</td>
<td style="text-align: right;">8.89</td>
<td style="text-align: right;">12.06</td>
<td style="text-align: right;">13.68</td>
<td style="text-align: right;">14.78</td>
<td style="text-align: right;">15.44</td>
<td style="text-align: left;">▂▂▃▅▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">PP</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.53</td>
<td style="text-align: right;">5.31</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">2.74</td>
<td style="text-align: right;">45.09</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rad</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16.23</td>
<td style="text-align: right;">6.78</td>
<td style="text-align: right;">1.40</td>
<td style="text-align: right;">11.31</td>
<td style="text-align: right;">16.61</td>
<td style="text-align: right;">21.63</td>
<td style="text-align: right;">29.86</td>
<td style="text-align: left;">▃▆▇▇▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">SWE</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">4.86</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">41.65</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tmax</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">18.74</td>
<td style="text-align: right;">9.40</td>
<td style="text-align: right;">-7.32</td>
<td style="text-align: right;">12.90</td>
<td style="text-align: right;">21.21</td>
<td style="text-align: right;">26.16</td>
<td style="text-align: right;">34.99</td>
<td style="text-align: left;">▁▃▅▇▅</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tmin</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">8.95</td>
<td style="text-align: right;">8.13</td>
<td style="text-align: right;">-15.01</td>
<td style="text-align: right;">2.83</td>
<td style="text-align: right;">10.31</td>
<td style="text-align: right;">15.21</td>
<td style="text-align: right;">24.83</td>
<td style="text-align: left;">▁▃▅▇▃</td>
</tr>
<tr class="odd">
<td style="text-align: left;">VPD</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.26</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.19</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">1.21</td>
<td style="text-align: right;">1.70</td>
<td style="text-align: right;">3.14</td>
<td style="text-align: left;">▇▇▇▃▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tmean</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">13.84</td>
<td style="text-align: right;">8.60</td>
<td style="text-align: right;">-11.16</td>
<td style="text-align: right;">7.73</td>
<td style="text-align: right;">16.12</td>
<td style="text-align: right;">20.52</td>
<td style="text-align: right;">28.40</td>
<td style="text-align: left;">▁▃▅▇▆</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ET0_HS</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.33</td>
<td style="text-align: right;">1.66</td>
<td style="text-align: right;">0.26</td>
<td style="text-align: right;">2.03</td>
<td style="text-align: right;">3.48</td>
<td style="text-align: right;">4.69</td>
<td style="text-align: right;">7.13</td>
<td style="text-align: left;">▆▆▇▇▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">EPE_i</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ETE_i</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.06</td>
<td style="text-align: right;">0.23</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Exporting data as a .csv file</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(df.weather.daymet, row.names = FALSE, na = '', file = paste0(path, 'Output_daymet.csv'))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="processing-weather-data" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Processing Weather Data</h1>
<section id="define-time-intervals" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="define-time-intervals"><span class="header-section-number">3.1</span> Define time intervals</h2>
<p>In this section we create time intervals during the cropping season using pre-specified dates as columns at the initial data table with site information. <br></p>
<p>The user can apply: i) a unique seasonal interval (season), ii) even intervals (even), or iii) customized intervals (custom). <br></p>
<section id="full-season-interval" class="level3" data-number="3.1.1">
<h3 data-number="3.1.1" class="anchored" data-anchor-id="full-season-interval"><span class="header-section-number">3.1.1</span> Full-season interval</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining season-intervals</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>season_interval <span class="ot">&lt;-</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  df_input <span class="sc">%&gt;%</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Interval =</span> <span class="st">"Season"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">Start.in =</span> Start, <span class="at">End.in =</span> End) <span class="sc">%&gt;%</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ID, Site, Interval, Start.in, End.in)</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a table to visualize results</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(season_interval) <span class="sc">%&gt;%</span> </span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>),</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="st">"center"</span>, <span class="at">font_size =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">ID</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Site</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Interval</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Start.in</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">End.in</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: left;">Season</td>
<td style="text-align: left;">2002-04-25</td>
<td style="text-align: left;">2002-09-30</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Ridgetown</td>
<td style="text-align: left;">Season</td>
<td style="text-align: left;">2005-05-01</td>
<td style="text-align: left;">2006-09-30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Winchester</td>
<td style="text-align: left;">Season</td>
<td style="text-align: left;">2010-05-20</td>
<td style="text-align: left;">2010-10-10</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="even-intervals" class="level3" data-number="3.1.2">
<h3 data-number="3.1.2" class="anchored" data-anchor-id="even-intervals"><span class="header-section-number">3.1.2</span> Even-intervals</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of intervals:</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">4</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Days prior planting:</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>dpp <span class="ot">&lt;-</span> <span class="dv">30</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining even-intervals:</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>even_intervals <span class="ot">&lt;-</span> </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  df_input <span class="sc">%&gt;%</span> </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create new data:</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Intervals =</span> </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>          purrr<span class="sc">::</span><span class="fu">map2</span>(<span class="at">.x =</span> Start, <span class="at">.y =</span> End,</span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>                      <span class="at">.f =</span> <span class="sc">~</span> <span class="fu">data.frame</span>(</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>                    <span class="at">Interval =</span> <span class="fu">c</span>(<span class="st">"Prev"</span>, <span class="co"># Prior to start date </span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>                                 LETTERS[<span class="dv">0</span><span class="sc">:</span>n]), <span class="co"># Each interval from start date</span></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>                      <span class="co"># Start</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Start.in =</span> <span class="fu">c</span>(.x <span class="sc">-</span> dpp, <span class="fu">seq.Date</span>(.x, .y <span class="sc">+</span> <span class="dv">1</span>, <span class="at">length.out =</span> n <span class="sc">+</span> <span class="dv">1</span>)[<span class="dv">1</span><span class="sc">:</span>n]),                              <span class="co"># End</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>                      <span class="at">End.in =</span> <span class="fu">c</span>(.x <span class="sc">-</span> <span class="dv">1</span>, <span class="fu">seq.Date</span>(.x, .y <span class="sc">+</span> <span class="dv">1</span>, <span class="at">length.out =</span> n <span class="sc">+</span> <span class="dv">1</span>)[<span class="dv">2</span><span class="sc">:</span>(n <span class="sc">+</span> <span class="dv">1</span>)]))) ) <span class="sc">%&gt;%</span> </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Selecting columns:</span></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ID, Site, Intervals) <span class="sc">%&gt;%</span> </span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(Intervals))</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a table to visualize results</span></span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(even_intervals) <span class="sc">%&gt;%</span> </span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>), </span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>                <span class="at">position =</span> <span class="st">"center"</span>, <span class="at">font_size =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">ID</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Site</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Interval</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Start.in</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">End.in</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: left;">Prev</td>
<td style="text-align: left;">2002-03-26</td>
<td style="text-align: left;">2002-04-24</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: left;">A</td>
<td style="text-align: left;">2002-04-25</td>
<td style="text-align: left;">2002-06-03</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: left;">B</td>
<td style="text-align: left;">2002-06-03</td>
<td style="text-align: left;">2002-07-13</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: left;">C</td>
<td style="text-align: left;">2002-07-13</td>
<td style="text-align: left;">2002-08-22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: left;">D</td>
<td style="text-align: left;">2002-08-22</td>
<td style="text-align: left;">2002-10-01</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Ridgetown</td>
<td style="text-align: left;">Prev</td>
<td style="text-align: left;">2005-04-01</td>
<td style="text-align: left;">2005-04-30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Ridgetown</td>
<td style="text-align: left;">A</td>
<td style="text-align: left;">2005-05-01</td>
<td style="text-align: left;">2005-09-07</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Ridgetown</td>
<td style="text-align: left;">B</td>
<td style="text-align: left;">2005-09-07</td>
<td style="text-align: left;">2006-01-15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Ridgetown</td>
<td style="text-align: left;">C</td>
<td style="text-align: left;">2006-01-15</td>
<td style="text-align: left;">2006-05-24</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Ridgetown</td>
<td style="text-align: left;">D</td>
<td style="text-align: left;">2006-05-24</td>
<td style="text-align: left;">2006-10-01</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Winchester</td>
<td style="text-align: left;">Prev</td>
<td style="text-align: left;">2010-04-20</td>
<td style="text-align: left;">2010-05-19</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Winchester</td>
<td style="text-align: left;">A</td>
<td style="text-align: left;">2010-05-20</td>
<td style="text-align: left;">2010-06-25</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Winchester</td>
<td style="text-align: left;">B</td>
<td style="text-align: left;">2010-06-25</td>
<td style="text-align: left;">2010-07-31</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Winchester</td>
<td style="text-align: left;">C</td>
<td style="text-align: left;">2010-07-31</td>
<td style="text-align: left;">2010-09-05</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Winchester</td>
<td style="text-align: left;">D</td>
<td style="text-align: left;">2010-09-05</td>
<td style="text-align: left;">2010-10-11</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="custom-intervals" class="level3" data-number="3.1.3">
<h3 data-number="3.1.3" class="anchored" data-anchor-id="custom-intervals"><span class="header-section-number">3.1.3</span> Custom-intervals</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Count the number of interval columns (assuming intervals start at column "Start")</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> df_input <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">select</span>(Start<span class="sc">:</span><span class="fu">last_col</span>()) <span class="sc">%&gt;%</span> <span class="fu">ncol</span>()</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining custom-intervals</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>custom_intervals <span class="ot">&lt;-</span> </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  df_input <span class="sc">%&gt;%</span> </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Intervals =</span> <span class="co"># Create</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>                  purrr<span class="sc">::</span><span class="fu">pmap</span>(<span class="co"># List of object to iterate over</span></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>                              <span class="at">.l =</span> <span class="fu">list</span>(<span class="at">x =</span> Start <span class="sc">-</span> dpp,</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">y =</span> Start,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">z =</span> Flo,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">m =</span> SeFi,</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">k =</span> End),</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>                              <span class="co"># The function to run</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>                              <span class="at">.f =</span> <span class="cf">function</span>(x, y, z, m, k) {</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>                      <span class="fu">data.frame</span>(<span class="co"># New data</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Interval =</span> <span class="fu">c</span>(LETTERS[<span class="dv">1</span><span class="sc">:</span>i]),</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Name =</span> <span class="fu">c</span>(<span class="st">"Prev"</span>, <span class="st">"Plant-Flo"</span>, <span class="st">"Flo-SeFi"</span>, <span class="st">"SeFi-End"</span>),</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>                        <span class="at">Start.in =</span> <span class="fu">c</span>(x, y, z, m),</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>                        <span class="at">End.in =</span> <span class="fu">c</span>(y<span class="dv">-1</span>, z<span class="dv">-1</span>, m<span class="dv">-1</span>, k))}</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>                    )) <span class="sc">%&gt;%</span> </span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Selecting columns:</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(ID,, Site, Intervals) <span class="sc">%&gt;%</span> </span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  tidyr<span class="sc">::</span><span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(Intervals))</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a table to visualize results:</span></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(custom_intervals) <span class="sc">%&gt;%</span> </span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>), <span class="at">position =</span> <span class="st">"center"</span>, <span class="at">font_size =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">ID</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Site</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Interval</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Name</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Start.in</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">End.in</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: left;">A</td>
<td style="text-align: left;">Prev</td>
<td style="text-align: left;">2002-03-26</td>
<td style="text-align: left;">2002-04-24</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: left;">B</td>
<td style="text-align: left;">Plant-Flo</td>
<td style="text-align: left;">2002-04-25</td>
<td style="text-align: left;">2002-07-19</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: left;">C</td>
<td style="text-align: left;">Flo-SeFi</td>
<td style="text-align: left;">2002-07-20</td>
<td style="text-align: left;">2002-08-07</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: left;">D</td>
<td style="text-align: left;">SeFi-End</td>
<td style="text-align: left;">2002-08-08</td>
<td style="text-align: left;">2002-09-30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Ridgetown</td>
<td style="text-align: left;">A</td>
<td style="text-align: left;">Prev</td>
<td style="text-align: left;">2005-04-01</td>
<td style="text-align: left;">2005-04-30</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Ridgetown</td>
<td style="text-align: left;">B</td>
<td style="text-align: left;">Plant-Flo</td>
<td style="text-align: left;">2005-05-01</td>
<td style="text-align: left;">2006-07-20</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Ridgetown</td>
<td style="text-align: left;">C</td>
<td style="text-align: left;">Flo-SeFi</td>
<td style="text-align: left;">2006-07-21</td>
<td style="text-align: left;">2006-08-09</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Ridgetown</td>
<td style="text-align: left;">D</td>
<td style="text-align: left;">SeFi-End</td>
<td style="text-align: left;">2006-08-10</td>
<td style="text-align: left;">2006-09-30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Winchester</td>
<td style="text-align: left;">A</td>
<td style="text-align: left;">Prev</td>
<td style="text-align: left;">2010-04-20</td>
<td style="text-align: left;">2010-05-19</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Winchester</td>
<td style="text-align: left;">B</td>
<td style="text-align: left;">Plant-Flo</td>
<td style="text-align: left;">2010-05-20</td>
<td style="text-align: left;">2010-07-14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Winchester</td>
<td style="text-align: left;">C</td>
<td style="text-align: left;">Flo-SeFi</td>
<td style="text-align: left;">2010-07-15</td>
<td style="text-align: left;">2010-08-14</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Winchester</td>
<td style="text-align: left;">D</td>
<td style="text-align: left;">SeFi-End</td>
<td style="text-align: left;">2010-08-15</td>
<td style="text-align: left;">2010-10-10</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="summary-function" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="summary-function"><span class="header-section-number">3.2</span> Summary function</h2>
<p>For each of the period or interval of interest a variety of variables can be created. Here, we present a set of variables that can capture environmental variations that might be missing by analyzing standard weather data (precipitations, temperature, radiation). These variables represent an example that was used for studying influence of weather in corn yields by Correndo et al.&nbsp;(2021). <br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining the function to summarize DAYMET and/or NASA-POWER</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>summary.daymet <span class="ot">&lt;-</span> <span class="cf">function</span>(input, intervals) {</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Creates summaries of the DAYMET daily data over the requested period</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Args:</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  input = a weather data object such as df.weather.daymet with the daily weather data</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  intervals = a tibble with the start and end date for the summary period</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># STEP 1. </span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  intervals <span class="sc">%&gt;%</span></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># </span><span class="al">NOTE</span><span class="co">: mergeing on ID only as the key, so remove Site:</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Site) <span class="sc">%&gt;%</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Merging weather data:</span></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">left_join</span>(input <span class="sc">%&gt;%</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>                     <span class="co"># Nesting weather data back for each site-ID:</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>                     dplyr<span class="sc">::</span><span class="fu">select_if</span>(<span class="fu">names</span>(.) <span class="sc">%in%</span> </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>                                        <span class="fu">c</span>(<span class="st">"ID"</span>, <span class="st">"Crop"</span>, <span class="st">"Site"</span>,</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"Date"</span>,<span class="st">"DL"</span>, <span class="st">"PP"</span>, </span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"Rad"</span>, <span class="st">"Tmax"</span>, <span class="st">"Tmin"</span>,</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>                                          <span class="st">"Tmean"</span>, <span class="st">"VPD"</span>, <span class="st">"ET0_HS"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>                     dplyr<span class="sc">::</span><span class="fu">group_by</span>(ID, Crop, Site) <span class="sc">%&gt;%</span> </span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>                     tidyr<span class="sc">::</span><span class="fu">nest</span>(<span class="at">Weather =</span> <span class="sc">-</span><span class="fu">c</span>(ID, Crop, Site)) <span class="sc">%&gt;%</span></span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>                     dplyr<span class="sc">::</span><span class="fu">ungroup</span>(), </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"ID"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># STEP 2. Create Weather column filtering for desired period only.</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Weather =</span> purrr<span class="sc">::</span><span class="fu">pmap</span>(</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">.l =</span> <span class="fu">list</span>(<span class="at">x =</span> Start.in,</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>                <span class="at">y =</span> End.in, </span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>                <span class="at">data =</span> Weather),</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Filter function</span></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>      <span class="at">.f =</span> <span class="cf">function</span>(x, y, data) {</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">filter</span>(data, Date <span class="sc">&gt;=</span> x <span class="sc">&amp;</span> Date <span class="sc">&lt;</span> y)} ) ) <span class="sc">%&gt;%</span> </span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># STEP 3. Calculation of variables (daily) that will be useful to summarize the intervals </span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">Weather =</span> Weather <span class="sc">%&gt;%</span> </span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>      <span class="co"># User must adapt depending on the crop (these ay be corn-specific)</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>        purrr<span class="sc">::</span><span class="fu">map</span>(<span class="sc">~</span> <span class="fu">mutate</span>(.,</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># Extreme Precip. event:</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>                            <span class="at">EPEi =</span> <span class="fu">case_when</span>(PP <span class="sc">&gt;</span> <span class="dv">25</span> <span class="sc">~</span><span class="dv">1</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>),</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># Extreme Temp. event:</span></span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ETEi =</span> <span class="fu">case_when</span>(Tmax <span class="sc">&gt;=</span> <span class="dv">30</span> <span class="sc">~</span><span class="dv">1</span>, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">0</span>), </span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># Tmax factor,  crop heat units (CHU):</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>                            <span class="at">Ymax =</span> <span class="fu">case_when</span>(Tmax <span class="sc">&lt;</span> <span class="dv">10</span> <span class="sc">~</span> <span class="dv">0</span>, </span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>                                    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fl">3.33</span><span class="sc">*</span>(Tmax<span class="dv">-10</span>) <span class="sc">-</span> <span class="fl">0.084</span><span class="sc">*</span>(Tmax<span class="dv">-10</span>)),</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># Tmin factor, Crop heat units (CHU):</span></span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>                            <span class="at">Ymin =</span> <span class="fu">case_when</span>(Tmin <span class="sc">&lt;</span> <span class="fl">4.44</span> <span class="sc">~</span> <span class="dv">0</span>, </span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>                                    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="fl">1.8</span><span class="sc">*</span>(Tmin<span class="fl">-4.44</span>)), </span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># Daily CHU:</span></span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>                            <span class="at">Yavg =</span> (Ymax <span class="sc">+</span> Ymin)<span class="sc">/</span><span class="dv">2</span>,</span>
<span id="cb10-48"><a href="#cb10-48" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># For WHEAT (diff. base temp and winter negatives)</span></span>
<span id="cb10-49"><a href="#cb10-49" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># # Tmin threshold Growing Degrees:</span></span>
<span id="cb10-50"><a href="#cb10-50" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># Gmin = case_when(Tmin &gt;= 0 ~ Tmin, TRUE ~ 0),</span></span>
<span id="cb10-51"><a href="#cb10-51" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># # Tmax threshold Growing Degrees:</span></span>
<span id="cb10-52"><a href="#cb10-52" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># Gmax = case_when(Tmax &gt; 30 ~ 30,</span></span>
<span id="cb10-53"><a href="#cb10-53" aria-hidden="true" tabindex="-1"></a>                            <span class="co">#                  Tmin &lt; 0 ~ 0, </span></span>
<span id="cb10-54"><a href="#cb10-54" aria-hidden="true" tabindex="-1"></a>                            <span class="co">#                  between(Tmax, 0, 30) ~ Tmax),</span></span>
<span id="cb10-55"><a href="#cb10-55" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># # Daily Growing Degree Units:</span></span>
<span id="cb10-56"><a href="#cb10-56" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># GDU = ((Gmin + Gmax)/2) - 0,</span></span>
<span id="cb10-57"><a href="#cb10-57" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># GDD_c = cumsum(GDU) </span></span>
<span id="cb10-58"><a href="#cb10-58" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># For CORN, SOYBEAN (Base temp = 10)</span></span>
<span id="cb10-59"><a href="#cb10-59" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># Tmin threshold Growing Degrees:</span></span>
<span id="cb10-60"><a href="#cb10-60" aria-hidden="true" tabindex="-1"></a>                            <span class="at">Gmin =</span> <span class="fu">case_when</span>(Tmin <span class="sc">&gt;=</span> <span class="dv">10</span> <span class="sc">~</span> Tmin, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">10</span>),</span>
<span id="cb10-61"><a href="#cb10-61" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># Tmax threshold Growing Degrees:</span></span>
<span id="cb10-62"><a href="#cb10-62" aria-hidden="true" tabindex="-1"></a>                            <span class="at">Gmax =</span> <span class="fu">case_when</span>(Tmax <span class="sc">&lt;=</span> <span class="dv">30</span> <span class="sc">~</span> Tmax, <span class="cn">TRUE</span> <span class="sc">~</span> <span class="dv">30</span>),</span>
<span id="cb10-63"><a href="#cb10-63" aria-hidden="true" tabindex="-1"></a>                            <span class="co"># Daily Growing Degree Units:</span></span>
<span id="cb10-64"><a href="#cb10-64" aria-hidden="true" tabindex="-1"></a>                            <span class="at">GDU =</span> ((Gmin <span class="sc">+</span> Gmax)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">-</span> <span class="dv">10</span>) ) ) <span class="sc">%&gt;%</span> </span>
<span id="cb10-65"><a href="#cb10-65" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-66"><a href="#cb10-66" aria-hidden="true" tabindex="-1"></a>    <span class="co"># STEP 4. Summary for each variable over the period of interest:</span></span>
<span id="cb10-67"><a href="#cb10-67" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb10-68"><a href="#cb10-68" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Duration of interval (days):</span></span>
<span id="cb10-69"><a href="#cb10-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">Dur =</span> Weather <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">map</span>(<span class="sc">~</span><span class="fu">nrow</span>(.)),</span>
<span id="cb10-70"><a href="#cb10-70" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Accumulated PP (mm):</span></span>
<span id="cb10-71"><a href="#cb10-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">PP =</span> Weather <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">map</span>(<span class="sc">~</span><span class="fu">sum</span>(.<span class="sc">$</span>PP)),</span>
<span id="cb10-72"><a href="#cb10-72" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Mean Temp (C):</span></span>
<span id="cb10-73"><a href="#cb10-73" aria-hidden="true" tabindex="-1"></a>      <span class="at">Tmean =</span> Weather <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">map</span>(<span class="sc">~</span><span class="fu">mean</span>(.<span class="sc">$</span>Tmean)),</span>
<span id="cb10-74"><a href="#cb10-74" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Accumulated Rad (MJ/m2):</span></span>
<span id="cb10-75"><a href="#cb10-75" aria-hidden="true" tabindex="-1"></a>      <span class="at">Rad =</span> Weather <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">map</span>(<span class="sc">~</span><span class="fu">sum</span>(.<span class="sc">$</span>Rad)),</span>
<span id="cb10-76"><a href="#cb10-76" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Accumulated VPD (kPa):</span></span>
<span id="cb10-77"><a href="#cb10-77" aria-hidden="true" tabindex="-1"></a>      <span class="at">VPD =</span> Weather <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">map</span>(<span class="sc">~</span><span class="fu">sum</span>(.<span class="sc">$</span>VPD)),</span>
<span id="cb10-78"><a href="#cb10-78" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Accumulated ET0 (mm):</span></span>
<span id="cb10-79"><a href="#cb10-79" aria-hidden="true" tabindex="-1"></a>      <span class="at">ET0_HS =</span> Weather <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">map</span>(<span class="sc">~</span><span class="fu">sum</span>(.<span class="sc">$</span>ET0_HS)),</span>
<span id="cb10-80"><a href="#cb10-80" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Number of ETE (#):</span></span>
<span id="cb10-81"><a href="#cb10-81" aria-hidden="true" tabindex="-1"></a>      <span class="at">ETE =</span> Weather <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">map</span>(<span class="sc">~</span><span class="fu">sum</span>(.<span class="sc">$</span>ETEi)),</span>
<span id="cb10-82"><a href="#cb10-82" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Number of EPE (#):</span></span>
<span id="cb10-83"><a href="#cb10-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">EPE =</span> Weather <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">map</span>(<span class="sc">~</span><span class="fu">sum</span>(.<span class="sc">$</span>EPEi)),</span>
<span id="cb10-84"><a href="#cb10-84" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Accumulated Crop Heat Units (CHU):</span></span>
<span id="cb10-85"><a href="#cb10-85" aria-hidden="true" tabindex="-1"></a>      <span class="at">CHU =</span> Weather <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">map</span>(<span class="sc">~</span><span class="fu">sum</span>(.<span class="sc">$</span>Yavg)),</span>
<span id="cb10-86"><a href="#cb10-86" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Shannon Diversity Index for PP:</span></span>
<span id="cb10-87"><a href="#cb10-87" aria-hidden="true" tabindex="-1"></a>      <span class="at">SDI =</span> Weather <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">map</span>(<span class="sc">~</span> vegan<span class="sc">::</span><span class="fu">diversity</span>(.<span class="sc">$</span>PP, <span class="at">index =</span> <span class="st">"shannon"</span>)<span class="sc">/</span><span class="fu">log</span>(<span class="fu">length</span>(.<span class="sc">$</span>PP))),</span>
<span id="cb10-88"><a href="#cb10-88" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Accumulated Growing Degree Days (GDD):</span></span>
<span id="cb10-89"><a href="#cb10-89" aria-hidden="true" tabindex="-1"></a>      <span class="at">GDD =</span>  Weather <span class="sc">%&gt;%</span> purrr<span class="sc">::</span><span class="fu">map</span>(<span class="sc">~</span><span class="fu">sum</span>(.<span class="sc">$</span>GDU))) <span class="sc">%&gt;%</span> </span>
<span id="cb10-90"><a href="#cb10-90" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb10-91"><a href="#cb10-91" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Additional indices and final units:</span></span>
<span id="cb10-92"><a href="#cb10-92" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(<span class="sc">-</span>Weather) <span class="sc">%&gt;%</span> </span>
<span id="cb10-93"><a href="#cb10-93" aria-hidden="true" tabindex="-1"></a>    <span class="co"># DS: `cols` is now required when using unnest()</span></span>
<span id="cb10-94"><a href="#cb10-94" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(Dur, PP, Tmean, Rad, VPD, ET0_HS, ETE, EPE, CHU, SDI, GDD)) <span class="sc">%&gt;%</span> </span>
<span id="cb10-95"><a href="#cb10-95" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(</span>
<span id="cb10-96"><a href="#cb10-96" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Photo-thermal quotient (Q):</span></span>
<span id="cb10-97"><a href="#cb10-97" aria-hidden="true" tabindex="-1"></a>      <span class="at">Q_chu =</span> Rad<span class="sc">/</span>CHU,</span>
<span id="cb10-98"><a href="#cb10-98" aria-hidden="true" tabindex="-1"></a>      <span class="at">Q_gdd =</span> Rad<span class="sc">/</span>GDD,</span>
<span id="cb10-99"><a href="#cb10-99" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Abundant and Well Distributed Water:</span></span>
<span id="cb10-100"><a href="#cb10-100" aria-hidden="true" tabindex="-1"></a>      <span class="at">AWDR =</span> PP<span class="sc">*</span>SDI) </span>
<span id="cb10-101"><a href="#cb10-101" aria-hidden="true" tabindex="-1"></a>  }</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="run-summaries" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="run-summaries"><span class="header-section-number">3.3</span> Run summaries</h2>
<section id="seasonal" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="seasonal"><span class="header-section-number">3.3.1</span> Seasonal</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the summary</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># input = dataframe containing the data (from daymet).</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># intervals = type of intervals (season, custom or even)</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>season_summary_daymet <span class="ot">&lt;-</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary.daymet</span>(<span class="at">input =</span> df_weather_daymet,</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">intervals =</span> season_interval)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Skim data</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(season_summary_daymet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">season_summary_daymet</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">20</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Date</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ID</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Interval</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Crop</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Site</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: Date</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: left;">min</th>
<th style="text-align: left;">max</th>
<th style="text-align: left;">median</th>
<th style="text-align: right;">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Start.in</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2002-04-25</td>
<td style="text-align: left;">2010-05-20</td>
<td style="text-align: left;">2005-05-01</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">End.in</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2002-09-30</td>
<td style="text-align: left;">2010-10-10</td>
<td style="text-align: left;">2006-09-30</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 13%">
<col style="width: 9%">
<col style="width: 13%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Dur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">272.67</td>
<td style="text-align: right;">211.73</td>
<td style="text-align: right;">143.00</td>
<td style="text-align: right;">150.50</td>
<td style="text-align: right;">158.00</td>
<td style="text-align: right;">337.50</td>
<td style="text-align: right;">517.00</td>
<td style="text-align: left;">▇▁▁▁▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">PP</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">683.57</td>
<td style="text-align: right;">395.63</td>
<td style="text-align: right;">361.53</td>
<td style="text-align: right;">462.75</td>
<td style="text-align: right;">563.98</td>
<td style="text-align: right;">844.58</td>
<td style="text-align: right;">1125.19</td>
<td style="text-align: left;">▇▇▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tmean</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16.04</td>
<td style="text-align: right;">3.20</td>
<td style="text-align: right;">12.55</td>
<td style="text-align: right;">14.63</td>
<td style="text-align: right;">16.70</td>
<td style="text-align: right;">17.78</td>
<td style="text-align: right;">18.85</td>
<td style="text-align: left;">▇▁▁▇▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rad</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4359.96</td>
<td style="text-align: right;">2895.00</td>
<td style="text-align: right;">2394.44</td>
<td style="text-align: right;">2697.73</td>
<td style="text-align: right;">3001.02</td>
<td style="text-align: right;">5342.72</td>
<td style="text-align: right;">7684.42</td>
<td style="text-align: left;">▇▁▁▁▃</td>
</tr>
<tr class="odd">
<td style="text-align: left;">VPD</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">358.94</td>
<td style="text-align: right;">237.60</td>
<td style="text-align: right;">218.15</td>
<td style="text-align: right;">221.77</td>
<td style="text-align: right;">225.40</td>
<td style="text-align: right;">429.33</td>
<td style="text-align: right;">633.26</td>
<td style="text-align: left;">▇▁▁▁▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">ET0_HS</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">925.30</td>
<td style="text-align: right;">517.24</td>
<td style="text-align: right;">594.03</td>
<td style="text-align: right;">627.29</td>
<td style="text-align: right;">660.56</td>
<td style="text-align: right;">1090.94</td>
<td style="text-align: right;">1521.32</td>
<td style="text-align: left;">▇▁▁▁▃</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ETE</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">17.67</td>
<td style="text-align: right;">3.79</td>
<td style="text-align: right;">15.00</td>
<td style="text-align: right;">15.50</td>
<td style="text-align: right;">16.00</td>
<td style="text-align: right;">19.00</td>
<td style="text-align: right;">22.00</td>
<td style="text-align: left;">▇▁▁▁▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">EPE</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.67</td>
<td style="text-align: right;">2.52</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.50</td>
<td style="text-align: right;">3.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▇▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CHU</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6368.17</td>
<td style="text-align: right;">3463.65</td>
<td style="text-align: right;">4274.61</td>
<td style="text-align: right;">4369.18</td>
<td style="text-align: right;">4463.75</td>
<td style="text-align: right;">7414.95</td>
<td style="text-align: right;">10366.15</td>
<td style="text-align: left;">▇▁▁▁▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">SDI</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: right;">0.76</td>
<td style="text-align: left;">▃▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDD</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1677.80</td>
<td style="text-align: right;">742.37</td>
<td style="text-align: right;">1208.96</td>
<td style="text-align: right;">1249.85</td>
<td style="text-align: right;">1290.73</td>
<td style="text-align: right;">1912.22</td>
<td style="text-align: right;">2533.71</td>
<td style="text-align: left;">▇▁▁▁▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q_chu</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.66</td>
<td style="text-align: right;">0.11</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">0.62</td>
<td style="text-align: right;">0.70</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: left;">▃▁▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q_gdd</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.46</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">1.86</td>
<td style="text-align: right;">2.17</td>
<td style="text-align: right;">2.48</td>
<td style="text-align: right;">2.76</td>
<td style="text-align: right;">3.03</td>
<td style="text-align: left;">▇▁▇▁▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">AWDR</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">513.54</td>
<td style="text-align: right;">307.39</td>
<td style="text-align: right;">257.93</td>
<td style="text-align: right;">343.01</td>
<td style="text-align: right;">428.09</td>
<td style="text-align: right;">641.35</td>
<td style="text-align: right;">854.62</td>
<td style="text-align: left;">▇▇▁▁▇</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a table to visualize results</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(season_summary_daymet) <span class="sc">%&gt;%</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">7</span>, <span class="at">position =</span> <span class="st">"center"</span>, </span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"scale_down"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">ID</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Interval</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Start.in</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">End.in</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Crop</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Site</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Dur</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PP</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Tmean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Rad</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">VPD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ET0_HS</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ETE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">EPE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CHU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SDI</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GDD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Q_chu</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Q_gdd</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AWDR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Season</td>
<td style="text-align: left;">2002-04-25</td>
<td style="text-align: left;">2002-09-30</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: right;">158</td>
<td style="text-align: right;">361.53</td>
<td style="text-align: right;">16.70405</td>
<td style="text-align: right;">3001.020</td>
<td style="text-align: right;">218.1533</td>
<td style="text-align: right;">660.5558</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4274.608</td>
<td style="text-align: right;">0.7134269</td>
<td style="text-align: right;">1208.965</td>
<td style="text-align: right;">0.7020574</td>
<td style="text-align: right;">2.482305</td>
<td style="text-align: right;">257.9252</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Season</td>
<td style="text-align: left;">2005-05-01</td>
<td style="text-align: left;">2006-09-30</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Ridgetown</td>
<td style="text-align: right;">517</td>
<td style="text-align: right;">1125.19</td>
<td style="text-align: right;">12.55279</td>
<td style="text-align: right;">7684.417</td>
<td style="text-align: right;">633.2642</td>
<td style="text-align: right;">1521.3225</td>
<td style="text-align: right;">22</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">10366.150</td>
<td style="text-align: right;">0.7595347</td>
<td style="text-align: right;">2533.715</td>
<td style="text-align: right;">0.7412990</td>
<td style="text-align: right;">3.032866</td>
<td style="text-align: right;">854.6209</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Season</td>
<td style="text-align: left;">2010-05-20</td>
<td style="text-align: left;">2010-10-10</td>
<td style="text-align: left;">Soybean</td>
<td style="text-align: left;">Winchester</td>
<td style="text-align: right;">143</td>
<td style="text-align: right;">563.98</td>
<td style="text-align: right;">18.85315</td>
<td style="text-align: right;">2394.440</td>
<td style="text-align: right;">225.3956</td>
<td style="text-align: right;">594.0311</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4463.745</td>
<td style="text-align: right;">0.7590440</td>
<td style="text-align: right;">1290.725</td>
<td style="text-align: right;">0.5364196</td>
<td style="text-align: right;">1.855113</td>
<td style="text-align: right;">428.0856</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="even" class="level3" data-number="3.3.2">
<h3 data-number="3.3.2" class="anchored" data-anchor-id="even"><span class="header-section-number">3.3.2</span> Even</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the summary</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="co"># input = dataframe containing the data (from daymet).</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># intervals = type of intervals (season, custom or even)</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>even_summary_daymet <span class="ot">&lt;-</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary.daymet</span>(<span class="at">input =</span> df_weather_daymet,</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">intervals =</span> even_intervals)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Skim data</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(even_summary_daymet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">even_summary_daymet</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">20</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Date</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ID</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Interval</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Crop</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Site</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: Date</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: left;">min</th>
<th style="text-align: left;">max</th>
<th style="text-align: left;">median</th>
<th style="text-align: right;">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Start.in</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2002-03-26</td>
<td style="text-align: left;">2010-09-05</td>
<td style="text-align: left;">2005-09-07</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">End.in</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2002-04-24</td>
<td style="text-align: left;">2010-10-11</td>
<td style="text-align: left;">2006-01-15</td>
<td style="text-align: right;">15</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 14%">
<col style="width: 10%">
<col style="width: 14%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Dur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">60.53</td>
<td style="text-align: right;">43.22</td>
<td style="text-align: right;">29.00</td>
<td style="text-align: right;">36.00</td>
<td style="text-align: right;">39.00</td>
<td style="text-align: right;">84.50</td>
<td style="text-align: right;">130.00</td>
<td style="text-align: left;">▇▁▁▁▃</td>
</tr>
<tr class="even">
<td style="text-align: left;">PP</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">153.76</td>
<td style="text-align: right;">92.73</td>
<td style="text-align: right;">45.94</td>
<td style="text-align: right;">92.45</td>
<td style="text-align: right;">113.04</td>
<td style="text-align: right;">208.32</td>
<td style="text-align: right;">364.82</td>
<td style="text-align: left;">▇▃▂▂▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tmean</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">14.46</td>
<td style="text-align: right;">6.40</td>
<td style="text-align: right;">4.11</td>
<td style="text-align: right;">8.35</td>
<td style="text-align: right;">18.00</td>
<td style="text-align: right;">19.57</td>
<td style="text-align: right;">22.11</td>
<td style="text-align: left;">▃▃▁▁▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rad</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">981.82</td>
<td style="text-align: right;">680.51</td>
<td style="text-align: right;">402.74</td>
<td style="text-align: right;">595.51</td>
<td style="text-align: right;">707.50</td>
<td style="text-align: right;">924.39</td>
<td style="text-align: right;">2563.53</td>
<td style="text-align: left;">▇▂▁▁▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">VPD</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">76.45</td>
<td style="text-align: right;">62.46</td>
<td style="text-align: right;">21.08</td>
<td style="text-align: right;">37.52</td>
<td style="text-align: right;">62.84</td>
<td style="text-align: right;">77.33</td>
<td style="text-align: right;">218.10</td>
<td style="text-align: left;">▇▆▁▁▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">ET0_HS</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">201.85</td>
<td style="text-align: right;">152.45</td>
<td style="text-align: right;">63.49</td>
<td style="text-align: right;">117.28</td>
<td style="text-align: right;">174.13</td>
<td style="text-align: right;">198.55</td>
<td style="text-align: right;">576.34</td>
<td style="text-align: left;">▇▇▁▁▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ETE</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.53</td>
<td style="text-align: right;">4.34</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: right;">6.00</td>
<td style="text-align: right;">14.00</td>
<td style="text-align: left;">▇▃▂▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">EPE</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.60</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">2.00</td>
<td style="text-align: left;">▇▁▅▁▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CHU</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1329.55</td>
<td style="text-align: right;">1267.41</td>
<td style="text-align: right;">170.96</td>
<td style="text-align: right;">502.82</td>
<td style="text-align: right;">1165.18</td>
<td style="text-align: right;">1356.75</td>
<td style="text-align: right;">4269.04</td>
<td style="text-align: left;">▇▇▁▁▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">SDI</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">0.07</td>
<td style="text-align: right;">0.43</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.65</td>
<td style="text-align: right;">0.69</td>
<td style="text-align: right;">0.73</td>
<td style="text-align: left;">▁▁▃▅▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDD</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">347.29</td>
<td style="text-align: right;">409.21</td>
<td style="text-align: right;">-112.18</td>
<td style="text-align: right;">98.38</td>
<td style="text-align: right;">319.40</td>
<td style="text-align: right;">404.69</td>
<td style="text-align: right;">1285.44</td>
<td style="text-align: left;">▇▇▁▁▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q_chu</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.20</td>
<td style="text-align: right;">0.98</td>
<td style="text-align: right;">0.47</td>
<td style="text-align: right;">0.54</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">1.79</td>
<td style="text-align: right;">3.05</td>
<td style="text-align: left;">▇▁▁▂▂</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q_gdd</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7.47</td>
<td style="text-align: right;">19.56</td>
<td style="text-align: right;">-15.99</td>
<td style="text-align: right;">1.79</td>
<td style="text-align: right;">2.15</td>
<td style="text-align: right;">7.00</td>
<td style="text-align: right;">74.52</td>
<td style="text-align: left;">▇▇▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">AWDR</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">102.83</td>
<td style="text-align: right;">68.43</td>
<td style="text-align: right;">26.06</td>
<td style="text-align: right;">57.67</td>
<td style="text-align: right;">77.62</td>
<td style="text-align: right;">145.51</td>
<td style="text-align: right;">263.99</td>
<td style="text-align: left;">▇▃▂▂▁</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a table to visualize results</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(even_summary_daymet) <span class="sc">%&gt;%</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">7</span>, <span class="at">position =</span> <span class="st">"center"</span>, </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"scale_down"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">ID</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Interval</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Start.in</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">End.in</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Crop</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Site</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Dur</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PP</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Tmean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Rad</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">VPD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ET0_HS</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ETE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">EPE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CHU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SDI</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GDD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Q_chu</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Q_gdd</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AWDR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">Prev</td>
<td style="text-align: left;">2002-03-26</td>
<td style="text-align: left;">2002-04-24</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">95.53</td>
<td style="text-align: right;">5.660000</td>
<td style="text-align: right;">505.2583</td>
<td style="text-align: right;">21.08116</td>
<td style="text-align: right;">63.48611</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">200.0765</td>
<td style="text-align: right;">0.6357661</td>
<td style="text-align: right;">6.780</td>
<td style="text-align: right;">2.5253259</td>
<td style="text-align: right;">74.521875</td>
<td style="text-align: right;">60.73474</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">A</td>
<td style="text-align: left;">2002-04-25</td>
<td style="text-align: left;">2002-06-03</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">113.04</td>
<td style="text-align: right;">8.802250</td>
<td style="text-align: right;">800.8372</td>
<td style="text-align: right;">33.52344</td>
<td style="text-align: right;">128.07920</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">370.5894</td>
<td style="text-align: right;">0.6866269</td>
<td style="text-align: right;">84.400</td>
<td style="text-align: right;">2.1609828</td>
<td style="text-align: right;">9.488593</td>
<td style="text-align: right;">77.61630</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">B</td>
<td style="text-align: left;">2002-06-03</td>
<td style="text-align: left;">2002-07-13</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">98.94</td>
<td style="text-align: right;">19.117375</td>
<td style="text-align: right;">856.4385</td>
<td style="text-align: right;">62.83969</td>
<td style="text-align: right;">202.20827</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1288.3794</td>
<td style="text-align: right;">0.6508401</td>
<td style="text-align: right;">371.250</td>
<td style="text-align: right;">0.6647409</td>
<td style="text-align: right;">2.306905</td>
<td style="text-align: right;">64.39412</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">C</td>
<td style="text-align: left;">2002-07-13</td>
<td style="text-align: left;">2002-08-22</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: right;">40</td>
<td style="text-align: right;">89.36</td>
<td style="text-align: right;">20.994750</td>
<td style="text-align: right;">752.2604</td>
<td style="text-align: right;">69.43155</td>
<td style="text-align: right;">194.90035</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1483.4871</td>
<td style="text-align: right;">0.5993348</td>
<td style="text-align: right;">437.950</td>
<td style="text-align: right;">0.5070893</td>
<td style="text-align: right;">1.717685</td>
<td style="text-align: right;">53.55656</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">D</td>
<td style="text-align: left;">2002-08-22</td>
<td style="text-align: left;">2002-10-01</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">60.83</td>
<td style="text-align: right;">17.997436</td>
<td style="text-align: right;">604.4711</td>
<td style="text-align: right;">53.82624</td>
<td style="text-align: right;">138.43587</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1165.1813</td>
<td style="text-align: right;">0.4283610</td>
<td style="text-align: right;">324.600</td>
<td style="text-align: right;">0.5187786</td>
<td style="text-align: right;">1.862203</td>
<td style="text-align: right;">26.05720</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">Prev</td>
<td style="text-align: left;">2005-04-01</td>
<td style="text-align: left;">2005-04-30</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Ridgetown</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">105.04</td>
<td style="text-align: right;">7.902759</td>
<td style="text-align: right;">522.1453</td>
<td style="text-align: right;">21.72264</td>
<td style="text-align: right;">75.06876</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">170.9552</td>
<td style="text-align: right;">0.5923778</td>
<td style="text-align: right;">41.800</td>
<td style="text-align: right;">3.0542811</td>
<td style="text-align: right;">12.491513</td>
<td style="text-align: right;">62.22337</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">A</td>
<td style="text-align: left;">2005-05-01</td>
<td style="text-align: left;">2005-09-07</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Ridgetown</td>
<td style="text-align: right;">130</td>
<td style="text-align: right;">225.28</td>
<td style="text-align: right;">19.555615</td>
<td style="text-align: right;">2563.5280</td>
<td style="text-align: right;">216.16182</td>
<td style="text-align: right;">576.34481</td>
<td style="text-align: right;">14</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4269.0377</td>
<td style="text-align: right;">0.6940917</td>
<td style="text-align: right;">1285.435</td>
<td style="text-align: right;">0.6004932</td>
<td style="text-align: right;">1.994288</td>
<td style="text-align: right;">156.36498</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">B</td>
<td style="text-align: left;">2005-09-07</td>
<td style="text-align: left;">2006-01-15</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Ridgetown</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">255.66</td>
<td style="text-align: right;">6.956744</td>
<td style="text-align: right;">992.3342</td>
<td style="text-align: right;">115.05132</td>
<td style="text-align: right;">174.13068</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1296.1836</td>
<td style="text-align: right;">0.6752569</td>
<td style="text-align: right;">112.950</td>
<td style="text-align: right;">0.7655815</td>
<td style="text-align: right;">8.785606</td>
<td style="text-align: right;">172.63617</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">C</td>
<td style="text-align: left;">2006-01-15</td>
<td style="text-align: left;">2006-05-24</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Ridgetown</td>
<td style="text-align: right;">130</td>
<td style="text-align: right;">287.94</td>
<td style="text-align: right;">4.109692</td>
<td style="text-align: right;">1793.2989</td>
<td style="text-align: right;">85.09908</td>
<td style="text-align: right;">236.08072</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">593.9790</td>
<td style="text-align: right;">0.6804557</td>
<td style="text-align: right;">-112.175</td>
<td style="text-align: right;">3.0191285</td>
<td style="text-align: right;">-15.986619</td>
<td style="text-align: right;">195.93041</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">D</td>
<td style="text-align: left;">2006-05-24</td>
<td style="text-align: left;">2006-10-01</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Ridgetown</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">364.82</td>
<td style="text-align: right;">19.592442</td>
<td style="text-align: right;">2341.9490</td>
<td style="text-align: right;">218.10287</td>
<td style="text-align: right;">536.30800</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4217.6632</td>
<td style="text-align: right;">0.7236240</td>
<td style="text-align: right;">1249.530</td>
<td style="text-align: right;">0.5552717</td>
<td style="text-align: right;">1.874264</td>
<td style="text-align: right;">263.99249</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">Prev</td>
<td style="text-align: left;">2010-04-20</td>
<td style="text-align: left;">2010-05-19</td>
<td style="text-align: left;">Soybean</td>
<td style="text-align: left;">Winchester</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">45.94</td>
<td style="text-align: right;">11.114483</td>
<td style="text-align: right;">586.5492</td>
<td style="text-align: right;">23.85418</td>
<td style="text-align: right;">106.48366</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">411.6609</td>
<td style="text-align: right;">0.5915947</td>
<td style="text-align: right;">112.350</td>
<td style="text-align: right;">1.4248358</td>
<td style="text-align: right;">5.220732</td>
<td style="text-align: right;">27.17786</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">A</td>
<td style="text-align: left;">2010-05-20</td>
<td style="text-align: left;">2010-06-25</td>
<td style="text-align: left;">Soybean</td>
<td style="text-align: left;">Winchester</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">119.18</td>
<td style="text-align: right;">18.890417</td>
<td style="text-align: right;">685.8864</td>
<td style="text-align: right;">51.43909</td>
<td style="text-align: right;">177.92863</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1134.8709</td>
<td style="text-align: right;">0.7315317</td>
<td style="text-align: right;">319.395</td>
<td style="text-align: right;">0.6043740</td>
<td style="text-align: right;">2.147455</td>
<td style="text-align: right;">87.18395</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">B</td>
<td style="text-align: left;">2010-06-25</td>
<td style="text-align: left;">2010-07-31</td>
<td style="text-align: left;">Soybean</td>
<td style="text-align: left;">Winchester</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">85.30</td>
<td style="text-align: right;">22.106111</td>
<td style="text-align: right;">707.4951</td>
<td style="text-align: right;">69.55371</td>
<td style="text-align: right;">184.06589</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1417.3120</td>
<td style="text-align: right;">0.6402241</td>
<td style="text-align: right;">426.640</td>
<td style="text-align: right;">0.4991809</td>
<td style="text-align: right;">1.658295</td>
<td style="text-align: right;">54.61112</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">C</td>
<td style="text-align: left;">2010-07-31</td>
<td style="text-align: left;">2010-09-05</td>
<td style="text-align: left;">Soybean</td>
<td style="text-align: left;">Winchester</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">168.14</td>
<td style="text-align: right;">20.660556</td>
<td style="text-align: right;">612.1467</td>
<td style="text-align: right;">63.55369</td>
<td style="text-align: right;">150.74414</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1290.7796</td>
<td style="text-align: right;">0.6259308</td>
<td style="text-align: right;">382.745</td>
<td style="text-align: right;">0.4742457</td>
<td style="text-align: right;">1.599359</td>
<td style="text-align: right;">105.24400</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">D</td>
<td style="text-align: left;">2010-09-05</td>
<td style="text-align: left;">2010-10-11</td>
<td style="text-align: left;">Soybean</td>
<td style="text-align: left;">Winchester</td>
<td style="text-align: right;">36</td>
<td style="text-align: right;">191.36</td>
<td style="text-align: right;">13.492083</td>
<td style="text-align: right;">402.7351</td>
<td style="text-align: right;">41.51125</td>
<td style="text-align: right;">83.48533</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">633.1501</td>
<td style="text-align: right;">0.7037089</td>
<td style="text-align: right;">165.755</td>
<td style="text-align: right;">0.6360815</td>
<td style="text-align: right;">2.429701</td>
<td style="text-align: right;">134.66174</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="custom" class="level3" data-number="3.3.3">
<h3 data-number="3.3.3" class="anchored" data-anchor-id="custom"><span class="header-section-number">3.3.3</span> Custom</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Run the summary</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="co"># input = dataframe containing the data (from daymet).</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="co"># intervals = type of intervals (season, custom or even)</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>custom_summary_daymet <span class="ot">&lt;-</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary.daymet</span>(<span class="at">input =</span> df_weather_daymet,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                           <span class="at">intervals =</span> custom_intervals)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Skim data</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(custom_summary_daymet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">custom_summary_daymet</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">21</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Date</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ID</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Interval</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">9</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Crop</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Site</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: Date</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: left;">min</th>
<th style="text-align: left;">max</th>
<th style="text-align: left;">median</th>
<th style="text-align: right;">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Start.in</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2002-03-26</td>
<td style="text-align: left;">2010-08-15</td>
<td style="text-align: left;">2005-12-10</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td style="text-align: left;">End.in</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2002-04-24</td>
<td style="text-align: left;">2010-10-10</td>
<td style="text-align: left;">2006-07-30</td>
<td style="text-align: right;">12</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 14%">
<col style="width: 10%">
<col style="width: 14%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Dur</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">74.92</td>
<td style="text-align: right;">118.16</td>
<td style="text-align: right;">18.00</td>
<td style="text-align: right;">29.00</td>
<td style="text-align: right;">40.50</td>
<td style="text-align: right;">55.25</td>
<td style="text-align: right;">445.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">PP</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">191.43</td>
<td style="text-align: right;">233.36</td>
<td style="text-align: right;">45.94</td>
<td style="text-align: right;">82.21</td>
<td style="text-align: right;">100.29</td>
<td style="text-align: right;">188.89</td>
<td style="text-align: right;">895.24</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tmean</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">15.79</td>
<td style="text-align: right;">5.72</td>
<td style="text-align: right;">5.66</td>
<td style="text-align: right;">11.36</td>
<td style="text-align: right;">16.97</td>
<td style="text-align: right;">20.28</td>
<td style="text-align: right;">23.58</td>
<td style="text-align: left;">▅▅▅▇▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rad</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1214.16</td>
<td style="text-align: right;">1723.57</td>
<td style="text-align: right;">332.92</td>
<td style="text-align: right;">517.92</td>
<td style="text-align: right;">653.53</td>
<td style="text-align: right;">913.03</td>
<td style="text-align: right;">6546.07</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">VPD</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">94.38</td>
<td style="text-align: right;">133.33</td>
<td style="text-align: right;">21.08</td>
<td style="text-align: right;">30.15</td>
<td style="text-align: right;">66.72</td>
<td style="text-align: right;">81.44</td>
<td style="text-align: right;">507.83</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">ET0_HS</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">249.35</td>
<td style="text-align: right;">330.83</td>
<td style="text-align: right;">63.49</td>
<td style="text-align: right;">89.12</td>
<td style="text-align: right;">151.66</td>
<td style="text-align: right;">222.19</td>
<td style="text-align: right;">1261.95</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ETE</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4.42</td>
<td style="text-align: right;">5.12</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">3.50</td>
<td style="text-align: right;">6.25</td>
<td style="text-align: right;">18.00</td>
<td style="text-align: left;">▇▅▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">EPE</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: right;">1.48</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">5.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">CHU</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1638.66</td>
<td style="text-align: right;">2112.65</td>
<td style="text-align: right;">170.96</td>
<td style="text-align: right;">610.25</td>
<td style="text-align: right;">1248.18</td>
<td style="text-align: right;">1717.42</td>
<td style="text-align: right;">8062.31</td>
<td style="text-align: left;">▇▂▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">SDI</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.64</td>
<td style="text-align: right;">0.08</td>
<td style="text-align: right;">0.52</td>
<td style="text-align: right;">0.58</td>
<td style="text-align: right;">0.61</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">0.75</td>
<td style="text-align: left;">▆▆▂▂▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">GDD</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">427.22</td>
<td style="text-align: right;">482.32</td>
<td style="text-align: right;">6.78</td>
<td style="text-align: right;">178.38</td>
<td style="text-align: right;">362.19</td>
<td style="text-align: right;">483.34</td>
<td style="text-align: right;">1848.98</td>
<td style="text-align: left;">▇▇▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Q_chu</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1.03</td>
<td style="text-align: right;">0.88</td>
<td style="text-align: right;">0.41</td>
<td style="text-align: right;">0.51</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">1.07</td>
<td style="text-align: right;">3.05</td>
<td style="text-align: left;">▇▂▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Q_gdd</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">9.28</td>
<td style="text-align: right;">20.78</td>
<td style="text-align: right;">1.30</td>
<td style="text-align: right;">1.79</td>
<td style="text-align: right;">1.94</td>
<td style="text-align: right;">3.96</td>
<td style="text-align: right;">74.52</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">AWDR</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">133.24</td>
<td style="text-align: right;">178.12</td>
<td style="text-align: right;">27.18</td>
<td style="text-align: right;">44.11</td>
<td style="text-align: right;">61.48</td>
<td style="text-align: right;">140.08</td>
<td style="text-align: right;">668.48</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a table to visualize results</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(custom_summary_daymet) <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">7</span>, <span class="at">position =</span> <span class="st">"center"</span>, </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"scale_down"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">ID</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Interval</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Name</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Start.in</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">End.in</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Crop</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Site</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Dur</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PP</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Tmean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Rad</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">VPD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ET0_HS</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ETE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">EPE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CHU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SDI</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GDD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Q_chu</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Q_gdd</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AWDR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">A</td>
<td style="text-align: left;">Prev</td>
<td style="text-align: left;">2002-03-26</td>
<td style="text-align: left;">2002-04-24</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">95.53</td>
<td style="text-align: right;">5.660000</td>
<td style="text-align: right;">505.2583</td>
<td style="text-align: right;">21.08116</td>
<td style="text-align: right;">63.48611</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">200.0765</td>
<td style="text-align: right;">0.6357661</td>
<td style="text-align: right;">6.780</td>
<td style="text-align: right;">2.5253259</td>
<td style="text-align: right;">74.521875</td>
<td style="text-align: right;">60.73474</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">B</td>
<td style="text-align: left;">Plant-Flo</td>
<td style="text-align: left;">2002-04-25</td>
<td style="text-align: left;">2002-07-19</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">211.98</td>
<td style="text-align: right;">14.478353</td>
<td style="text-align: right;">1767.0401</td>
<td style="text-align: right;">105.60612</td>
<td style="text-align: right;">358.83259</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1868.5814</td>
<td style="text-align: right;">0.7117824</td>
<td style="text-align: right;">518.900</td>
<td style="text-align: right;">0.9456586</td>
<td style="text-align: right;">3.405358</td>
<td style="text-align: right;">150.88364</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: left;">C</td>
<td style="text-align: left;">Flo-SeFi</td>
<td style="text-align: left;">2002-07-20</td>
<td style="text-align: left;">2002-08-07</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">61.48</td>
<td style="text-align: right;">21.249444</td>
<td style="text-align: right;">333.0742</td>
<td style="text-align: right;">32.24373</td>
<td style="text-align: right;">89.48994</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">676.4427</td>
<td style="text-align: right;">0.5459508</td>
<td style="text-align: right;">200.385</td>
<td style="text-align: right;">0.4923909</td>
<td style="text-align: right;">1.662171</td>
<td style="text-align: right;">33.56506</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: left;">D</td>
<td style="text-align: left;">SeFi-End</td>
<td style="text-align: left;">2002-08-08</td>
<td style="text-align: left;">2002-09-30</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: right;">53</td>
<td style="text-align: right;">88.07</td>
<td style="text-align: right;">18.649434</td>
<td style="text-align: right;">861.4328</td>
<td style="text-align: right;">77.13351</td>
<td style="text-align: right;">203.26534</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1667.0347</td>
<td style="text-align: right;">0.5490199</td>
<td style="text-align: right;">471.480</td>
<td style="text-align: right;">0.5167456</td>
<td style="text-align: right;">1.827082</td>
<td style="text-align: right;">48.35218</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">A</td>
<td style="text-align: left;">Prev</td>
<td style="text-align: left;">2005-04-01</td>
<td style="text-align: left;">2005-04-30</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Ridgetown</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">105.04</td>
<td style="text-align: right;">7.902759</td>
<td style="text-align: right;">522.1453</td>
<td style="text-align: right;">21.72264</td>
<td style="text-align: right;">75.06876</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">170.9552</td>
<td style="text-align: right;">0.5923778</td>
<td style="text-align: right;">41.800</td>
<td style="text-align: right;">3.0542811</td>
<td style="text-align: right;">12.491513</td>
<td style="text-align: right;">62.22337</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">B</td>
<td style="text-align: left;">Plant-Flo</td>
<td style="text-align: left;">2005-05-01</td>
<td style="text-align: left;">2006-07-20</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Ridgetown</td>
<td style="text-align: right;">445</td>
<td style="text-align: right;">895.24</td>
<td style="text-align: right;">11.445236</td>
<td style="text-align: right;">6546.0731</td>
<td style="text-align: right;">507.83287</td>
<td style="text-align: right;">1261.94680</td>
<td style="text-align: right;">18</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">8062.3054</td>
<td style="text-align: right;">0.7467051</td>
<td style="text-align: right;">1848.980</td>
<td style="text-align: right;">0.8119356</td>
<td style="text-align: right;">3.540370</td>
<td style="text-align: right;">668.48028</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: left;">C</td>
<td style="text-align: left;">Flo-SeFi</td>
<td style="text-align: left;">2006-07-21</td>
<td style="text-align: left;">2006-08-09</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Ridgetown</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">71.87</td>
<td style="text-align: right;">23.582632</td>
<td style="text-align: right;">332.9171</td>
<td style="text-align: right;">42.49005</td>
<td style="text-align: right;">87.99388</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">808.2634</td>
<td style="text-align: right;">0.5904150</td>
<td style="text-align: right;">255.540</td>
<td style="text-align: right;">0.4118919</td>
<td style="text-align: right;">1.302798</td>
<td style="text-align: right;">42.43313</td>
</tr>
<tr class="even">
<td style="text-align: left;">2</td>
<td style="text-align: left;">D</td>
<td style="text-align: left;">SeFi-End</td>
<td style="text-align: left;">2006-08-10</td>
<td style="text-align: left;">2006-09-30</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Ridgetown</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">158.08</td>
<td style="text-align: right;">17.779314</td>
<td style="text-align: right;">760.1808</td>
<td style="text-align: right;">79.45679</td>
<td style="text-align: right;">161.56523</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1422.1259</td>
<td style="text-align: right;">0.6849177</td>
<td style="text-align: right;">407.350</td>
<td style="text-align: right;">0.5345383</td>
<td style="text-align: right;">1.866161</td>
<td style="text-align: right;">108.27178</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">A</td>
<td style="text-align: left;">Prev</td>
<td style="text-align: left;">2010-04-20</td>
<td style="text-align: left;">2010-05-19</td>
<td style="text-align: left;">Soybean</td>
<td style="text-align: left;">Winchester</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">45.94</td>
<td style="text-align: right;">11.114483</td>
<td style="text-align: right;">586.5492</td>
<td style="text-align: right;">23.85418</td>
<td style="text-align: right;">106.48366</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">411.6609</td>
<td style="text-align: right;">0.5915947</td>
<td style="text-align: right;">112.350</td>
<td style="text-align: right;">1.4248358</td>
<td style="text-align: right;">5.220732</td>
<td style="text-align: right;">27.17786</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">B</td>
<td style="text-align: left;">Plant-Flo</td>
<td style="text-align: left;">2010-05-20</td>
<td style="text-align: left;">2010-07-14</td>
<td style="text-align: left;">Soybean</td>
<td style="text-align: left;">Winchester</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">181.19</td>
<td style="text-align: right;">19.959273</td>
<td style="text-align: right;">1067.8207</td>
<td style="text-align: right;">87.38554</td>
<td style="text-align: right;">278.97376</td>
<td style="text-align: right;">8</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1880.1266</td>
<td style="text-align: right;">0.7532597</td>
<td style="text-align: right;">538.705</td>
<td style="text-align: right;">0.5679515</td>
<td style="text-align: right;">1.982199</td>
<td style="text-align: right;">136.48312</td>
</tr>
<tr class="odd">
<td style="text-align: left;">3</td>
<td style="text-align: left;">C</td>
<td style="text-align: left;">Flo-SeFi</td>
<td style="text-align: left;">2010-07-15</td>
<td style="text-align: left;">2010-08-14</td>
<td style="text-align: left;">Soybean</td>
<td style="text-align: left;">Winchester</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">85.66</td>
<td style="text-align: right;">21.524167</td>
<td style="text-align: right;">566.9201</td>
<td style="text-align: right;">56.30866</td>
<td style="text-align: right;">141.75997</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1137.2219</td>
<td style="text-align: right;">0.5215225</td>
<td style="text-align: right;">346.630</td>
<td style="text-align: right;">0.4985132</td>
<td style="text-align: right;">1.635519</td>
<td style="text-align: right;">44.67362</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: left;">D</td>
<td style="text-align: left;">SeFi-End</td>
<td style="text-align: left;">2010-08-15</td>
<td style="text-align: left;">2010-10-10</td>
<td style="text-align: left;">Soybean</td>
<td style="text-align: left;">Winchester</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">297.13</td>
<td style="text-align: right;">16.158571</td>
<td style="text-align: right;">720.5205</td>
<td style="text-align: right;">77.41198</td>
<td style="text-align: right;">163.36417</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1359.1429</td>
<td style="text-align: right;">0.7257673</td>
<td style="text-align: right;">377.755</td>
<td style="text-align: right;">0.5301286</td>
<td style="text-align: right;">1.907375</td>
<td style="text-align: right;">215.64723</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
</section>
<section id="historical-weather" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> Historical weather</h1>
<section id="locations-and-dates-data" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="locations-and-dates-data"><span class="header-section-number">4.1</span> Locations and Dates Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For historical data (from Jan-01-2000 to Dec-31-2022)</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>df_historical <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">ID =</span> <span class="fu">c</span>(<span class="st">'1'</span>, <span class="st">'2'</span>, <span class="st">'3'</span>),</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                      <span class="co"># Dates as YYYY_MM_DD, using "_" to separate</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">Start =</span> <span class="fu">c</span>(<span class="st">'2000-01-01'</span>, <span class="st">'2000-01-01'</span>, <span class="st">'2000-01-01'</span>),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">End =</span> <span class="fu">c</span>(<span class="st">'2022-12-31'</span>, <span class="st">'2022-12-31'</span>, <span class="st">'2022-12-31'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Express start and end as dates using "across"</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="fu">across</span>(Start<span class="sc">:</span>End, <span class="sc">~</span><span class="fu">as.Date</span>(., <span class="at">format =</span> <span class="st">'%Y-%m-%d'</span>)))</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Merge for historical weather data</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>df_historical <span class="ot">&lt;-</span> df_sites <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">left_join</span>(df_historical, <span class="at">by =</span> <span class="st">"ID"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="retrieve-from-daymet" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="retrieve-from-daymet"><span class="header-section-number">4.2</span> Retrieve from DAYMET</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify input = dataframe containing historical dates from sites </span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>hist_weather_daymet <span class="ot">&lt;-</span> <span class="fu">weather.daymet</span>(<span class="at">input =</span> df_historical)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="co"># This is a large data frame (21900 obs), so good to have an overview</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Skim data</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(hist_weather_daymet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">hist_weather_daymet</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">25185</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">23</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Date</td>
<td style="text-align: left;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">17</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">ID</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">Crop</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">7</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Site</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">10</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: Date</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 17%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: left;">min</th>
<th style="text-align: left;">max</th>
<th style="text-align: left;">median</th>
<th style="text-align: right;">n_unique</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Start</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2000-01-01</td>
<td style="text-align: left;">2000-01-01</td>
<td style="text-align: left;">2000-01-01</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">End</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2022-12-31</td>
<td style="text-align: left;">2022-12-31</td>
<td style="text-align: left;">2022-12-31</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Date</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2000-01-01</td>
<td style="text-align: left;">2022-12-31</td>
<td style="text-align: left;">2011-07-02</td>
<td style="text-align: right;">8395</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 14%">
<col style="width: 10%">
<col style="width: 14%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 8%">
<col style="width: 6%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">latitude</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">43.73</td>
<td style="text-align: right;">1.08</td>
<td style="text-align: right;">42.45</td>
<td style="text-align: right;">42.45</td>
<td style="text-align: right;">43.65</td>
<td style="text-align: right;">45.08</td>
<td style="text-align: right;">45.08</td>
<td style="text-align: left;">▇▁▇▁▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">longitude</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">-79.21</td>
<td style="text-align: right;">2.80</td>
<td style="text-align: right;">-81.88</td>
<td style="text-align: right;">-81.88</td>
<td style="text-align: right;">-80.40</td>
<td style="text-align: right;">-75.35</td>
<td style="text-align: right;">-75.35</td>
<td style="text-align: left;">▇▇▁▁▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DOY</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">183.00</td>
<td style="text-align: right;">105.37</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">92.00</td>
<td style="text-align: right;">183.00</td>
<td style="text-align: right;">274.00</td>
<td style="text-align: right;">365.00</td>
<td style="text-align: left;">▇▇▇▇▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">Year</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2011.00</td>
<td style="text-align: right;">6.63</td>
<td style="text-align: right;">2000.00</td>
<td style="text-align: right;">2005.00</td>
<td style="text-align: right;">2011.00</td>
<td style="text-align: right;">2017.00</td>
<td style="text-align: right;">2022.00</td>
<td style="text-align: left;">▇▆▇▆▇</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Month</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">6.52</td>
<td style="text-align: right;">3.45</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">7.00</td>
<td style="text-align: right;">10.00</td>
<td style="text-align: right;">12.00</td>
<td style="text-align: left;">▇▅▅▅▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">Day</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">15.72</td>
<td style="text-align: right;">8.79</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">8.00</td>
<td style="text-align: right;">16.00</td>
<td style="text-align: right;">23.00</td>
<td style="text-align: right;">31.00</td>
<td style="text-align: left;">▇▇▇▇▆</td>
</tr>
<tr class="odd">
<td style="text-align: left;">DL</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">12.00</td>
<td style="text-align: right;">2.26</td>
<td style="text-align: right;">8.56</td>
<td style="text-align: right;">9.80</td>
<td style="text-align: right;">12.00</td>
<td style="text-align: right;">14.20</td>
<td style="text-align: right;">15.44</td>
<td style="text-align: left;">▇▅▅▅▇</td>
</tr>
<tr class="even">
<td style="text-align: left;">PP</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.58</td>
<td style="text-align: right;">5.27</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">2.92</td>
<td style="text-align: right;">85.53</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rad</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">13.40</td>
<td style="text-align: right;">7.37</td>
<td style="text-align: right;">0.74</td>
<td style="text-align: right;">6.84</td>
<td style="text-align: right;">12.59</td>
<td style="text-align: right;">19.32</td>
<td style="text-align: right;">32.59</td>
<td style="text-align: left;">▇▇▇▆▂</td>
</tr>
<tr class="even">
<td style="text-align: left;">SWE</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">16.21</td>
<td style="text-align: right;">32.83</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">12.65</td>
<td style="text-align: right;">211.59</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tmax</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">12.75</td>
<td style="text-align: right;">11.54</td>
<td style="text-align: right;">-22.58</td>
<td style="text-align: right;">2.94</td>
<td style="text-align: right;">13.55</td>
<td style="text-align: right;">23.18</td>
<td style="text-align: right;">36.23</td>
<td style="text-align: left;">▁▅▇▇▅</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tmin</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">3.03</td>
<td style="text-align: right;">10.49</td>
<td style="text-align: right;">-31.93</td>
<td style="text-align: right;">-3.83</td>
<td style="text-align: right;">3.42</td>
<td style="text-align: right;">11.72</td>
<td style="text-align: right;">25.02</td>
<td style="text-align: left;">▁▂▇▇▅</td>
</tr>
<tr class="odd">
<td style="text-align: left;">VPD</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.93</td>
<td style="text-align: right;">0.59</td>
<td style="text-align: right;">0.04</td>
<td style="text-align: right;">0.46</td>
<td style="text-align: right;">0.77</td>
<td style="text-align: right;">1.35</td>
<td style="text-align: right;">3.17</td>
<td style="text-align: left;">▇▅▃▁▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tmean</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">7.89</td>
<td style="text-align: right;">10.85</td>
<td style="text-align: right;">-26.25</td>
<td style="text-align: right;">-0.37</td>
<td style="text-align: right;">8.46</td>
<td style="text-align: right;">17.42</td>
<td style="text-align: right;">29.88</td>
<td style="text-align: left;">▁▃▇▇▅</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ET0_HS</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2.42</td>
<td style="text-align: right;">1.83</td>
<td style="text-align: right;">-0.45</td>
<td style="text-align: right;">0.72</td>
<td style="text-align: right;">1.97</td>
<td style="text-align: right;">4.00</td>
<td style="text-align: right;">7.38</td>
<td style="text-align: left;">▇▅▅▅▁</td>
</tr>
<tr class="even">
<td style="text-align: left;">EPE_i</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.01</td>
<td style="text-align: right;">0.10</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
<tr class="odd">
<td style="text-align: left;">ETE_i</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">0.03</td>
<td style="text-align: right;">0.17</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">0.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: left;">▇▁▁▁▁</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="summary-functions" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="summary-functions"><span class="header-section-number">4.3</span> Summary functions</h2>
<section id="by-year" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="by-year"><span class="header-section-number">4.3.1</span> By year</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining function to summarize historical weather (years)</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Revised function:</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>historical.years <span class="ot">&lt;-</span> <span class="cf">function</span>(hist.data) {</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Creates an input tibble with the start and end date for each year a summary is desired</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Args:</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  hist.data = data frame containing the historical weather data to summarize (must be complete years)</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Returns:</span></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  a tibble of monthly summaries for each ID</span></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># By year:</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  hist.data <span class="sc">%&gt;%</span> </span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(ID, Crop, Site) <span class="sc">%&gt;%</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">the_Dates =</span> purrr<span class="sc">::</span><span class="fu">map</span>(data, <span class="cf">function</span>(.data) {.data <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">group_by</span>(Year) <span class="sc">%&gt;%</span> </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Start.in =</span> <span class="fu">min</span>(Date), <span class="at">End.in =</span> <span class="fu">max</span>(Date), <span class="at">.groups =</span> <span class="st">"drop"</span>)})) <span class="sc">%&gt;%</span></span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(ID, Site, the_Dates) <span class="sc">%&gt;%</span></span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(the_Dates))</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="by-year-month" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="by-year-month"><span class="header-section-number">4.3.2</span> By year-month</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Defining function to summarize historical weather (years &amp; months)</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Revised function:</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>historical.yearmonths <span class="ot">&lt;-</span> <span class="cf">function</span>(hist.data) {</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Creates an input tibble with the start and end date for each year &amp; month a summary is desired (monthly summaries)</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Args:</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  hist.data = data frame containing the historical weather data to summarize (must be complete years)</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Returns:</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#  a tibble of monthly summaries for each ID</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># By month in year:</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  hist.data <span class="sc">%&gt;%</span> </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">group_by</span>(ID, Crop, Site) <span class="sc">%&gt;%</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">nest</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">mutate</span>(<span class="at">the_Dates =</span> purrr<span class="sc">::</span><span class="fu">map</span>(data, <span class="cf">function</span>(.data) {.data <span class="sc">%&gt;%</span> </span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">group_by</span>(Year, Month) <span class="sc">%&gt;%</span> </span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">Start.in =</span> <span class="fu">min</span>(Date), <span class="at">End.in =</span> <span class="fu">max</span>(Date), <span class="at">.groups =</span> <span class="st">"drop"</span>)})) <span class="sc">%&gt;%</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">select</span>(ID, Site, the_Dates) <span class="sc">%&gt;%</span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>    tidyr<span class="sc">::</span><span class="fu">unnest</span>(<span class="at">cols =</span> <span class="fu">c</span>(the_Dates))</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="run-historical-summaries" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="run-historical-summaries"><span class="header-section-number">4.4</span> Run Historical Summaries</h2>
<p>Summary can be obtained by years or by years.months. User must specify this option at the “intervals” argument of the summary function. <br></p>
<section id="by-year-1" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="by-year-1"><span class="header-section-number">4.4.1</span> By year</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify hist.data = dataframe containing the historical weather data to summarize</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>year_intervals <span class="ot">&lt;-</span> <span class="fu">historical.years</span>(<span class="at">hist.data =</span> hist_weather_daymet)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="co"># input = dataframe containing the historical weather data.</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="co"># intervals = type of historical intervals (years, years.months)</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarizing historical weather</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>year_summary_daymet <span class="ot">&lt;-</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary.daymet</span>(<span class="at">input =</span> hist_weather_daymet,</span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">intervals =</span> year_intervals)</span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a table to visualize data</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(<span class="fu">head</span>(year_summary_daymet)) <span class="sc">%&gt;%</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">7</span>, <span class="at">position =</span> <span class="st">"center"</span>, <span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"scale_down"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">ID</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Year</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Start.in</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">End.in</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Crop</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Site</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Dur</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PP</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Tmean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Rad</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">VPD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ET0_HS</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ETE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">EPE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CHU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SDI</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GDD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Q_chu</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Q_gdd</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AWDR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">2000</td>
<td style="text-align: left;">2000-01-01</td>
<td style="text-align: left;">2000-12-30</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: right;">364</td>
<td style="text-align: right;">1035.79</td>
<td style="text-align: right;">6.784354</td>
<td style="text-align: right;">4882.077</td>
<td style="text-align: right;">311.9404</td>
<td style="text-align: right;">834.4626</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">4364.787</td>
<td style="text-align: right;">0.7951588</td>
<td style="text-align: right;">480.635</td>
<td style="text-align: right;">1.1185144</td>
<td style="text-align: right;">10.157556</td>
<td style="text-align: right;">823.6175</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">2001</td>
<td style="text-align: left;">2001-01-01</td>
<td style="text-align: left;">2001-12-31</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: right;">364</td>
<td style="text-align: right;">909.30</td>
<td style="text-align: right;">7.786786</td>
<td style="text-align: right;">4956.964</td>
<td style="text-align: right;">321.2663</td>
<td style="text-align: right;">874.0620</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4667.094</td>
<td style="text-align: right;">0.7815342</td>
<td style="text-align: right;">644.145</td>
<td style="text-align: right;">1.0621094</td>
<td style="text-align: right;">7.695417</td>
<td style="text-align: right;">710.6491</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">2002</td>
<td style="text-align: left;">2002-01-01</td>
<td style="text-align: left;">2002-12-31</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: right;">364</td>
<td style="text-align: right;">795.34</td>
<td style="text-align: right;">7.495824</td>
<td style="text-align: right;">4869.331</td>
<td style="text-align: right;">327.4677</td>
<td style="text-align: right;">869.5653</td>
<td style="text-align: right;">16</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4773.116</td>
<td style="text-align: right;">0.7811108</td>
<td style="text-align: right;">630.985</td>
<td style="text-align: right;">1.0201579</td>
<td style="text-align: right;">7.717032</td>
<td style="text-align: right;">621.2487</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">2003</td>
<td style="text-align: left;">2003-01-01</td>
<td style="text-align: left;">2003-12-31</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: right;">364</td>
<td style="text-align: right;">948.80</td>
<td style="text-align: right;">6.212733</td>
<td style="text-align: right;">4976.636</td>
<td style="text-align: right;">300.1867</td>
<td style="text-align: right;">841.3591</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">4327.508</td>
<td style="text-align: right;">0.7825177</td>
<td style="text-align: right;">388.790</td>
<td style="text-align: right;">1.1500003</td>
<td style="text-align: right;">12.800318</td>
<td style="text-align: right;">742.4528</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">2004</td>
<td style="text-align: left;">2004-01-01</td>
<td style="text-align: left;">2004-12-30</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: right;">364</td>
<td style="text-align: right;">952.48</td>
<td style="text-align: right;">6.537857</td>
<td style="text-align: right;">4883.104</td>
<td style="text-align: right;">308.5060</td>
<td style="text-align: right;">827.3507</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">4256.332</td>
<td style="text-align: right;">0.8086498</td>
<td style="text-align: right;">401.735</td>
<td style="text-align: right;">1.1472563</td>
<td style="text-align: right;">12.155037</td>
<td style="text-align: right;">770.2228</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">2005</td>
<td style="text-align: left;">2005-01-01</td>
<td style="text-align: left;">2005-12-31</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: right;">364</td>
<td style="text-align: right;">842.09</td>
<td style="text-align: right;">7.185206</td>
<td style="text-align: right;">5117.729</td>
<td style="text-align: right;">300.0098</td>
<td style="text-align: right;">921.0563</td>
<td style="text-align: right;">24</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">5131.436</td>
<td style="text-align: right;">0.7836771</td>
<td style="text-align: right;">681.280</td>
<td style="text-align: right;">0.9973287</td>
<td style="text-align: right;">7.511932</td>
<td style="text-align: right;">659.9266</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="by-year-month-1" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="by-year-month-1"><span class="header-section-number">4.4.2</span> By year-month</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify hist.data = dataframe containing the historical weather data to summarize</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>yearmonth_intervals <span class="ot">&lt;-</span> <span class="fu">historical.yearmonths</span>(<span class="at">hist.data =</span> hist_weather_daymet)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># input = dataframe containing the historical weather data.</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co"># intervals = type of historical intervals (years, years.months)</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarizing historical weather</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>yearmonth_summary_daymet <span class="ot">&lt;-</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary.daymet</span>(<span class="at">input =</span> hist_weather_daymet,</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>                           <span class="at">intervals =</span> yearmonth_intervals)</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a table to visualize data</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="fu">kbl</span>(<span class="fu">head</span>(yearmonth_summary_daymet)) <span class="sc">%&gt;%</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">font_size =</span> <span class="dv">7</span>, <span class="at">position =</span> <span class="st">"center"</span>, <span class="at">latex_options =</span> <span class="fu">c</span>(<span class="st">"scale_down"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table caption-top table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">ID</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Year</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Month</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Start.in</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">End.in</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Crop</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Site</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Dur</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">PP</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Tmean</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Rad</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">VPD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ET0_HS</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">ETE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">EPE</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">CHU</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">SDI</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">GDD</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Q_chu</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Q_gdd</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AWDR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">2000-01-01</td>
<td style="text-align: left;">2000-01-31</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">44.22</td>
<td style="text-align: right;">-7.187333</td>
<td style="text-align: right;">191.5335</td>
<td style="text-align: right;">8.62155</td>
<td style="text-align: right;">12.22926</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0.94134</td>
<td style="text-align: right;">0.7172157</td>
<td style="text-align: right;">-190.010</td>
<td style="text-align: right;">203.4690205</td>
<td style="text-align: right;">-1.008018</td>
<td style="text-align: right;">31.71528</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">2000-02-01</td>
<td style="text-align: left;">2000-02-29</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: right;">28</td>
<td style="text-align: right;">57.08</td>
<td style="text-align: right;">-4.463036</td>
<td style="text-align: right;">269.1460</td>
<td style="text-align: right;">9.91130</td>
<td style="text-align: right;">19.01688</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">6.89583</td>
<td style="text-align: right;">0.7480953</td>
<td style="text-align: right;">-141.315</td>
<td style="text-align: right;">39.0302527</td>
<td style="text-align: right;">-1.904582</td>
<td style="text-align: right;">42.70128</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">2000-03-01</td>
<td style="text-align: left;">2000-03-31</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">44.97</td>
<td style="text-align: right;">2.868500</td>
<td style="text-align: right;">441.0486</td>
<td style="text-align: right;">16.34147</td>
<td style="text-align: right;">47.73356</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">86.70312</td>
<td style="text-align: right;">0.6801023</td>
<td style="text-align: right;">-33.830</td>
<td style="text-align: right;">5.0868832</td>
<td style="text-align: right;">-13.037205</td>
<td style="text-align: right;">30.58420</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">4</td>
<td style="text-align: left;">2000-04-01</td>
<td style="text-align: left;">2000-04-30</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">64.87</td>
<td style="text-align: right;">5.135345</td>
<td style="text-align: right;">552.8653</td>
<td style="text-align: right;">18.09003</td>
<td style="text-align: right;">65.36530</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">117.08760</td>
<td style="text-align: right;">0.5036470</td>
<td style="text-align: right;">-1.030</td>
<td style="text-align: right;">4.7218089</td>
<td style="text-align: right;">-536.762404</td>
<td style="text-align: right;">32.67158</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">2000-05-01</td>
<td style="text-align: left;">2000-05-31</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">147.43</td>
<td style="text-align: right;">12.970667</td>
<td style="text-align: right;">584.3621</td>
<td style="text-align: right;">31.84376</td>
<td style="text-align: right;">114.94758</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">505.68054</td>
<td style="text-align: right;">0.6533741</td>
<td style="text-align: right;">140.385</td>
<td style="text-align: right;">1.1555954</td>
<td style="text-align: right;">4.162568</td>
<td style="text-align: right;">96.32695</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: right;">2000</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">2000-06-01</td>
<td style="text-align: left;">2000-06-30</td>
<td style="text-align: left;">Corn</td>
<td style="text-align: left;">Elora</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">199.88</td>
<td style="text-align: right;">17.281207</td>
<td style="text-align: right;">560.0957</td>
<td style="text-align: right;">41.55868</td>
<td style="text-align: right;">133.48935</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">787.44879</td>
<td style="text-align: right;">0.7668216</td>
<td style="text-align: right;">217.885</td>
<td style="text-align: right;">0.7112789</td>
<td style="text-align: right;">2.570603</td>
<td style="text-align: right;">153.27230</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
</section>
<section id="exporting-results" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> Exporting Results</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># *.csv</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(my_summary_dataframe, <span class="st">"my_summary_dataframe.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="co"># *.xlsx</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>writexl<span class="sc">::</span><span class="fu">write_xlsx</span>(<span class="at">x =</span> my_summary_dataframe, <span class="at">path =</span> <span class="st">"my_summary_Daymet.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="references" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> References</h1>
<ul>
<li><p><a href="https://doi.org/10.1111/2041-210X.12970">Hufkens K., Basler J. D., Milliman T. Melaas E., Richardson A.D. (2018)</a> An integrated phenology modelling framework in R: Phenology modelling with phenor. Methods in Ecology &amp; Evolution, 9: 1-10.</p></li>
<li><p><a href="https://doi.org/10.1186/s13104-021-05622-8">Correndo, A.A., Moro Rosso, L.H. &amp; Ciampitti, I.A. (2021)</a> Retrieving and processing agro-meteorological data from API-client sources using R software. BMC Res Notes 14, 205.</p></li>
<li><p><a href="https://doi.org/10.7910/DVN/J9EUZU">Correndo, A.A., Moro Rosso, L.H., Ciampitti, I.A. (2021)</a> Agrometeorological data using R-software, Harvard Dataverse, V6.</p></li>
</ul>
<hr>
<p>This tutorial demonstrates how to retrieve and process agrometeorological data using R, ensuring reproducibility for agricultural research.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/adriancorrendo\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../coding/week_06/10_iteration.html" class="pagination-link" aria-label="10-Iteration">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">10-Iteration</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../coding/week_08/models_01.html" class="pagination-link" aria-label="12-Models I">
        <span class="nav-page-text">12-Models I</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><span> Developed by Adrian Correndo with <a href="https://quarto.org/">Quarto</a>. License: <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC BY-SA 2.0</a>. </span></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>