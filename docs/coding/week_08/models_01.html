<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr.&nbsp;Adrian Correndo">
<meta name="dcterms.date" content="2025-02-26">

<title>Statistical Models with R: I - Essentials – PLNT6800 - Winter 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-f2a1071e85750ec973bbb8a8f120da0f.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-f2a1071e85750ec973bbb8a8f120da0f.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-e759c8361f0112bf6e2955a60a6c0828.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-5ccce6f18d703cb4568c738a25a74289.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Statistical Models with R: I - Essentials – PLNT6800 - Winter 2025">
<meta property="og:description" content="Reproducible Ag Data Science with R">
<meta property="og:image" content="https://adriancorrendo.github.io/coding/week_08/models_01_files/figure-html/unnamed-chunk-16-1.png">
<meta property="og:site_name" content="PLNT6800 - Winter 2025">
<meta property="og:image:height" content="960">
<meta property="og:image:width" content="1344">
<meta name="twitter:title" content="Statistical Models with R: I - Essentials – PLNT6800 - Winter 2025">
<meta name="twitter:description" content="Reproducible Ag Data Science with R">
<meta name="twitter:image" content="https://adriancorrendo.github.io/coding/week_08/models_01_files/figure-html/unnamed-chunk-16-1.png">
<meta name="twitter:creator" content="@aacorrendo">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1344">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">PLNT6800 - Winter 2025</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://adriancorrendo.github.io/"> <i class="bi bi-globe" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/adriancorrendo/plnt6800/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/aacorrendo"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/adriancorrendo/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item">Statistical Models with R: I - Essentials</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../images/plnt6800_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://github.com/adriancorrendo/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Slides</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/day1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reproducibility</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Software</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../software/software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instructions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">Lessons</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_01/essentials_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01-Essentials of R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_02/02_fundamentals_rpackages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02-Fundamentals of packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_02/03_versioncontrol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03-Git &amp; GitHub</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_03/04_datawrangling_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04-Data Wrangling I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_03/05_datawrangling_02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05-Data Wrangling II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_04/06_datawrangling_03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">06-Data Wrangling III</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_04/07_ggplot2_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">07-Data viz I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_05/08_ggplot2_adv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">08-Data viz II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_05/09_ggplot2_plus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">09-Data viz III</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_06/10_iteration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10-Iteration</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_06/11_weather.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11-Weather data</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Calendar</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../outline/calendar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Course Outline</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../outline/outline.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Outline</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Content</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a>
  <ul>
  <li><a href="#statistical-modeling-process" id="toc-statistical-modeling-process" class="nav-link" data-scroll-target="#statistical-modeling-process"><span class="header-section-number">1.1</span> Statistical Modeling Process</a></li>
  </ul></li>
  <li><a href="#essential-r-packages" id="toc-essential-r-packages" class="nav-link" data-scroll-target="#essential-r-packages"><span class="header-section-number">2</span> Essential R Packages</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">3</span> Data</a></li>
  <li><a href="#key-statistical-models" id="toc-key-statistical-models" class="nav-link" data-scroll-target="#key-statistical-models"><span class="header-section-number">4</span> Key Statistical Models</a>
  <ul>
  <li><a href="#linear-models-lm" id="toc-linear-models-lm" class="nav-link" data-scroll-target="#linear-models-lm"><span class="header-section-number">4.1</span> Linear Models (LM)</a>
  <ul class="collapse">
  <li><a href="#categorical-covariates-as-independent-variables" id="toc-categorical-covariates-as-independent-variables" class="nav-link" data-scroll-target="#categorical-covariates-as-independent-variables"><span class="header-section-number">4.1.1</span> Categorical covariate/s as independent variable/s</a></li>
  <li><a href="#continuous-covariates-as-independent-variables" id="toc-continuous-covariates-as-independent-variables" class="nav-link" data-scroll-target="#continuous-covariates-as-independent-variables"><span class="header-section-number">4.1.2</span> Continuous covariate/s as independent variable/s</a></li>
  </ul></li>
  <li><a href="#generalized-linear-models-glm" id="toc-generalized-linear-models-glm" class="nav-link" data-scroll-target="#generalized-linear-models-glm"><span class="header-section-number">4.2</span> Generalized Linear Models (GLM)</a>
  <ul class="collapse">
  <li><a href="#example-using-glm-as-an-lm" id="toc-example-using-glm-as-an-lm" class="nav-link" data-scroll-target="#example-using-glm-as-an-lm"><span class="header-section-number">4.2.1</span> Example using GLM as an LM</a></li>
  <li><a href="#example-using-the-gaussian-family-with-log-link" id="toc-example-using-the-gaussian-family-with-log-link" class="nav-link" data-scroll-target="#example-using-the-gaussian-family-with-log-link"><span class="header-section-number">4.2.2</span> Example using the Gaussian family with log link:</a></li>
  </ul></li>
  <li><a href="#mixed-effects-models" id="toc-mixed-effects-models" class="nav-link" data-scroll-target="#mixed-effects-models"><span class="header-section-number">4.3</span> Mixed-Effects Models</a></li>
  <li><a href="#choosing-between-nlme-and-lme4" id="toc-choosing-between-nlme-and-lme4" class="nav-link" data-scroll-target="#choosing-between-nlme-and-lme4"><span class="header-section-number">4.4</span> Choosing Between <code>nlme</code> and <code>lme4</code></a></li>
  <li><a href="#analysis-of-variance-anova" id="toc-analysis-of-variance-anova" class="nav-link" data-scroll-target="#analysis-of-variance-anova"><span class="header-section-number">4.5</span> Analysis of Variance (ANOVA)</a>
  <ul class="collapse">
  <li><a href="#using-anova" id="toc-using-anova" class="nav-link" data-scroll-target="#using-anova"><span class="header-section-number">4.5.1</span> Using <code>anova()</code></a></li>
  <li><a href="#using-aov" id="toc-using-aov" class="nav-link" data-scroll-target="#using-aov"><span class="header-section-number">4.5.2</span> Using <code>aov()</code></a></li>
  <li><a href="#using-caranova" id="toc-using-caranova" class="nav-link" data-scroll-target="#using-caranova"><span class="header-section-number">4.5.3</span> Using <code>car::Anova()</code></a></li>
  <li><a href="#comparison-of-anova-vs.-anova" id="toc-comparison-of-anova-vs.-anova" class="nav-link" data-scroll-target="#comparison-of-anova-vs.-anova"><span class="header-section-number">4.5.4</span> Comparison of anova() vs.&nbsp;Anova()</a></li>
  </ul></li>
  <li><a href="#post-hoc-tests" id="toc-post-hoc-tests" class="nav-link" data-scroll-target="#post-hoc-tests"><span class="header-section-number">4.6</span> Post-hoc Tests</a></li>
  <li><a href="#nonlinear-models" id="toc-nonlinear-models" class="nav-link" data-scroll-target="#nonlinear-models"><span class="header-section-number">4.7</span> Nonlinear Models</a></li>
  </ul></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion"><span class="header-section-number">5</span> Conclusion</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Statistical Models with R: I - Essentials</h1>
  <div class="quarto-categories">
    <div class="quarto-category">statistical modelling</div>
    <div class="quarto-category">R</div>
    <div class="quarto-category">agriculture</div>
    <div class="quarto-category">agridat</div>
    <div class="quarto-category">agricolae</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dr.&nbsp;Adrian Correndo </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 26, 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>Statistical modeling is a process of developing and analyzing mathematical models to represent real-world phenomena. In agricultural research, statistical modeling plays a crucial role in understanding the relationships between environmental variables, management practices, and crop responses. By leveraging statistical models, researchers can make informed decisions about optimizing yield, improving resource efficiency, and enhancing sustainability in agriculture.</p>
<p>In this lesson, we focus on the essentials of statistical modeling using R, with examples relevant to ag-data science. We will explore the use of statistical models to analyze field experiments, evaluate treatment effects, and understand interactions between genotype, environment, and management practices. The examples will utilize datasets from the <code>agridat</code> package, particularly the <code>lasrosas.corn</code> dataset, and introduce key functions from <code>stats</code>, <code>nlme</code>, <code>lme4</code>, <code>car</code>, <code>multcomp</code>, and <code>agricolae</code>.</p>
<section id="statistical-modeling-process" class="level3" data-number="1.1">
<h3 data-number="1.1" class="anchored" data-anchor-id="statistical-modeling-process"><span class="header-section-number">1.1</span> Statistical Modeling Process</h3>
<ol type="1">
<li><strong>Data Collection and Exploratory Data Analysis (EDA)</strong>
<ul>
<li>Statistical modeling starts with data collection and EDA. In agricultural experiments, this involves gathering data on yield, soil properties, weather conditions, and management practices. EDA helps identify patterns, trends, and relationships between variables while detecting outliers or anomalies.</li>
</ul></li>
<li><strong>Types of Statistical Models</strong>
<ul>
<li>In agricultural research, common models include:
<ul>
<li><strong>Regression Models</strong>: For predicting continuous outcomes like crop yield based on variables such as soil nutrients or precipitation.</li>
<li><strong>Time Series Models</strong>: To analyze temporal data like seasonal growth patterns or yield trends over years.</li>
<li><strong>Mixed-Effects Models</strong>: Ideal for experimental designs with hierarchical structures, such as split-plot designs or repeated measures.</li>
</ul></li>
</ul></li>
<li><strong>Model Selection and Assumptions</strong>
<ul>
<li>The choice of model depends on the data type, research question, and assumptions about the data. For example:
<ul>
<li><strong>Linear Regression</strong> assumes a linear relationship between predictors and outcome, suitable for continuous variables like yield or biomass. We call it linear because we are basically comparing “lines”, where the lines represent the “means”.</li>
<li><strong>Generalized Linear Models (GLM)</strong> are used for non-normal distributions, such as count data (e.g., pest counts) or binary outcomes (e.g., disease presence).</li>
</ul></li>
</ul></li>
<li><strong>Model Evaluation</strong>
<ul>
<li>Evaluating model performance is crucial to ensure accurate predictions and inferences. In agricultural modeling, common metrics include:
<ul>
<li><strong>R-squared (R²)</strong>: Measures the proportion of variation explained by the model. But it is NOT always recommended as a criterion the “select models”.</li>
<li><strong>Mean Squared Error (MSE)</strong> and <strong>Root Mean Squared Error (RMSE)</strong>: Assess prediction accuracy.</li>
<li><strong>AIC and BIC</strong>: For model comparison and selection. These two are recommended when selecting a model.</li>
</ul></li>
</ul></li>
<li><strong>Application in Agricultural Research</strong>
<ul>
<li>Statistical models provide insights into complex agricultural systems, enabling researchers to:
<ul>
<li><strong>Identify Key Drivers</strong>: Determine which factors most influence crop performance, such as genotype-environment interactions.</li>
<li><strong>Predict Future Trends</strong>: Forecast yield potential under different climate scenarios or management practices.</li>
<li><strong>Optimize Inputs</strong>: Inform decision-making for fertilizer application, irrigation scheduling, or pest management.</li>
</ul></li>
</ul></li>
</ol>
</section>
</section>
<section id="essential-r-packages" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="essential-r-packages"><span class="header-section-number">2</span> Essential R Packages</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pacman)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(agridat, agricolae)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(dplyr, tidyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(ggplot2)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(nlme, lme4, car, multcomp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="data"><span class="header-section-number">3</span> Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data_corn <span class="ot">&lt;-</span> agridat<span class="sc">::</span>lasrosas.corn</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Check data structure and variables</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(data_corn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 3,443
Columns: 9
$ year  &lt;int&gt; 1999, 1999, 1999, 1999, 1999, 1999, 1999, 1999, 1999, 1999, 1999…
$ lat   &lt;dbl&gt; -33.05113, -33.05115, -33.05116, -33.05117, -33.05118, -33.05120…
$ long  &lt;dbl&gt; -63.84886, -63.84879, -63.84872, -63.84865, -63.84858, -63.84851…
$ yield &lt;dbl&gt; 72.14, 73.79, 77.25, 76.35, 75.55, 70.24, 76.17, 69.17, 69.77, 6…
$ nitro &lt;dbl&gt; 131.5, 131.5, 131.5, 131.5, 131.5, 131.5, 131.5, 131.5, 131.5, 1…
$ topo  &lt;fct&gt; W, W, W, W, W, W, W, W, W, W, W, W, W, W, W, W, W, W, W, W, W, W…
$ bv    &lt;dbl&gt; 162.60, 170.49, 168.39, 176.68, 171.46, 170.56, 172.94, 171.86, …
$ rep   &lt;fct&gt; R1, R1, R1, R1, R1, R1, R1, R1, R1, R1, R1, R1, R1, R1, R1, R1, …
$ nf    &lt;fct&gt; N5, N5, N5, N5, N5, N5, N5, N5, N5, N5, N5, N5, N5, N5, N5, N5, …</code></pre>
</div>
</div>
</section>
<section id="key-statistical-models" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="key-statistical-models"><span class="header-section-number">4</span> Key Statistical Models</h2>
<section id="linear-models-lm" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="linear-models-lm"><span class="header-section-number">4.1</span> Linear Models (LM)</h3>
<p>Linear regression models are fundamental for analyzing relationships between variables. The term “regression” could be confusing because it means we are working with a “continous response variable”, but it could also mean we using a “continuous covariate” (or independent / or explanatory variable) (e.g.&nbsp;a “regressor”).</p>
<section id="categorical-covariates-as-independent-variables" class="level4" data-number="4.1.1">
<h4 data-number="4.1.1" class="anchored" data-anchor-id="categorical-covariates-as-independent-variables"><span class="header-section-number">4.1.1</span> Categorical covariate/s as independent variable/s</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Complete Randomized</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>lm_fit_01 <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> nf, <span class="at">data =</span> data_corn)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="co"># See summary</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_fit_01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = yield ~ nf, data = data_corn)

Residuals:
    Min      1Q  Median      3Q     Max 
-52.313 -15.344  -3.126  13.563  45.337 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  64.9729     0.8218  79.060  &lt; 2e-16 ***
nfN1          3.6435     1.1602   3.140   0.0017 ** 
nfN2          4.6774     1.1632   4.021 5.92e-05 ***
nfN3          5.3630     1.1612   4.618 4.01e-06 ***
nfN4          7.5901     1.1627   6.528 7.65e-11 ***
nfN5          7.8589     1.1612   6.768 1.53e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 19.67 on 3437 degrees of freedom
Multiple R-squared:  0.01771,   Adjusted R-squared:  0.01629 
F-statistic:  12.4 on 5 and 3437 DF,  p-value: 6.075e-12</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative models</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Blocks (as fixed)</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>lm_fit_02 <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> nf <span class="sc">+</span> rep , <span class="at">data =</span> data_corn)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Add year (as fixed)</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>lm_fit_03 <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> nf <span class="sc">+</span> rep <span class="sc">+</span> year, <span class="at">data =</span> data_corn)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Add topography (as fixed)</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>lm_fit_04 <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> nf <span class="sc">+</span> rep <span class="sc">+</span> year <span class="sc">+</span> topo, <span class="at">data =</span> data_corn)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Different order </span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>lm_fit_05 <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> nf <span class="sc">+</span> year <span class="sc">+</span> topo <span class="sc">+</span> rep, <span class="at">data =</span> data_corn)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="continuous-covariates-as-independent-variables" class="level4" data-number="4.1.2">
<h4 data-number="4.1.2" class="anchored" data-anchor-id="continuous-covariates-as-independent-variables"><span class="header-section-number">4.1.2</span> Continuous covariate/s as independent variable/s</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Nitrogen (independent variable) as continuous predictor</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>lm_reg_01 <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> nitro, <span class="at">data =</span> data_corn)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="co"># See summary</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_reg_01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = yield ~ nitro, data = data_corn)

Residuals:
    Min      1Q  Median      3Q     Max 
-53.183 -15.341  -3.079  13.725  45.897 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 65.843213   0.608573 108.193  &lt; 2e-16 ***
nitro        0.061717   0.007868   7.845 5.75e-15 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 19.66 on 3441 degrees of freedom
Multiple R-squared:  0.01757,   Adjusted R-squared:  0.01728 
F-statistic: 61.54 on 1 and 3441 DF,  p-value: 5.754e-15</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare to N as a categorical variable</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_fit_01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = yield ~ nf, data = data_corn)

Residuals:
    Min      1Q  Median      3Q     Max 
-52.313 -15.344  -3.126  13.563  45.337 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  64.9729     0.8218  79.060  &lt; 2e-16 ***
nfN1          3.6435     1.1602   3.140   0.0017 ** 
nfN2          4.6774     1.1632   4.021 5.92e-05 ***
nfN3          5.3630     1.1612   4.618 4.01e-06 ***
nfN4          7.5901     1.1627   6.528 7.65e-11 ***
nfN5          7.8589     1.1612   6.768 1.53e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 19.67 on 3437 degrees of freedom
Multiple R-squared:  0.01771,   Adjusted R-squared:  0.01629 
F-statistic:  12.4 on 5 and 3437 DF,  p-value: 6.075e-12</code></pre>
</div>
</div>
</section>
</section>
<section id="generalized-linear-models-glm" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="generalized-linear-models-glm"><span class="header-section-number">4.2</span> Generalized Linear Models (GLM)</h3>
<p>GLMs extend linear models to handle non-normal response distributions. In agricultural research, they are useful for modeling yield data with non-constant variance or non-normal residuals.</p>
<section id="example-using-glm-as-an-lm" class="level4" data-number="4.2.1">
<h4 data-number="4.2.1" class="anchored" data-anchor-id="example-using-glm-as-an-lm"><span class="header-section-number">4.2.1</span> Example using GLM as an LM</h4>
<p>lm() is just a special case of glm where the distribution of error is assumed to be Gaussian (i.e.&nbsp;normal)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>glm_fit_01 <span class="ot">&lt;-</span> <span class="fu">glm</span>(yield <span class="sc">~</span> nf <span class="sc">+</span> rep, <span class="at">data =</span> data_corn, <span class="at">family =</span> gaussian)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co"># See summary</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm_fit_01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = yield ~ nf + rep, family = gaussian, data = data_corn)

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  64.7216     0.9486  68.225  &lt; 2e-16 ***
nfN1          3.6395     1.1600   3.138  0.00172 ** 
nfN2          4.6679     1.1630   4.014 6.11e-05 ***
nfN3          5.3600     1.1610   4.617 4.04e-06 ***
nfN4          7.5916     1.1625   6.530 7.53e-11 ***
nfN5          7.8559     1.1610   6.767 1.54e-11 ***
repR2        -0.3301     0.8213  -0.402  0.68775    
repR3         1.0915     0.8210   1.329  0.18377    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 386.8527)

    Null deviance: 1354097  on 3442  degrees of freedom
Residual deviance: 1328839  on 3435  degrees of freedom
AIC: 30294

Number of Fisher Scoring iterations: 2</code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Compare to lm</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_fit_02)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = yield ~ nf + rep, data = data_corn)

Residuals:
    Min      1Q  Median      3Q     Max 
-52.062 -15.476  -3.079  13.468  44.495 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  64.7216     0.9486  68.225  &lt; 2e-16 ***
nfN1          3.6395     1.1600   3.138  0.00172 ** 
nfN2          4.6679     1.1630   4.014 6.11e-05 ***
nfN3          5.3600     1.1610   4.617 4.04e-06 ***
nfN4          7.5916     1.1625   6.530 7.53e-11 ***
nfN5          7.8559     1.1610   6.767 1.54e-11 ***
repR2        -0.3301     0.8213  -0.402  0.68775    
repR3         1.0915     0.8210   1.329  0.18377    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 19.67 on 3435 degrees of freedom
Multiple R-squared:  0.01865,   Adjusted R-squared:  0.01665 
F-statistic: 9.327 on 7 and 3435 DF,  p-value: 1.708e-11</code></pre>
</div>
</div>
</section>
<section id="example-using-the-gaussian-family-with-log-link" class="level4" data-number="4.2.2">
<h4 data-number="4.2.2" class="anchored" data-anchor-id="example-using-the-gaussian-family-with-log-link"><span class="header-section-number">4.2.2</span> Example using the Gaussian family with log link:</h4>
<p>These approaches are particularly useful when yield data exhibit heteroscedasticity or skewness.</p>
<ul>
<li>For this first approach, the model assumes a multiplicative relationship between predictors and yield, modeling the expected value as an exponential function. If you want to stabilize variance or normalize the residuals, use the first approach.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using log link without manually transforming yield</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>glm_fit_02 <span class="ot">&lt;-</span> <span class="fu">glm</span>(yield <span class="sc">~</span> nf <span class="sc">+</span> rep, <span class="at">data =</span> data_corn, </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link =</span> <span class="st">"log"</span>))</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm_fit_02)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = yield ~ nf + rep, family = gaussian(link = "log"), 
    data = data_corn)

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  4.170242   0.014369 290.223  &lt; 2e-16 ***
nfN1         0.054586   0.017387   3.140  0.00171 ** 
nfN2         0.069457   0.017308   4.013 6.12e-05 ***
nfN3         0.079305   0.017202   4.610 4.17e-06 ***
nfN4         0.110495   0.016981   6.507 8.79e-11 ***
nfN5         0.114107   0.016934   6.738 1.87e-11 ***
repR2       -0.004492   0.011824  -0.380  0.70404    
repR3        0.015601   0.011702   1.333  0.18254    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 386.8745)

    Null deviance: 1354097  on 3442  degrees of freedom
Residual deviance: 1328857  on 3435  degrees of freedom
AIC: 30294

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p>Alternatively, you may want to manually log-transform the response:</p>
<ul>
<li>For this second approach, the log-transformed yield is modeled as a linear function of the predictors, stabilizing variance or normalizing residuals. If you believe the relationship between predictors and the expected value of yield is multiplicative, use the second approach.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Manually log-transforming yield</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>glm_fit_03 <span class="ot">&lt;-</span> <span class="fu">glm</span>(<span class="fu">log</span>(yield) <span class="sc">~</span> nf <span class="sc">+</span> rep, <span class="at">data =</span> lasrosas.corn, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">family =</span> <span class="fu">gaussian</span>(<span class="at">link =</span> <span class="st">"identity"</span>))</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(glm_fit_03)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = log(yield) ~ nf + rep, family = gaussian(link = "identity"), 
    data = lasrosas.corn)

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  4.114234   0.013869 296.650  &lt; 2e-16 ***
nfN1         0.070491   0.016959   4.157 3.31e-05 ***
nfN2         0.086082   0.017003   5.063 4.35e-07 ***
nfN3         0.096942   0.016974   5.711 1.22e-08 ***
nfN4         0.130277   0.016996   7.665 2.31e-14 ***
nfN5         0.129767   0.016974   7.645 2.69e-14 ***
repR2       -0.004546   0.012007  -0.379    0.705    
repR3        0.019599   0.012002   1.633    0.103    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for gaussian family taken to be 0.08268533)

    Null deviance: 291.07  on 3442  degrees of freedom
Residual deviance: 284.02  on 3435  degrees of freedom
AIC: 1198.4

Number of Fisher Scoring iterations: 2</code></pre>
</div>
</div>
<p>** Key Difference: ** - In the first case, the model is: $(Y) = X+ $, which is a linear model on the log-transformed outcome.</p>
<ul>
<li>In the second case, the model is: <span class="math inline">\(E(Y) = \exp(X\beta)\)</span> , where the expected value of yield is modeled as an exponential function of the predictors.</li>
</ul>
</section>
</section>
<section id="mixed-effects-models" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="mixed-effects-models"><span class="header-section-number">4.3</span> Mixed-Effects Models</h3>
<p>Mixed-effects models account for both fixed and random effects, often used in agricultural experiments.</p>
<p>Using <code>nlme</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>lme_fit <span class="ot">&lt;-</span> <span class="fu">lme</span>(yield <span class="sc">~</span> nf, <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span> <span class="sc">|</span> rep, <span class="at">data =</span> data_corn)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lme_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by REML
  Data: data_corn 
       AIC      BIC    logLik
  30286.69 30335.83 -15135.34

Random effects:
 Formula: ~1 | rep
        (Intercept) Residual
StdDev:   0.4656023 19.66857

Fixed effects:  yield ~ nf 
               Value Std.Error   DF  t-value p-value
(Intercept) 64.97387 0.8645219 3435 75.15584  0.0000
nfN1         3.64192 1.1599967 3435  3.13960  0.0017
nfN2         4.67371 1.1630343 3435  4.01855  0.0001
nfN3         5.36182 1.1610011 3435  4.61827  0.0000
nfN4         7.59070 1.1625194 3435  6.52953  0.0000
nfN5         7.85772 1.1610011 3435  6.76805  0.0000
 Correlation: 
     (Intr) nfN1   nfN2   nfN3   nfN4  
nfN1 -0.673                            
nfN2 -0.671  0.500                     
nfN3 -0.673  0.501  0.500              
nfN4 -0.672  0.501  0.499  0.500       
nfN5 -0.673  0.501  0.500  0.501  0.500

Standardized Within-Group Residuals:
       Min         Q1        Med         Q3        Max 
-2.6547157 -0.7871554 -0.1563133  0.6960595  2.2882930 

Number of Observations: 3443
Number of Groups: 3 </code></pre>
</div>
</div>
<p>Using <code>lme4</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>lmer_fit <span class="ot">&lt;-</span> <span class="fu">lmer</span>(yield <span class="sc">~</span> nf <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> rep), <span class="at">data =</span> data_corn)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lmer_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: yield ~ nf + (1 | rep)
   Data: data_corn

REML criterion at convergence: 30270.7

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.6547 -0.7872 -0.1563  0.6961  2.2883 

Random effects:
 Groups   Name        Variance Std.Dev.
 rep      (Intercept)   0.2168  0.4656 
 Residual             386.8526 19.6686 
Number of obs: 3443, groups:  rep, 3

Fixed effects:
            Estimate Std. Error t value
(Intercept)  64.9739     0.8645  75.156
nfN1          3.6419     1.1600   3.140
nfN2          4.6737     1.1630   4.019
nfN3          5.3618     1.1610   4.618
nfN4          7.5907     1.1625   6.530
nfN5          7.8577     1.1610   6.768

Correlation of Fixed Effects:
     (Intr) nfN1   nfN2   nfN3   nfN4  
nfN1 -0.673                            
nfN2 -0.671  0.500                     
nfN3 -0.673  0.501  0.500              
nfN4 -0.672  0.501  0.499  0.500       
nfN5 -0.673  0.501  0.500  0.501  0.500</code></pre>
</div>
</div>
</section>
<section id="choosing-between-nlme-and-lme4" class="level3" data-number="4.4">
<h3 data-number="4.4" class="anchored" data-anchor-id="choosing-between-nlme-and-lme4"><span class="header-section-number">4.4</span> Choosing Between <code>nlme</code> and <code>lme4</code></h3>
<ul>
<li><p><strong>nlme</strong>: Suitable for models that are linear and nonlinear mixed-effects models. It provides robust tools for analyzing data with nested random effects and handling different types of correlation structures within the data. It can handle heterogeneous variance models.</p></li>
<li><p><strong>lme4</strong>: Best for fitting large linear mixed-effects models. It does not handle nonlinear mixed-effects models or autoregressive correlation structures but is highly efficient with large datasets and complex random effects structures. It cannot handle heterogeneous variance models.</p></li>
</ul>
</section>
<section id="analysis-of-variance-anova" class="level3" data-number="4.5">
<h3 data-number="4.5" class="anchored" data-anchor-id="analysis-of-variance-anova"><span class="header-section-number">4.5</span> Analysis of Variance (ANOVA)</h3>
<p>Analysis of Variance (ANOVA) is widely used in agricultural research to compare the means of multiple groups and to understand the influence of categorical factors on continuous outcomes, such as yield or biomass. In R, there are multiple ways to perform ANOVA:</p>
<ul>
<li><code>anova()</code>: Sequential (Type I) ANOVA</li>
<li><code>aov()</code>: Similar for balanced designs</li>
<li><code>car::Anova()</code>: Flexible ANOVA with options for Type II and Type III Sum of Squares</li>
</ul>
<section id="using-anova" class="level4" data-number="4.5.1">
<h4 data-number="4.5.1" class="anchored" data-anchor-id="using-anova"><span class="header-section-number">4.5.1</span> Using <code>anova()</code></h4>
<p><code>anova()</code> performs Type I Sum of Squares (sequential). It tests each term sequentially, considering the order of the terms in the model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(yield <span class="sc">~</span> rep <span class="sc">+</span> nf <span class="sc">+</span> year <span class="sc">+</span> topo, <span class="at">data =</span> data_corn)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm_fit)  <span class="co"># Type I Sum of Squares</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: yield
            Df Sum Sq Mean Sq   F value  Pr(&gt;F)    
rep          2   1271     635    3.7264 0.02418 *  
nf           5  23987    4797   28.1334 &lt; 2e-16 ***
year         1  97313   97313  570.6692 &lt; 2e-16 ***
topo         3 646456  215485 1263.6625 &lt; 2e-16 ***
Residuals 3431 585070     171                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="using-aov" class="level4" data-number="4.5.2">
<h4 data-number="4.5.2" class="anchored" data-anchor-id="using-aov"><span class="header-section-number">4.5.2</span> Using <code>aov()</code></h4>
<p><code>aov()</code> is similar to <code>lm()</code> but is designed for balanced experimental designs. It also uses Type I Sum of Squares.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>aov_fit <span class="ot">&lt;-</span> <span class="fu">aov</span>(yield <span class="sc">~</span> nf <span class="sc">+</span> year <span class="sc">+</span> topo <span class="sc">+</span> rep, <span class="at">data =</span> data_corn)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(aov_fit)  <span class="co"># Type I Sum of Squares</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Df Sum Sq Mean Sq F value   Pr(&gt;F)    
nf             5  23987    4797   28.13  &lt; 2e-16 ***
year           1  97321   97321  570.71  &lt; 2e-16 ***
topo           3 643667  214556 1258.21  &lt; 2e-16 ***
rep            2   4053    2027   11.88 7.18e-06 ***
Residuals   3431 585070     171                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="using-caranova" class="level4" data-number="4.5.3">
<h4 data-number="4.5.3" class="anchored" data-anchor-id="using-caranova"><span class="header-section-number">4.5.3</span> Using <code>car::Anova()</code></h4>
<p>The <code>Anova()</code> function from the <code>car</code> package allows for Type II and Type III Sum of Squares:</p>
<ul>
<li><strong>Type II</strong>: Assumes no interaction between factors and tests each main effect after the other main effects.</li>
<li><strong>Type III</strong>: Tests each main effect and interaction after all other terms, typically used with dummy coding.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(lm_fit, <span class="at">type =</span> <span class="dv">2</span>)  <span class="co"># Type II Sum of Squares</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type II tests)

Response: yield
          Sum Sq   Df  F value    Pr(&gt;F)    
rep         4053    2   11.885 7.183e-06 ***
nf         21727    5   25.483 &lt; 2.2e-16 ***
year      120660    1  707.584 &lt; 2.2e-16 ***
topo      646456    3 1263.662 &lt; 2.2e-16 ***
Residuals 585070 3431                       
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(lm_fit, <span class="at">type =</span> <span class="dv">3</span>)  <span class="co"># Type III Sum of Squares</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: yield
            Sum Sq   Df  F value    Pr(&gt;F)    
(Intercept) 119183    1  698.920 &lt; 2.2e-16 ***
rep           4053    2   11.885 7.183e-06 ***
nf           21727    5   25.483 &lt; 2.2e-16 ***
year        120660    1  707.584 &lt; 2.2e-16 ***
topo        646456    3 1263.662 &lt; 2.2e-16 ***
Residuals   585070 3431                       
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="comparison-of-anova-vs.-anova" class="level4" data-number="4.5.4">
<h4 data-number="4.5.4" class="anchored" data-anchor-id="comparison-of-anova-vs.-anova"><span class="header-section-number">4.5.4</span> Comparison of anova() vs.&nbsp;Anova()</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For the anova(), the order of factors matter</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm_fit_01)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: yield
            Df  Sum Sq Mean Sq F value    Pr(&gt;F)    
nf           5   23987  4797.4  12.396 6.075e-12 ***
Residuals 3437 1330110   387.0                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm_fit_02)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: yield
            Df  Sum Sq Mean Sq F value   Pr(&gt;F)    
nf           5   23987  4797.4 12.4011 6.01e-12 ***
rep          2    1271   635.6  1.6429   0.1936    
Residuals 3435 1328839   386.9                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm_fit_03)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: yield
            Df  Sum Sq Mean Sq  F value    Pr(&gt;F)    
nf           5   23987    4797  13.3771 6.105e-13 ***
rep          2    1271     636   1.7722    0.1701    
year         1   97313   97313 271.3489 &lt; 2.2e-16 ***
Residuals 3434 1231526     359                       
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm_fit_04)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: yield
            Df Sum Sq Mean Sq   F value  Pr(&gt;F)    
nf           5  23987    4797   28.1331 &lt; 2e-16 ***
rep          2   1271     636    3.7272 0.02416 *  
year         1  97313   97313  570.6692 &lt; 2e-16 ***
topo         3 646456  215485 1263.6625 &lt; 2e-16 ***
Residuals 3431 585070     171                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(lm_fit_05)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: yield
            Df Sum Sq Mean Sq  F value    Pr(&gt;F)    
nf           5  23987    4797   28.133 &lt; 2.2e-16 ***
year         1  97321   97321  570.714 &lt; 2.2e-16 ***
topo         3 643667  214556 1258.209 &lt; 2.2e-16 ***
rep          2   4053    2027   11.885 7.183e-06 ***
Residuals 3431 585070     171                       
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># For the Anova(type=3), the order of factors doesn't matter</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(lm_fit_01, <span class="at">type =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: yield
             Sum Sq   Df  F value    Pr(&gt;F)    
(Intercept) 2418907    1 6250.447 &lt; 2.2e-16 ***
nf            23987    5   12.396 6.075e-12 ***
Residuals   1330110 3437                       
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(lm_fit_02, <span class="at">type =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: yield
             Sum Sq   Df   F value    Pr(&gt;F)    
(Intercept) 1800690    1 4654.7170 &lt; 2.2e-16 ***
nf            23987    5   12.4012 6.009e-12 ***
rep            1271    2    1.6429    0.1936    
Residuals   1328839 3435                        
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(lm_fit_03, <span class="at">type =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: yield
             Sum Sq   Df  F value    Pr(&gt;F)    
(Intercept)   96132    1 268.0552 &lt; 2.2e-16 ***
nf            23836    5  13.2930 7.436e-13 ***
rep            1264    2   1.7616    0.1719    
year          97313    1 271.3489 &lt; 2.2e-16 ***
Residuals   1231526 3434                       
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(lm_fit_04, <span class="at">type =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: yield
            Sum Sq   Df  F value    Pr(&gt;F)    
(Intercept) 119183    1  698.920 &lt; 2.2e-16 ***
nf           21727    5   25.483 &lt; 2.2e-16 ***
rep           4053    2   11.885 7.183e-06 ***
year        120660    1  707.584 &lt; 2.2e-16 ***
topo        646456    3 1263.662 &lt; 2.2e-16 ***
Residuals   585070 3431                       
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(lm_fit_05, <span class="at">type =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: yield
            Sum Sq   Df  F value    Pr(&gt;F)    
(Intercept) 119183    1  698.920 &lt; 2.2e-16 ***
nf           21727    5   25.483 &lt; 2.2e-16 ***
year        120660    1  707.584 &lt; 2.2e-16 ***
topo        646456    3 1263.662 &lt; 2.2e-16 ***
rep           4053    2   11.885 7.183e-06 ***
Residuals   585070 3431                       
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>In agricultural research, Type III Sum of Squares is particularly useful for unbalanced designs, such as field trials with missing data or unequal replications.</p>
</section>
</section>
<section id="post-hoc-tests" class="level3" data-number="4.6">
<h3 data-number="4.6" class="anchored" data-anchor-id="post-hoc-tests"><span class="header-section-number">4.6</span> Post-hoc Tests</h3>
<p>After detecting significant differences with ANOVA, post-hoc tests can be conducted to identify specific group differences.</p>
<p>Using <code>multcomp</code> for multiple comparisons:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using glht() function</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>comp <span class="ot">&lt;-</span> <span class="fu">glht</span>(aov_fit, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">nf =</span> <span class="st">"Tukey"</span>))</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(comp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Tukey Contrasts


Fit: aov(formula = yield ~ nf + year + topo + rep, data = data_corn)

Linear Hypotheses:
             Estimate Std. Error t value Pr(&gt;|t|)    
N1 - N0 == 0   3.8048     0.7702   4.940  &lt; 0.001 ***
N2 - N0 == 0   4.8232     0.7722   6.246  &lt; 0.001 ***
N3 - N0 == 0   5.0724     0.7709   6.580  &lt; 0.001 ***
N4 - N0 == 0   7.4876     0.7718   9.701  &lt; 0.001 ***
N5 - N0 == 0   7.3672     0.7709   9.556  &lt; 0.001 ***
N2 - N1 == 0   1.0184     0.7708   1.321  0.77334    
N3 - N1 == 0   1.2676     0.7696   1.647  0.56709    
N4 - N1 == 0   3.6828     0.7705   4.779  &lt; 0.001 ***
N5 - N1 == 0   3.5624     0.7697   4.628  &lt; 0.001 ***
N3 - N2 == 0   0.2492     0.7716   0.323  0.99954    
N4 - N2 == 0   2.6644     0.7726   3.449  0.00759 ** 
N5 - N2 == 0   2.5440     0.7717   3.297  0.01271 *  
N4 - N3 == 0   2.4152     0.7712   3.132  0.02173 *  
N5 - N3 == 0   2.2948     0.7702   2.980  0.03452 *  
N5 - N4 == 0  -0.1204     0.7712  -0.156  0.99999    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- single-step method)</code></pre>
</div>
</div>
</section>
<section id="nonlinear-models" class="level3" data-number="4.7">
<h3 data-number="4.7" class="anchored" data-anchor-id="nonlinear-models"><span class="header-section-number">4.7</span> Nonlinear Models</h3>
<p>Nonlinear models are useful when the relationship between the predictor and response variables is not linear. In agricultural research, these models are commonly used to model yield response to inputs, such as nitrogen fertilizer.</p>
<p>For nonlinear relationships, we could use <code>nls()</code>. Let’s see an example using a power function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>nls_fit <span class="ot">&lt;-</span> <span class="fu">nls</span>(yield <span class="sc">~</span> a <span class="sc">*</span> nitro<span class="sc">^</span>b, <span class="at">data =</span> data_corn, <span class="at">start =</span> <span class="fu">list</span>(<span class="at">a =</span> <span class="dv">1</span>, <span class="at">b =</span> <span class="dv">1</span>))</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(nls_fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Formula: yield ~ a * nitro^b

Parameters:
  Estimate Std. Error t value Pr(&gt;|t|)    
a 55.71689    4.33102  12.865  &lt; 2e-16 ***
b  0.05641    0.01811   3.116  0.00185 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 32.99 on 3441 degrees of freedom

Number of iterations to convergence: 15 
Achieved convergence tolerance: 1.822e-07</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative exponential</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="co"># nls_mitscherlich &lt;- nls(yield ~ a * (1 - exp(-b * nitro)), data = data_corn, start = list(a = 55, b = 0.05))</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Visualizing the model’s predictions can help in understanding the fitted curve and the data’s behavior.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a data frame with predictions</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>data_corn <span class="ot">&lt;-</span> data_corn <span class="sc">%&gt;%</span> </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pred =</span> <span class="fu">predict</span>(nls_fit))</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting observed vs. predicted yield</span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>data_corn <span class="sc">%&gt;%</span> </span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> nitro, <span class="at">y =</span> yield)) <span class="sc">+</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">color =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># Observed data</span></span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pred), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">size =</span> <span class="dv">1</span>) <span class="sc">+</span>  <span class="co"># Fitted curve</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>()<span class="sc">+</span></span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Yield Response to Nitrogen"</span>,</span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">"Nitrogen (kg/ha)"</span>,</span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Yield (qq/ha)"</span>) <span class="sc">+</span></span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="models_01_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="conclusion" class="level2" data-number="5">
<h2 data-number="5" class="anchored" data-anchor-id="conclusion"><span class="header-section-number">5</span> Conclusion</h2>
<p>This lesson introduced essential statistical models in R for agricultural research, providing practical code examples. In the next session, we will delve deeper into model diagnostics and interpretation.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/adriancorrendo\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><span> Developed by Adrian Correndo with <a href="https://quarto.org/">Quarto</a>. License: <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC BY-SA 2.0</a>. </span></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>