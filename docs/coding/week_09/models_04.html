<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Dr.&nbsp;Adrian Correndo">
<meta name="dcterms.date" content="2025-03-07">

<title>Models IV: Mixed Models I – PLNT6800 - Winter 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../outline/calendar.html" rel="next">
<link href="../../coding/week_09/models_03.html" rel="prev">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-f2a1071e85750ec973bbb8a8f120da0f.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-f2a1071e85750ec973bbb8a8f120da0f.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-e759c8361f0112bf6e2955a60a6c0828.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-5ccce6f18d703cb4568c738a25a74289.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<style>html{ scroll-behavior: smooth; }</style>
<script src="../../site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="../../site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="../../site_libs/quarto-diagram/mermaid.css" rel="stylesheet">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Models IV: Mixed Models I – PLNT6800 - Winter 2025">
<meta property="og:description" content="This tutorial provides a workflow to analyze two very common types of mixed models data in agriculture: Blocks and Split-Plots.">
<meta property="og:image" content="https://adriancorrendo.github.io/coding/week_09/models_04_files/figure-html/sp_ggplot-1.png">
<meta property="og:site_name" content="PLNT6800 - Winter 2025">
<meta property="og:image:height" content="960">
<meta property="og:image:width" content="1344">
<meta name="twitter:title" content="Models IV: Mixed Models I – PLNT6800 - Winter 2025">
<meta name="twitter:description" content="This tutorial provides a workflow to analyze two very common types of mixed models data in agriculture: Blocks and Split-Plots.">
<meta name="twitter:image" content="https://adriancorrendo.github.io/coding/week_09/models_04_files/figure-html/sp_ggplot-1.png">
<meta name="twitter:creator" content="@aacorrendo">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1344">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">PLNT6800 - Winter 2025</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://adriancorrendo.github.io/"> <i class="bi bi-globe" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/adriancorrendo/plnt6800/"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/aacorrendo"> <i class="bi bi-twitter" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/adriancorrendo/"> <i class="bi bi-linkedin" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../coding/week_01/essentials_01.html">Lessons</a></li><li class="breadcrumb-item"><a href="../../coding/week_09/models_04.html">15-Models IV</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../images/plnt6800_logo.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main">
    <a href="https://github.com/adriancorrendo/" title="" class="quarto-navigation-tool px-1" aria-label=""><i class="bi bi-github"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Slides</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../slides/day1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Reproducibility</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">Software</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../software/software.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Instructions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Lessons</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_01/essentials_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01-Essentials of R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_02/02_fundamentals_rpackages.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02-Fundamentals of packages</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_02/03_versioncontrol.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03-Git &amp; GitHub</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_03/04_datawrangling_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04-Data Wrangling I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_03/05_datawrangling_02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05-Data Wrangling II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_04/06_datawrangling_03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">06-Data Wrangling III</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_04/07_ggplot2_intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">07-Data viz I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_05/08_ggplot2_adv.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">08-Data viz II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_05/09_ggplot2_plus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">09-Data viz III</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_06/10_iteration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">10-Iteration</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_06/11_weather.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11-Weather data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_08/models_01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">12-Models I</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_08/models_02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">13-Models II</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_09/models_03.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">14-Models III</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../coding/week_09/models_04.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">15-Models IV</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">Calendar</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../outline/calendar.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">Course Outline</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../outline/outline.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Outline</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Content</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#what-are-mixed-models" id="toc-what-are-mixed-models" class="nav-link" data-scroll-target="#what-are-mixed-models"><span class="header-section-number">2</span> What are Mixed Models?</a></li>
  <li><a href="#required-packages-for-today" id="toc-required-packages-for-today" class="nav-link" data-scroll-target="#required-packages-for-today"><span class="header-section-number">3</span> Required packages for today</a></li>
  <li><a href="#what-is-a-design-in-blocks" id="toc-what-is-a-design-in-blocks" class="nav-link" data-scroll-target="#what-is-a-design-in-blocks"><span class="header-section-number">4</span> What is a design in Blocks?</a>
  <ul>
  <li><a href="#corn-data" id="toc-corn-data" class="nav-link" data-scroll-target="#corn-data"><span class="header-section-number">4.1</span> Corn Data</a></li>
  <li><a href="#block-as-fixed" id="toc-block-as-fixed" class="nav-link" data-scroll-target="#block-as-fixed"><span class="header-section-number">4.2</span> Block as Fixed</a></li>
  <li><a href="#block-as-random" id="toc-block-as-random" class="nav-link" data-scroll-target="#block-as-random"><span class="header-section-number">4.3</span> Block as Random</a>
  <ul class="collapse">
  <li><a href="#nlme" id="toc-nlme" class="nav-link" data-scroll-target="#nlme"><span class="header-section-number">4.3.1</span> nlme</a></li>
  <li><a href="#lme4" id="toc-lme4" class="nav-link" data-scroll-target="#lme4"><span class="header-section-number">4.3.2</span> lme4</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#what-is-a-split-plot" id="toc-what-is-a-split-plot" class="nav-link" data-scroll-target="#what-is-a-split-plot"><span class="header-section-number">5</span> What is a SPLIT-PLOT?</a>
  <ul>
  <li><a href="#create-a-split-plot-design" id="toc-create-a-split-plot-design" class="nav-link" data-scroll-target="#create-a-split-plot-design"><span class="header-section-number">5.1</span> Create a split-plot design</a></li>
  <li><a href="#split-plot-as-a-mixed-model" id="toc-split-plot-as-a-mixed-model" class="nav-link" data-scroll-target="#split-plot-as-a-mixed-model"><span class="header-section-number">5.2</span> Split-Plot as a Mixed Model</a></li>
  <li><a href="#data" id="toc-data" class="nav-link" data-scroll-target="#data"><span class="header-section-number">5.3</span> Data</a></li>
  <li><a href="#explore-the-data" id="toc-explore-the-data" class="nav-link" data-scroll-target="#explore-the-data"><span class="header-section-number">5.4</span> Explore the data</a>
  <ul class="collapse">
  <li><a href="#glimpse" id="toc-glimpse" class="nav-link" data-scroll-target="#glimpse"><span class="header-section-number">5.4.1</span> glimpse()</a></li>
  <li><a href="#skim" id="toc-skim" class="nav-link" data-scroll-target="#skim"><span class="header-section-number">5.4.2</span> skim()</a></li>
  <li><a href="#ggplot" id="toc-ggplot" class="nav-link" data-scroll-target="#ggplot"><span class="header-section-number">5.4.3</span> ggplot()</a></li>
  </ul></li>
  <li><a href="#models" id="toc-models" class="nav-link" data-scroll-target="#models"><span class="header-section-number">5.5</span> Models</a>
  <ul class="collapse">
  <li><a href="#nlmelme" id="toc-nlmelme" class="nav-link" data-scroll-target="#nlmelme"><span class="header-section-number">5.5.1</span> nlme::lme</a></li>
  <li><a href="#lmer-code-lme4" id="toc-lmer-code-lme4" class="nav-link" data-scroll-target="#lmer-code-lme4"><span class="header-section-number">5.5.2</span> lmer code (lme4)</a></li>
  </ul></li>
  <li><a href="#check-assumptions" id="toc-check-assumptions" class="nav-link" data-scroll-target="#check-assumptions"><span class="header-section-number">5.6</span> Check assumptions</a></li>
  <li><a href="#comparisons" id="toc-comparisons" class="nav-link" data-scroll-target="#comparisons"><span class="header-section-number">5.7</span> Comparisons</a></li>
  </ul></li>
  <li><a href="#split-split-plot" id="toc-split-split-plot" class="nav-link" data-scroll-target="#split-split-plot"><span class="header-section-number">6</span> Split-split plot</a>
  <ul>
  <li><a href="#data-1" id="toc-data-1" class="nav-link" data-scroll-target="#data-1"><span class="header-section-number">6.1</span> Data</a>
  <ul class="collapse">
  <li><a href="#details" id="toc-details" class="nav-link" data-scroll-target="#details"><span class="header-section-number">6.1.1</span> Details</a></li>
  </ul></li>
  <li><a href="#models-1" id="toc-models-1" class="nav-link" data-scroll-target="#models-1"><span class="header-section-number">6.2</span> Models</a>
  <ul class="collapse">
  <li><a href="#nlme-1" id="toc-nlme-1" class="nav-link" data-scroll-target="#nlme-1"><span class="header-section-number">6.2.1</span> nlme</a></li>
  <li><a href="#lme4-1" id="toc-lme4-1" class="nav-link" data-scroll-target="#lme4-1"><span class="header-section-number">6.2.2</span> lme4</a></li>
  </ul></li>
  <li><a href="#comparisons-1" id="toc-comparisons-1" class="nav-link" data-scroll-target="#comparisons-1"><span class="header-section-number">6.3</span> Comparisons</a></li>
  </ul></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../coding/week_01/essentials_01.html">Lessons</a></li><li class="breadcrumb-item"><a href="../../coding/week_09/models_04.html">15-Models IV</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Models IV: Mixed Models I</h1>
  <div class="quarto-categories">
    <div class="quarto-category">linear models</div>
    <div class="quarto-category">R</div>
    <div class="quarto-category">statistics</div>
    <div class="quarto-category">agriculture</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Dr.&nbsp;Adrian Correndo </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">March 7, 2025</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Summary</div>
    This tutorial provides a workflow to analyze two very common types of mixed models data in agriculture: Blocks and Split-Plots.
  </div>
</div>


</header>


<section id="introduction" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction</h1>
<p>After planning the experimental design, identifying dependent variable, independent variable(s), conducting the experiment, and collecting the data…the expected path would be as follows:</p>
<div class="cell" data-layout-align="default">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>flowchart LR</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  A[Dig the data] --&gt; B{Model Selection}</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  B --&gt; C[Significant\nEffects?]</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  subgraph Inference</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  C --&gt;|Yes| D[Comparisons]</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  end</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">flowchart LR
  A[Dig the data] --&gt; B{Model Selection}
  B --&gt; C[Significant\nEffects?]
  subgraph Inference
  C --&gt;|Yes| D[Comparisons]
  end
  
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
</section>
<section id="what-are-mixed-models" class="level1" data-number="2">
<h1 data-number="2"><span class="header-section-number">2</span> What are Mixed Models?</h1>
<p>In simple words, the rationale behind mixed models is the simultaneous presence of components that model the EXPECTED VALUE (fixed) as well as the VARIANCE (random).</p>
<p>Specifically, today we are going to cover LINEAR MIXED MODELS, which make the following assumptions <span class="citation" data-cites="Bolker_etal_2022">(<a href="#ref-Bolker_etal_2022" role="doc-biblioref">Bolker et al. 2022</a>)</span>:</p>
<ul>
<li><p>The <strong>expected values</strong> of the responses are <strong>linear combinations</strong> of the fixed predictor variables and the random effects.</p></li>
<li><p>The conditional distribution of the variable response is Gaussian (equivalently, the errors are “Normal”).</p></li>
<li><p>The random effects are normally distributed. Normally, we assume that the expected value of a random effect is equal to zero, but with a positive variance.</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>We are going to employ the most used packages and/or functions for <code>frequentist</code> LMMs:</p>
<ul>
<li><strong>nlme</strong>: nlme::lme() provides REML or ML estimation. Allows multiple nested random effects, and provides structures for modeling heteroscedastic and/or correlated errors (spoiler for repeated measures analysis). This is already part of base R.</li>
<li><strong>lme4</strong>: lmer4::lmer() provides REML or ML estimation. Allows multiple nested or crossed random effects, can compute profile confidence intervals and conduct parametric bootstrapping.</li>
</ul>
</div>
</div>
<p>For more information about mixed models in R, please, check out the new <a href="https://cran.r-project.org/web/views/MixedModels.html">CRAN Task View: Mixed, Multilevel, and Hierarchical Models in R</a>.</p>
<p>This workflow has been created using <a href="https://mermaid-js.github.io/mermaid/#/">mermaid</a></p>
</section>
<section id="required-packages-for-today" class="level1" data-number="3">
<h1 data-number="3"><span class="header-section-number">3</span> Required packages for today</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pacman)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(<span class="st">"readxl"</span>) <span class="co"># To open/save excel files</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(<span class="st">'dplyr'</span>, <span class="st">"tidyr"</span>,<span class="st">"purrr"</span>, <span class="st">"forcats"</span>, <span class="st">"stringr"</span>) <span class="co"># Data wrangling</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(<span class="st">"nlme"</span>, <span class="st">"lme4"</span>) <span class="co"># Mixed models libraries</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(<span class="st">"broom"</span>, <span class="st">"broom.mixed"</span>) <span class="co"># Managing models results</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(<span class="st">"performance"</span>) <span class="co"># Check assumptions and performance</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(<span class="st">"emmeans"</span>,<span class="st">"multcomp"</span>,<span class="st">"multcompView"</span>,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>         <span class="st">"car"</span>, <span class="st">"multilevelmod"</span>) <span class="co"># Aov and mult comp</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(<span class="st">"ggplot2"</span>) <span class="co"># Figures</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(<span class="st">"agricolae"</span>) <span class="co"># Miscellaneous functions</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="fu">p_load</span>(<span class="st">"agridat"</span>) <span class="co"># For data</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Among many packages we are going to use today, there is one from the <a href="https://www.tidymodels.org/">tidymodels family</a> that was specially designed to convert statistical objects into tidy format: the <em>broom</em> package <span class="citation" data-cites="broom">(<a href="#ref-broom" role="doc-biblioref">Robinson, Hayes, and Couch 2022</a>)</span>. Particularly for mixed models, we will also need its <code>spinoff</code>: the <em>broom.mixed</em> package <span class="citation" data-cites="broom.mixed">(<a href="#ref-broom.mixed" role="doc-biblioref">Bolker and Robinson 2022</a>)</span> .</p>
<p>The broom package offer three key functions to manipulate models’ outcomes:</p>
<ul>
<li><p><code>glance()</code> to report information about the entire model</p></li>
<li><p><code>tidy()</code> to summarize information about model components, and</p></li>
<li><p><code>augment()</code> to add information about observations to a dataset</p></li>
</ul>
</section>
<section id="what-is-a-design-in-blocks" class="level1" data-number="4">
<h1 data-number="4"><span class="header-section-number">4</span> What is a design in Blocks?</h1>
<section id="corn-data" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="corn-data"><span class="header-section-number">4.1</span> Corn Data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>data_corn <span class="ot">&lt;-</span> agridat<span class="sc">::</span>lasrosas.corn</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>First, the most important step is ALWAYS to write down the model.</p>
</section>
<section id="block-as-fixed" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="block-as-fixed"><span class="header-section-number">4.2</span> Block as Fixed</h2>
<p>In a traditional approach blocks are defined as fixed, affecting the mean of the expected value. Yet there is no consensus about treating blocks as fixed or as random. For more information, read <span class="citation" data-cites="Dixon_2016">Dixon (<a href="#ref-Dixon_2016" role="doc-biblioref">2016</a>)</span>.</p>
<p>Let’s define the model. For simplification (and avoid writing interaction terms), here we are going to consider that <span class="math inline">\(\tau_i\)</span> is the “treatment”.</p>
<p><span class="math display">\[ y_{ij} = \mu + \tau_i + \beta_j + \epsilon_{ij} \]</span></p>
<p><span class="math display">\[ \epsilon_{ij} \sim N(0, \sigma^2_{e} )\]</span> where <span class="math inline">\(\mu\)</span> represents the overall mean (if intercept is used), <span class="math inline">\(\tau_i\)</span> is the effect of treatment-j over <span class="math inline">\(\mu\)</span>, <span class="math inline">\(\beta_j\)</span> is the effect of block-j over <span class="math inline">\(\mu\)</span>, and <span class="math inline">\(\epsilon_{ij}\)</span> is the random effect of each experimental unit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SIMPLEST MODEL</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>block_fixed <span class="ot">&lt;-</span> <span class="fu">lm</span>(</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Response variable</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  yield <span class="sc">~</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fixed</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    nf <span class="sc">+</span> rep,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Data</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> data_corn)</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(block_fixed, <span class="at">type=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Anova Table (Type III tests)

Response: yield
             Sum Sq   Df   F value    Pr(&gt;F)    
(Intercept) 1800690    1 4654.7170 &lt; 2.2e-16 ***
nf            23987    5   12.4012 6.009e-12 ***
rep            1271    2    1.6429    0.1936    
Residuals   1328839 3435                        
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="block-as-random" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="block-as-random"><span class="header-section-number">4.3</span> Block as Random</h2>
<p>An alternative approach is considering a MIXED MODEL, where blocks are considered “random”. Basically, we add a term to the model that it is expected to show a “null” overall effect over the mean of the variable of interest but introduces “noise”. By convention, a random effect is expected to have an expected value equal to zero but a positive variance as follows: <span class="math display">\[ y_{ij} = \mu + \tau_i + \beta_j + \epsilon_{ij} \]</span> <span class="math display">\[ \beta_j \sim N(0, \sigma^2_{b} )\]</span> <span class="math display">\[ \epsilon_{ij} \sim N(0, \sigma^2_{e} )\]</span> Similar than before, <span class="math inline">\(\mu\)</span> represents the overall mean (if intercept is used), <span class="math inline">\(\tau_i\)</span> is the effect of treatment-j over <span class="math inline">\(\mu\)</span>, <span class="math inline">\(\beta_j\)</span> is the “random” effect of block-j over <span class="math inline">\(\mu\)</span>, and <span class="math inline">\(\epsilon_{ij}\)</span> is the random effect of each experimental unit.</p>
<p>So what’s the difference? Simply specifying this component: <span class="math display">\[ \beta_j \sim N(0, \sigma^2_b) \]</span>, which serves to model the variance.</p>
<p>How do we write that?</p>
<section id="nlme" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="nlme"><span class="header-section-number">4.3.1</span> nlme</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RANDOM BLOCK</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>block_random_nlme <span class="ot">&lt;-</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  nlme<span class="sc">::</span><span class="fu">lme</span>(</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Fixed</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>    yield <span class="sc">~</span> nf,</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Random</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>rep,</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Data</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> data_corn)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(block_random_nlme, <span class="at">type=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III tests)

Response: yield
               Chisq Df Pr(&gt;Chisq)    
(Intercept) 5648.401  1  &lt; 2.2e-16 ***
nf            62.005  5  4.677e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="lme4" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="lme4"><span class="header-section-number">4.3.2</span> lme4</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># RANDOM BLOCK</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>block_random_lme4 <span class="ot">&lt;-</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  lme4<span class="sc">::</span><span class="fu">lmer</span>(<span class="co"># Response variable</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>                   yield <span class="sc">~</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Fixed (Removing intercept? Why?)</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>                   nf <span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Random</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>                   (<span class="dv">1</span><span class="sc">|</span>rep), </span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Data</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data=</span>data_corn)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(block_random_lme4, <span class="at">type=</span><span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III Wald chisquare tests)

Response: yield
               Chisq Df Pr(&gt;Chisq)    
(Intercept) 5648.406  1  &lt; 2.2e-16 ***
nf            62.005  5  4.677e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
</section>
</section>
<section id="what-is-a-split-plot" class="level1" data-number="5">
<h1 data-number="5"><span class="header-section-number">5</span> What is a SPLIT-PLOT?</h1>
<p>Split-plot arrangement is frequently used in experiments including several factors (factorial). The main characteristic is that the arrangement follows a hierarchy: there are main plots (a.k.a. whole plots) covering one of the factors, and then there are “subplots” within each level of the main that include levels of a second factor, and so on. Therefore, the main plot serves as a “block” for the subplots, and thus, we are setting boundaries to (“restricting”) the randomization of the subplot factor.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p><strong>DESIGN</strong>: We intentionally call split-plot “arrangement” because they can fit into multiple “designs” such as completely randomized (CRD), randomized complete blocks design (RCBD), or latin-squares design (LSD).</p></li>
<li><p><strong>INFERENCE POWER</strong>: What happens with split-plot design is that the main plot has less degrees of freedom than the factor at the subplot, and thus, we have more inference power at the factor in the subplot hierarchy (and the interaction). So consider this before it’s too late!</p></li>
</ul>
</div>
</div>
<section id="create-a-split-plot-design" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="create-a-split-plot-design"><span class="header-section-number">5.1</span> Create a split-plot design</h2>
<p>The <em>agricolae</em> package <span class="citation" data-cites="agricolae">(<a href="#ref-agricolae" role="doc-biblioref">Mendiburu 2021</a>)</span> brings a set of very useful functions to generate different experimental designs, among them, the split-plot. Let’s see an example:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example with agricolae</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Define plots</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>mainplot <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="dv">80</span>,<span class="dv">110</span>,<span class="dv">140</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>subplot <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Var_1"</span>, <span class="st">"Var_2"</span>, <span class="st">"Var_3"</span>)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Produce</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>sp_design <span class="ot">&lt;-</span> agricolae<span class="sc">::</span><span class="fu">design.split</span>(</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>                        <span class="at">trt1 =</span> mainplot, <span class="at">trt2 =</span> subplot, </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">design =</span> <span class="st">"rcbd"</span>, <span class="at">r =</span> <span class="dv">3</span>, </span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">randomization =</span> <span class="cn">TRUE</span>, <span class="at">seed =</span> <span class="dv">4561</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co">#View(sp_design)</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="co">#View(sp_design$book)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="split-plot-as-a-mixed-model" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="split-plot-as-a-mixed-model"><span class="header-section-number">5.2</span> Split-Plot as a Mixed Model</h2>
<p>When moving to a Split-Plot design, an additional source of error is introduced: Main plot error (^2_m), which accounts for variation among the whole plots within each block.</p>
<p><span class="math display">\[y_{ijk} = \mu + \alpha_i + \tau_k + (\alpha\tau){ik} + \beta_j + \gamma{ij} + \epsilon_{ijk}\]</span></p>
<p>where: <span class="math inline">\(\alpha_i\)</span> = Fixed effect of the main-plot factor (e.g., tillage), <span class="math inline">\(\tau_k\)</span> = Fixed effect of the subplot factor (e.g., nitrogen rate), <span class="math inline">\((\alpha\tau)_{ik}\)</span> = Fixed interaction effect between main and subplot factors, <span class="math inline">\(\beta_j \sim N(0, \sigma^2_b)\)</span> = Random effect of block, <span class="math inline">\(\gamma_{ij} \sim N(0, \sigma^2_m)\)</span> = Random effect of main plot within block (main-plot error), <span class="math inline">\(\epsilon_{ijk} \sim N(0, \sigma^2_e)\)</span> = Random error of experimental unit.</p>
<p>Thus, three sources of variability are modeled: 1. Block-to-block variation → <span class="math inline">\(\sigma^2_b\)</span> 2. Main-plot variation (whole plot error) → <span class="math inline">\(\sigma^2_m\)</span> 3. Residual variation (subplot error) → <span class="math inline">\(\sigma^2_e\)</span></p>
</section>
<section id="data" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="data"><span class="header-section-number">5.3</span> Data</h2>
<p>The following is just a fake data set where we have a split-splot arrangement within an RCBD (BLOCK), where at the main plot corresponds to nitrogen rate (NRATE, with 5 levels), and the subplot to wheat variety (VARIETY, with 3 levels).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Read csv</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="co">#split_plot_data_0 &lt;- read.csv(file = "../data/01_split_plot_data.csv", header = TRUE)</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="co"># File online? Try this...(remove "#")</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>url_split <span class="ot">&lt;-</span> <span class="st">"https://raw.githubusercontent.com/adriancorrendo/tidymixedmodelsweb/master/data/01_split_plot_data.csv"</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>split_plot_data_0 <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(url_split)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Data hierarchy</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>split_plot_data <span class="ot">&lt;-</span> </span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  split_plot_data_0 <span class="sc">%&gt;%</span> </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">NRATE =</span> <span class="fu">factor</span>(NRATE)) <span class="sc">%&gt;%</span> </span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Identify Main Plot</span></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>  <span class="co">#mutate(main = factor(BLOCK:NRATE)) %&gt;% </span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(BLOCK, NRATE, VARIETY, YIELD)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a><span class="co">#View(split_plot_data)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="explore-the-data" class="level2" data-number="5.4">
<h2 data-number="5.4" class="anchored" data-anchor-id="explore-the-data"><span class="header-section-number">5.4</span> Explore the data</h2>
<p>Now, let’s use several functions to explore the data.</p>
<section id="glimpse" class="level3" data-number="5.4.1">
<h3 data-number="5.4.1" class="anchored" data-anchor-id="glimpse"><span class="header-section-number">5.4.1</span> glimpse()</h3>
<p>For example, the <code>glimpse()</code> function from the dplyr package <span class="citation" data-cites="dplyr">(<a href="#ref-dplyr" role="doc-biblioref">Wickham et al. 2022</a>)</span> allows to take a quick look to the columns in our data frame (it’s like a transposed version of <code>print()</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Glimpse from dplyr</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>dplyr<span class="sc">::</span><span class="fu">glimpse</span>(split_plot_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 45
Columns: 4
$ BLOCK   &lt;chr&gt; "B1", "B1", "B1", "B1", "B1", "B1", "B1", "B1", "B1", "B1", "B…
$ NRATE   &lt;fct&gt; 0, 0, 0, 50, 50, 50, 80, 80, 80, 110, 110, 110, 140, 140, 140,…
$ VARIETY &lt;chr&gt; "Var_1", "Var_2", "Var_3", "Var_1", "Var_2", "Var_3", "Var_1",…
$ YIELD   &lt;int&gt; 1938, 3946, 4628, 2038, 4346, 5949, 3837, 4287, 6765, 3466, 49…</code></pre>
</div>
</div>
</section>
<section id="skim" class="level3" data-number="5.4.2">
<h3 data-number="5.4.2" class="anchored" data-anchor-id="skim"><span class="header-section-number">5.4.2</span> skim()</h3>
<p>Then, the <code>skim()</code> function from the skimr package <span class="citation" data-cites="skimr">(<a href="#ref-skimr" role="doc-biblioref">Waring et al. 2022</a>)</span> allows to take a deeper look to all the variables (columns), creating a quick summary that reports the presence of missing values, etc., etc.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Skim from skimr</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>skimr<span class="sc">::</span><span class="fu">skim</span>(split_plot_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Data summary</caption>
<tbody>
<tr class="odd">
<td style="text-align: left;">Name</td>
<td style="text-align: left;">split_plot_data</td>
</tr>
<tr class="even">
<td style="text-align: left;">Number of rows</td>
<td style="text-align: left;">45</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Number of columns</td>
<td style="text-align: left;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">_______________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="odd">
<td style="text-align: left;">Column type frequency:</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">character</td>
<td style="text-align: left;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">factor</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">numeric</td>
<td style="text-align: left;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">________________________</td>
<td style="text-align: left;"></td>
</tr>
<tr class="even">
<td style="text-align: left;">Group variables</td>
<td style="text-align: left;">None</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: character</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 19%">
<col style="width: 13%">
<col style="width: 19%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 8%">
<col style="width: 12%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">min</th>
<th style="text-align: right;">max</th>
<th style="text-align: right;">empty</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: right;">whitespace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">BLOCK</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">VARIETY</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: factor</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 17%">
<col style="width: 12%">
<col style="width: 17%">
<col style="width: 9%">
<col style="width: 10%">
<col style="width: 32%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: left;">ordered</th>
<th style="text-align: right;">n_unique</th>
<th style="text-align: left;">top_counts</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">NRATE</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">FALSE</td>
<td style="text-align: right;">5</td>
<td style="text-align: left;">0: 9, 50: 9, 80: 9, 110: 9</td>
</tr>
</tbody>
</table>
<p><strong>Variable type: numeric</strong></p>
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 16%">
<col style="width: 11%">
<col style="width: 16%">
<col style="width: 9%">
<col style="width: 9%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 7%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">skim_variable</th>
<th style="text-align: right;">n_missing</th>
<th style="text-align: right;">complete_rate</th>
<th style="text-align: right;">mean</th>
<th style="text-align: right;">sd</th>
<th style="text-align: right;">p0</th>
<th style="text-align: right;">p25</th>
<th style="text-align: right;">p50</th>
<th style="text-align: right;">p75</th>
<th style="text-align: right;">p100</th>
<th style="text-align: left;">hist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">YIELD</td>
<td style="text-align: right;">0</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4444.02</td>
<td style="text-align: right;">1347.72</td>
<td style="text-align: right;">1938</td>
<td style="text-align: right;">3389</td>
<td style="text-align: right;">4458</td>
<td style="text-align: right;">5440</td>
<td style="text-align: right;">6950</td>
<td style="text-align: left;">▅▆▇▆▅</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="ggplot" class="level3" data-number="5.4.3">
<h3 data-number="5.4.3" class="anchored" data-anchor-id="ggplot"><span class="header-section-number">5.4.3</span> ggplot()</h3>
<p>Of course, we shouldn’t miss to use ggplot2 for a better look</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Boxplot</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>split_plot_data <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Boxplots</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> NRATE, <span class="at">y =</span> YIELD, <span class="at">fill =</span> VARIETY))<span class="sc">+</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="fu">aes</span>(<span class="at">x =</span> NRATE, <span class="at">y =</span> YIELD, <span class="at">fill =</span> VARIETY))<span class="sc">+</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Plot by site</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>VARIETY)<span class="sc">+</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10000</span>), <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">10000</span>, <span class="at">by=</span><span class="dv">2000</span>))<span class="sc">+</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Change theme</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="models_04_files/figure-html/sp_ggplot-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="models" class="level2" data-number="5.5">
<h2 data-number="5.5" class="anchored" data-anchor-id="models"><span class="header-section-number">5.5</span> Models</h2>
<p>For the analysis of split-plot designs we basically need to specify an error term that otherwise the model will not see: the MAIN PLOT ERROR TERM (see Venables and Ripley (2002), pg. 283). By default, the random term that the computer will identify is the one happening at the lowest level in the hierarchy (replication). However, we need to specify that the main plot serves as a kind of block to the design.</p>
<section id="nlmelme" class="level3" data-number="5.5.1">
<h3 data-number="5.5.1" class="anchored" data-anchor-id="nlmelme"><span class="header-section-number">5.5.1</span> nlme::lme</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model without split component</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>no_split <span class="ot">&lt;-</span> nlme<span class="sc">::</span><span class="fu">lme</span>(<span class="co"># Response variable</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                 YIELD <span class="sc">~</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Fixed</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">0</span> <span class="sc">+</span> NRATE<span class="sc">*</span>VARIETY,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Random error of MAINPLOT (NRATE nested in BLOCK)</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>BLOCK, </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Data</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> split_plot_data,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Method</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"REML"</span>)</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Model with split component</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>split_nlme <span class="ot">&lt;-</span> nlme<span class="sc">::</span><span class="fu">lme</span>(<span class="co"># Response variable</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>                 YIELD <span class="sc">~</span></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Fixed (Removing intercept? Why?)</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">0</span> <span class="sc">+</span> NRATE<span class="sc">*</span>VARIETY,</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Random error of MAINPLOT (NRATE nested in BLOCK)</span></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>                   <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>BLOCK<span class="sc">/</span>NRATE, </span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Data</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> split_plot_data,</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Method</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"REML"</span>)</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Type 3 (when interaction is present)</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(split_nlme, <span class="at">type =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III tests)

Response: YIELD
                Chisq Df Pr(&gt;Chisq)    
NRATE         559.646  5  &lt; 2.2e-16 ***
VARIETY        22.128  2  1.567e-05 ***
NRATE:VARIETY  18.117  8    0.02036 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let's see the difference between models in terms of DFs</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(no_split)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by REML
  Data: split_plot_data 
       AIC     BIC    logLik
  511.0067 534.827 -238.5033

Random effects:
 Formula: ~1 | BLOCK
        (Intercept) Residual
StdDev:  0.02585478  521.401

Fixed effects:  YIELD ~ 0 + NRATE * VARIETY 
                         Value Std.Error DF   t-value p-value
NRATE0                2536.000  301.0310 28  8.424381  0.0000
NRATE50               2786.667  301.0310 28  9.257074  0.0000
NRATE80               3857.667  301.0310 28 12.814847  0.0000
NRATE110              3467.333  301.0310 28 11.518192  0.0000
NRATE140              3100.667  301.0310 28 10.300156  0.0000
VARIETYVar_2           649.667  425.7222 28  1.526034  0.1382
VARIETYVar_3          1965.333  425.7222 28  4.616469  0.0001
NRATE50:VARIETYVar_2   603.000  602.0621 28  1.001558  0.3251
NRATE80:VARIETYVar_2   104.000  602.0621 28  0.172740  0.8641
NRATE110:VARIETYVar_2  830.667  602.0621 28  1.379703  0.1786
NRATE140:VARIETYVar_2 1561.000  602.0621 28  2.592756  0.0150
NRATE50:VARIETYVar_3  1152.333  602.0621 28  1.913978  0.0659
NRATE80:VARIETYVar_3   763.667  602.0621 28  1.268419  0.2151
NRATE110:VARIETYVar_3 1033.000  602.0621 28  1.715770  0.0973
NRATE140:VARIETYVar_3  292.667  602.0621 28  0.486107  0.6307
 Correlation: 
                      NRATE0 NRATE50 NRATE80 NRATE110 NRATE140 VARIETYV_2
NRATE50                0.000                                             
NRATE80                0.000  0.000                                      
NRATE110               0.000  0.000   0.000                              
NRATE140               0.000  0.000   0.000   0.000                      
VARIETYVar_2          -0.707  0.000   0.000   0.000    0.000             
VARIETYVar_3          -0.707  0.000   0.000   0.000    0.000    0.500    
NRATE50:VARIETYVar_2   0.500 -0.500   0.000   0.000    0.000   -0.707    
NRATE80:VARIETYVar_2   0.500  0.000  -0.500   0.000    0.000   -0.707    
NRATE110:VARIETYVar_2  0.500  0.000   0.000  -0.500    0.000   -0.707    
NRATE140:VARIETYVar_2  0.500  0.000   0.000   0.000   -0.500   -0.707    
NRATE50:VARIETYVar_3   0.500 -0.500   0.000   0.000    0.000   -0.354    
NRATE80:VARIETYVar_3   0.500  0.000  -0.500   0.000    0.000   -0.354    
NRATE110:VARIETYVar_3  0.500  0.000   0.000  -0.500    0.000   -0.354    
NRATE140:VARIETYVar_3  0.500  0.000   0.000   0.000   -0.500   -0.354    
                      VARIETYV_3 NRATE50:VARIETYV_2 NRATE80:VARIETYV_2
NRATE50                                                               
NRATE80                                                               
NRATE110                                                              
NRATE140                                                              
VARIETYVar_2                                                          
VARIETYVar_3                                                          
NRATE50:VARIETYVar_2  -0.354                                          
NRATE80:VARIETYVar_2  -0.354      0.500                               
NRATE110:VARIETYVar_2 -0.354      0.500              0.500            
NRATE140:VARIETYVar_2 -0.354      0.500              0.500            
NRATE50:VARIETYVar_3  -0.707      0.500              0.250            
NRATE80:VARIETYVar_3  -0.707      0.250              0.500            
NRATE110:VARIETYVar_3 -0.707      0.250              0.250            
NRATE140:VARIETYVar_3 -0.707      0.250              0.250            
                      NRATE110:VARIETYV_2 NRATE140:VARIETYV_2
NRATE50                                                      
NRATE80                                                      
NRATE110                                                     
NRATE140                                                     
VARIETYVar_2                                                 
VARIETYVar_3                                                 
NRATE50:VARIETYVar_2                                         
NRATE80:VARIETYVar_2                                         
NRATE110:VARIETYVar_2                                        
NRATE140:VARIETYVar_2  0.500                                 
NRATE50:VARIETYVar_3   0.250               0.250             
NRATE80:VARIETYVar_3   0.250               0.250             
NRATE110:VARIETYVar_3  0.500               0.250             
NRATE140:VARIETYVar_3  0.250               0.500             
                      NRATE50:VARIETYV_3 NRATE80:VARIETYV_3 NRATE110:VARIETYV_3
NRATE50                                                                        
NRATE80                                                                        
NRATE110                                                                       
NRATE140                                                                       
VARIETYVar_2                                                                   
VARIETYVar_3                                                                   
NRATE50:VARIETYVar_2                                                           
NRATE80:VARIETYVar_2                                                           
NRATE110:VARIETYVar_2                                                          
NRATE140:VARIETYVar_2                                                          
NRATE50:VARIETYVar_3                                                           
NRATE80:VARIETYVar_3   0.500                                                   
NRATE110:VARIETYVar_3  0.500              0.500                                
NRATE140:VARIETYVar_3  0.500              0.500              0.500             

Standardized Within-Group Residuals:
       Min         Q1        Med         Q3        Max 
-1.9300562 -0.6188455  0.0428333  0.5702584  1.6941534 

Number of Observations: 45
Number of Groups: 3 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(split_nlme)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by REML
  Data: split_plot_data 
       AIC      BIC    logLik
  513.0067 538.2282 -238.5033

Random effects:
 Formula: ~1 | BLOCK
        (Intercept)
StdDev:  0.03201185

 Formula: ~1 | NRATE %in% BLOCK
        (Intercept) Residual
StdDev: 0.006112608  521.401

Fixed effects:  YIELD ~ 0 + NRATE * VARIETY 
                         Value Std.Error DF   t-value p-value
NRATE0                2536.000  301.0310  8  8.424381  0.0000
NRATE50               2786.667  301.0310  8  9.257074  0.0000
NRATE80               3857.667  301.0310  8 12.814847  0.0000
NRATE110              3467.333  301.0310  8 11.518192  0.0000
NRATE140              3100.667  301.0310  8 10.300156  0.0000
VARIETYVar_2           649.667  425.7222 21  1.526034  0.1419
VARIETYVar_3          1965.333  425.7222 21  4.616469  0.0001
NRATE50:VARIETYVar_2   603.000  602.0621 21  1.001558  0.3280
NRATE80:VARIETYVar_2   104.000  602.0621 21  0.172740  0.8645
NRATE110:VARIETYVar_2  830.667  602.0621 21  1.379703  0.1822
NRATE140:VARIETYVar_2 1561.000  602.0621 21  2.592756  0.0170
NRATE50:VARIETYVar_3  1152.333  602.0621 21  1.913978  0.0694
NRATE80:VARIETYVar_3   763.667  602.0621 21  1.268419  0.2185
NRATE110:VARIETYVar_3 1033.000  602.0621 21  1.715770  0.1009
NRATE140:VARIETYVar_3  292.667  602.0621 21  0.486107  0.6319
 Correlation: 
                      NRATE0 NRATE50 NRATE80 NRATE110 NRATE140 VARIETYV_2
NRATE50                0.000                                             
NRATE80                0.000  0.000                                      
NRATE110               0.000  0.000   0.000                              
NRATE140               0.000  0.000   0.000   0.000                      
VARIETYVar_2          -0.707  0.000   0.000   0.000    0.000             
VARIETYVar_3          -0.707  0.000   0.000   0.000    0.000    0.500    
NRATE50:VARIETYVar_2   0.500 -0.500   0.000   0.000    0.000   -0.707    
NRATE80:VARIETYVar_2   0.500  0.000  -0.500   0.000    0.000   -0.707    
NRATE110:VARIETYVar_2  0.500  0.000   0.000  -0.500    0.000   -0.707    
NRATE140:VARIETYVar_2  0.500  0.000   0.000   0.000   -0.500   -0.707    
NRATE50:VARIETYVar_3   0.500 -0.500   0.000   0.000    0.000   -0.354    
NRATE80:VARIETYVar_3   0.500  0.000  -0.500   0.000    0.000   -0.354    
NRATE110:VARIETYVar_3  0.500  0.000   0.000  -0.500    0.000   -0.354    
NRATE140:VARIETYVar_3  0.500  0.000   0.000   0.000   -0.500   -0.354    
                      VARIETYV_3 NRATE50:VARIETYV_2 NRATE80:VARIETYV_2
NRATE50                                                               
NRATE80                                                               
NRATE110                                                              
NRATE140                                                              
VARIETYVar_2                                                          
VARIETYVar_3                                                          
NRATE50:VARIETYVar_2  -0.354                                          
NRATE80:VARIETYVar_2  -0.354      0.500                               
NRATE110:VARIETYVar_2 -0.354      0.500              0.500            
NRATE140:VARIETYVar_2 -0.354      0.500              0.500            
NRATE50:VARIETYVar_3  -0.707      0.500              0.250            
NRATE80:VARIETYVar_3  -0.707      0.250              0.500            
NRATE110:VARIETYVar_3 -0.707      0.250              0.250            
NRATE140:VARIETYVar_3 -0.707      0.250              0.250            
                      NRATE110:VARIETYV_2 NRATE140:VARIETYV_2
NRATE50                                                      
NRATE80                                                      
NRATE110                                                     
NRATE140                                                     
VARIETYVar_2                                                 
VARIETYVar_3                                                 
NRATE50:VARIETYVar_2                                         
NRATE80:VARIETYVar_2                                         
NRATE110:VARIETYVar_2                                        
NRATE140:VARIETYVar_2  0.500                                 
NRATE50:VARIETYVar_3   0.250               0.250             
NRATE80:VARIETYVar_3   0.250               0.250             
NRATE110:VARIETYVar_3  0.500               0.250             
NRATE140:VARIETYVar_3  0.250               0.500             
                      NRATE50:VARIETYV_3 NRATE80:VARIETYV_3 NRATE110:VARIETYV_3
NRATE50                                                                        
NRATE80                                                                        
NRATE110                                                                       
NRATE140                                                                       
VARIETYVar_2                                                                   
VARIETYVar_3                                                                   
NRATE50:VARIETYVar_2                                                           
NRATE80:VARIETYVar_2                                                           
NRATE110:VARIETYVar_2                                                          
NRATE140:VARIETYVar_2                                                          
NRATE50:VARIETYVar_3                                                           
NRATE80:VARIETYVar_3   0.500                                                   
NRATE110:VARIETYVar_3  0.500              0.500                                
NRATE140:VARIETYVar_3  0.500              0.500              0.500             

Standardized Within-Group Residuals:
       Min         Q1        Med         Q3        Max 
-1.9300562 -0.6188455  0.0428333  0.5702584  1.6941534 

Number of Observations: 45
Number of Groups: 
           BLOCK NRATE %in% BLOCK 
               3               15 </code></pre>
</div>
</div>
</section>
<section id="lmer-code-lme4" class="level3" data-number="5.5.2">
<h3 data-number="5.5.2" class="anchored" data-anchor-id="lmer-code-lme4"><span class="header-section-number">5.5.2</span> lmer code (lme4)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>split_lme4 <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(<span class="co"># Response variable</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>                   YIELD <span class="sc">~</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Fixed (Removing intercept? Why?)</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">0</span><span class="sc">+</span>NRATE<span class="sc">*</span>VARIETY <span class="sc">+</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Random</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>                   (<span class="dv">1</span><span class="sc">|</span>BLOCK<span class="sc">/</span>NRATE), </span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Data</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data=</span>split_plot_data,</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">contrasts =</span> <span class="fu">list</span>(<span class="at">NRATE =</span> <span class="st">"contr.sum"</span>, <span class="at">VARIETY =</span> <span class="st">"contr.sum"</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>                   )</span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Alternative (being more explicit with the syntax)</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a><span class="co"># split_lme4 &lt;- lme4::lmer(YIELD ~ NRATE * VARIETY + (1|BLOCK) + (1|BLOCK:NRATE), data=split_plot_data)</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Type 3</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(split_lme4, <span class="at">type =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III Wald chisquare tests)

Response: YIELD
                 Chisq Df Pr(&gt;Chisq)    
NRATE         3326.392  5    &lt; 2e-16 ***
VARIETY        188.511  2    &lt; 2e-16 ***
NRATE:VARIETY   18.117  8    0.02036 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Adjusting options for constrasts</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">contrasts =</span> <span class="fu">c</span>(<span class="st">"contr.sum"</span>, <span class="st">"contr.poly"</span>)) <span class="co"># Ensure correct contrasts for Type 3</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(split_nlme, <span class="at">type =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III tests)

Response: YIELD
               Chisq Df Pr(&gt;Chisq)    
NRATE         559.65  5  &lt; 2.2e-16 ***
VARIETY               0               
NRATE:VARIETY         0               
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
</section>
<section id="check-assumptions" class="level2" data-number="5.6">
<h2 data-number="5.6" class="anchored" data-anchor-id="check-assumptions"><span class="header-section-number">5.6</span> Check assumptions</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Single tests</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_normality</span>(split_lme4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OK: residuals appear as normally distributed (p = 0.910).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_homogeneity</span>(split_lme4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OK: There is not clear evidence for different variances across groups (Bartlett Test, p = 0.396).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_autocorrelation</span>(split_lme4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OK: Residuals appear to be independent and not autocorrelated (p = 0.410).</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_outliers</span>(split_lme4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>OK: No outliers detected.
- Based on the following method and threshold: cook (0.5).
- For variable: (Whole model)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_collinearity</span>(split_lme4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Check for Multicollinearity

Low Correlation

  Increased SE  VIF      VIF  CI SE_factor Tolerance
         NRATE 1.00 [1.00, 1.00]      1.00      1.00
       VARIETY 1.00 [1.00, 1.00]      1.00      1.00
 NRATE:VARIETY 1.00 [1.00, 1.00]      1.00      1.00</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Check Plots</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>performance<span class="sc">::</span><span class="fu">check_model</span>(split_lme4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="models_04_files/figure-html/sp_check-1.png" class="img-fluid figure-img" width="576"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="comparisons" class="level2" data-number="5.7">
<h2 data-number="5.7" class="anchored" data-anchor-id="comparisons"><span class="header-section-number">5.7</span> Comparisons</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate the comparisons (pairwise)</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>split_lm4_comparisons <span class="ot">&lt;-</span>  </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  split_lme4 <span class="sc">%&gt;%</span> </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ~ specifies the level of comparison (marginal or interaction)</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Since interaction was significant we specify ~ Interaction (Factor1*Factor2)</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(., <span class="sc">~</span> NRATE<span class="sc">*</span>VARIETY)</span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Add letters</span></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>split_lm4_comparisons <span class="sc">%&gt;%</span> </span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compact Letters Display (cld)</span></span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(., </span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Specify grouped comparisons by...</span></span>
<span id="cb37-13"><a href="#cb37-13" aria-hidden="true" tabindex="-1"></a>      <span class="co">#by = "NRATE", </span></span>
<span id="cb37-14"><a href="#cb37-14" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Order</span></span>
<span id="cb37-15"><a href="#cb37-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">decreasing =</span> <span class="cn">TRUE</span>, <span class="at">details=</span><span class="cn">FALSE</span>, <span class="at">reversed=</span><span class="cn">TRUE</span>, </span>
<span id="cb37-16"><a href="#cb37-16" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Specs</span></span>
<span id="cb37-17"><a href="#cb37-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha=</span><span class="fl">0.05</span>,  <span class="at">adjust =</span> <span class="st">"tukey"</span>, <span class="at">Letters=</span>LETTERS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> NRATE VARIETY emmean  SE df lower.CL upper.CL .group  
 80    Var_3     6587 301 30     5630     7544  A      
 110   Var_3     6466 301 30     5509     7423  AB     
 50    Var_3     5904 301 30     4947     6861  ABC    
 140   Var_3     5359 301 30     4402     6316  ABCD   
 140   Var_2     5311 301 30     4354     6268  ABCD   
 110   Var_2     4948 301 30     3991     5905   BCDE  
 80    Var_2     4611 301 30     3654     5568    CDEF 
 0     Var_3     4501 301 30     3544     5458    CDEF 
 50    Var_2     4039 301 30     3082     4996     DEFG
 80    Var_1     3858 301 30     2901     4815     DEFG
 110   Var_1     3467 301 30     2510     4424      EFG
 0     Var_2     3186 301 30     2229     4143       FG
 140   Var_1     3101 301 30     2144     4058       FG
 50    Var_1     2787 301 30     1830     3744        G
 0     Var_1     2536 301 30     1579     3493        G

Degrees-of-freedom method: kenward-roger 
Confidence level used: 0.95 
Conf-level adjustment: sidak method for 15 estimates 
P value adjustment: tukey method for comparing a family of 15 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
</section>
</section>
<section id="split-split-plot" class="level1" data-number="6">
<h1 data-number="6"><span class="header-section-number">6</span> Split-split plot</h1>
<p>Compared to a split-plot, a split-split one is adding another hierarchy of nested effects to the model.</p>
<section id="data-1" class="level2" data-number="6.1">
<h2 data-number="6.1" class="anchored" data-anchor-id="data-1"><span class="header-section-number">6.1</span> Data</h2>
<section id="details" class="level3" data-number="6.1.1">
<h3 data-number="6.1.1" class="anchored" data-anchor-id="details"><span class="header-section-number">6.1.1</span> Details</h3>
<p>An interesting split-split plot experiment in which the sub-plot treatments have a 2*5 factorial structure.</p>
<p>An experiment was conducted in 1932 on the experimental field of the Dominion Rust Research Laboratory. The study was designed to determine the effect on the incidence of root rot, of variety of wheat, kinds of dust for seed treatment, method of application of the dust, and efficacy of soil inoculation with the root-rot organism.</p>
<p>The field had 4 blocks.</p>
<p>Each block has 2 whole plots for the genotypes.</p>
<p>Each whole-plot had 10 sub-plots for the 5 different kinds of dust and 2 methods of application.</p>
<p>Each sub-plot had 2 sub-sub-plots, one for inoculated soil and the other one for uninoculated soil.</p>
<p><strong>C. H. Goulden</strong>, (1939). Methods of statistical analysis, 1st ed.&nbsp;Page 18. https://archive.org/stream/methodsofstatist031744mbp</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>splitsplit_data <span class="ot">&lt;-</span> agridat<span class="sc">::</span>goulden.splitsplit</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(splitsplit_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 160
Columns: 9
$ row   &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2…
$ col   &lt;int&gt; 1, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 2, 20, 3, 4, 5, 6, 7,…
$ yield &lt;int&gt; 64, 69, 67, 66, 71, 64, 64, 75, 70, 66, 67, 68, 65, 68, 71, 62, …
$ inoc  &lt;fct&gt; Uninoc, Uninoc, Uninoc, Inoc, Inoc, Uninoc, Uninoc, Inoc, Inoc, …
$ trt   &lt;int&gt; 5, 7, 1, 1, 9, 9, 10, 10, 2, 2, 6, 5, 6, 4, 4, 3, 3, 8, 8, 7, 6,…
$ gen   &lt;fct&gt; Marquis, Marquis, Marquis, Marquis, Marquis, Marquis, Marquis, M…
$ dry   &lt;fct&gt; Dry, Dry, Dry, Dry, Dry, Dry, Wet, Wet, Wet, Wet, Wet, Dry, Wet,…
$ dust  &lt;fct&gt; DuBay, Check, Ceresan, Ceresan, CaCO3, CaCO3, CaCO3, CaCO3, Cere…
$ block &lt;fct&gt; B1, B1, B1, B1, B1, B1, B1, B1, B1, B1, B1, B1, B1, B1, B1, B1, …</code></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Make sure all factors are not numbers or integers.</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>splitsplit_data <span class="ot">&lt;-</span> splitsplit_data <span class="sc">%&gt;%</span> </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt =</span> <span class="fu">as.factor</span>(trt))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="models-1" class="level2" data-number="6.2">
<h2 data-number="6.2" class="anchored" data-anchor-id="models-1"><span class="header-section-number">6.2</span> Models</h2>
<section id="nlme-1" class="level3" data-number="6.2.1">
<h3 data-number="6.2.1" class="anchored" data-anchor-id="nlme-1"><span class="header-section-number">6.2.1</span> nlme</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Model with split component</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>splitsplit_nlme <span class="ot">&lt;-</span> nlme<span class="sc">::</span><span class="fu">lme</span>(<span class="co"># Response variable</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>                 yield <span class="sc">~</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Fixed (Removing intercept? Why?)</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">0</span> <span class="sc">+</span> gen<span class="sc">*</span>trt<span class="sc">*</span>inoc,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Random error of MAINPLOT (NRATE nested in BLOCK)</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>                   <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>gen<span class="sc">/</span>trt, </span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Data</span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data =</span> splitsplit_data,</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Method</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">"REML"</span>)</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Type 3 (when interaction is present)</span></span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(splitsplit_nlme, <span class="at">type =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III tests)

Response: yield
                 Chisq Df Pr(&gt;Chisq)    
gen          2202.1234  2  &lt; 2.2e-16 ***
trt            58.6809  9  2.405e-09 ***
inoc           62.7247  1  2.377e-15 ***
gen:trt        19.6914  9  0.0199156 *  
gen:inoc        0.0199  1  0.8878172    
trt:inoc       30.8330  9  0.0003162 ***
gen:trt:inoc    8.5127  9  0.4834183    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="lme4-1" class="level3" data-number="6.2.2">
<h3 data-number="6.2.2" class="anchored" data-anchor-id="lme4-1"><span class="header-section-number">6.2.2</span> lme4</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>splitsplit_lme4 <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(<span class="co"># Response variable</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>                   yield <span class="sc">~</span> </span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Fixed (Removing intercept? Why?)</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>                   <span class="dv">0</span><span class="sc">+</span>gen<span class="sc">*</span>trt<span class="sc">*</span>inoc <span class="sc">+</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Random</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>                   (<span class="dv">1</span><span class="sc">|</span>block<span class="sc">/</span>gen<span class="sc">/</span>trt), </span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>                   <span class="co"># Data</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>                   <span class="at">data=</span>splitsplit_data)</span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Type 3 (when interaction is present)</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>car<span class="sc">::</span><span class="fu">Anova</span>(splitsplit_lme4, <span class="at">type =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Deviance Table (Type III Wald chisquare tests)

Response: yield
                 Chisq Df Pr(&gt;Chisq)    
gen          2202.1225  2  &lt; 2.2e-16 ***
trt            58.6809  9  2.405e-09 ***
inoc           62.7247  1  2.377e-15 ***
gen:trt        19.6914  9  0.0199156 *  
gen:inoc        0.0199  1  0.8878172    
trt:inoc       30.8330  9  0.0003162 ***
gen:trt:inoc    8.5127  9  0.4834183    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
</section>
<section id="comparisons-1" class="level2" data-number="6.3">
<h2 data-number="6.3" class="anchored" data-anchor-id="comparisons-1"><span class="header-section-number">6.3</span> Comparisons</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Estimate the comparisons (pairwise)</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>splitsplit_lm4_comparisons <span class="ot">&lt;-</span>  </span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  splitsplit_lme4 <span class="sc">%&gt;%</span> </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ~ specifies the level of comparison (marginal or interaction)</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Since interaction was significant we specify ~ Interaction (Factor1*Factor2)</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">emmeans</span>(., <span class="sc">~</span> trt<span class="sc">:</span>inoc)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Add letters</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>splitsplit_lm4_comparisons <span class="sc">%&gt;%</span> </span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Compact Letters Display (cld)</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cld</span>(., </span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Specify grouped comparisons by...</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">by =</span> <span class="st">"trt"</span>, </span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Order</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">decreasing =</span> <span class="cn">TRUE</span>, <span class="at">details=</span><span class="cn">FALSE</span>, <span class="at">reversed=</span><span class="cn">TRUE</span>, </span>
<span id="cb46-16"><a href="#cb46-16" aria-hidden="true" tabindex="-1"></a>      <span class="co"># Specs</span></span>
<span id="cb46-17"><a href="#cb46-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha=</span><span class="fl">0.05</span>,  <span class="at">adjust =</span> <span class="st">"tukey"</span>, <span class="at">Letters=</span>LETTERS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>trt = 1:
 inoc   emmean   SE   df lower.CL upper.CL .group
 Inoc     66.4 2.03 11.7     58.6     74.1  A    
 Uninoc   64.1 2.03 11.7     56.4     71.9  A    

trt = 2:
 inoc   emmean   SE   df lower.CL upper.CL .group
 Inoc     67.2 2.03 11.7     59.5     75.0  A    
 Uninoc   62.6 2.03 11.7     54.9     70.4   B   

trt = 3:
 inoc   emmean   SE   df lower.CL upper.CL .group
 Inoc     66.9 2.03 11.7     59.1     74.6  A    
 Uninoc   65.5 2.03 11.7     57.7     73.3  A    

trt = 4:
 inoc   emmean   SE   df lower.CL upper.CL .group
 Inoc     66.9 2.03 11.7     59.1     74.6  A    
 Uninoc   63.8 2.03 11.7     56.0     71.5  A    

trt = 5:
 inoc   emmean   SE   df lower.CL upper.CL .group
 Inoc     66.6 2.03 11.7     58.9     74.4  A    
 Uninoc   66.1 2.03 11.7     58.4     73.9  A    

trt = 6:
 inoc   emmean   SE   df lower.CL upper.CL .group
 Inoc     65.1 2.03 11.7     57.4     72.9  A    
 Uninoc   61.1 2.03 11.7     53.4     68.9   B   

trt = 7:
 inoc   emmean   SE   df lower.CL upper.CL .group
 Inoc     77.5 2.03 11.7     69.7     85.3  A    
 Uninoc   67.4 2.03 11.7     59.6     75.1   B   

trt = 8:
 inoc   emmean   SE   df lower.CL upper.CL .group
 Inoc     75.1 2.03 11.7     67.4     82.9  A    
 Uninoc   64.6 2.03 11.7     56.9     72.4   B   

trt = 9:
 inoc   emmean   SE   df lower.CL upper.CL .group
 Inoc     71.5 2.03 11.7     63.7     79.3  A    
 Uninoc   67.8 2.03 11.7     60.0     75.5  A    

trt = 10:
 inoc   emmean   SE   df lower.CL upper.CL .group
 Inoc     72.5 2.03 11.7     64.7     80.3  A    
 Uninoc   63.6 2.03 11.7     55.9     71.4   B   

Results are averaged over the levels of: gen 
Degrees-of-freedom method: kenward-roger 
Confidence level used: 0.95 
Conf-level adjustment: sidak method for 20 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>



</section>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" role="doc-bibliography" id="quarto-bibliography"><h2 class="anchored quarto-appendix-heading">References</h2><div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-Bolker_etal_2022" class="csl-entry" role="listitem">
Bolker, Ben, Julia Piaskowski, Emi Tanaka, Phillip Alday, and Wolfgang Viechtbauer. 2022. <em>CRAN Task View: Mixed, Multilevel, and Hierarchical Models in r. Version 2022-10-18.</em> <a href="https://cran.r-project.org/view=MixedModels">https://cran.r-project.org/view=MixedModels</a>.
</div>
<div id="ref-broom.mixed" class="csl-entry" role="listitem">
Bolker, Ben, and David Robinson. 2022. <span>“Broom.mixed: Tidying Methods for Mixed Models.”</span> <a href="https://CRAN.R-project.org/package=broom.mixed">https://CRAN.R-project.org/package=broom.mixed</a>.
</div>
<div id="ref-Dixon_2016" class="csl-entry" role="listitem">
Dixon, Philip. 2016. <span>“Should Blocks Be Fixed or Random?”</span> <em>Conference on Applied Statistics in Agriculture, May 1-3, Kansas State University</em>, 23–39. <a href="https://doi.org/10.4148/2475-7772.1474">https://doi.org/10.4148/2475-7772.1474</a>.
</div>
<div id="ref-agricolae" class="csl-entry" role="listitem">
Mendiburu, Felipe de. 2021. <span>“Agricolae: Statistical Procedures for Agricultural Research.”</span> <a href="https://CRAN.R-project.org/package=agricolae">https://CRAN.R-project.org/package=agricolae</a>.
</div>
<div id="ref-broom" class="csl-entry" role="listitem">
Robinson, David, Alex Hayes, and Simon Couch. 2022. <span>“Broom: Convert Statistical Objects into Tidy Tibbles.”</span> <a href="https://CRAN.R-project.org/package=broom">https://CRAN.R-project.org/package=broom</a>.
</div>
<div id="ref-skimr" class="csl-entry" role="listitem">
Waring, Elin, Michael Quinn, Amelia McNamara, Eduardo Arino de la Rubia, Hao Zhu, and Shannon Ellis. 2022. <span>“Skimr: Compact and Flexible Summaries of Data.”</span> <a href="https://CRAN.R-project.org/package=skimr">https://CRAN.R-project.org/package=skimr</a>.
</div>
<div id="ref-dplyr" class="csl-entry" role="listitem">
Wickham, Hadley, Romain François, Lionel Henry, and Kirill Müller. 2022. <span>“Dplyr: A Grammar of Data Manipulation.”</span> <a href="https://CRAN.R-project.org/package=dplyr">https://CRAN.R-project.org/package=dplyr</a>.
</div>
</div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/adriancorrendo\.github\.io\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../coding/week_09/models_03.html" class="pagination-link" aria-label="14-Models III">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">14-Models III</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../outline/calendar.html" class="pagination-link" aria-label="Schedule">
        <span class="nav-page-text">Schedule</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><span> Developed by Adrian Correndo with <a href="https://quarto.org/">Quarto</a>. License: <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC BY-SA 2.0</a>. </span></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




<script src="../../site_libs/quarto-html/zenscroll-min.js"></script>
</body></html>